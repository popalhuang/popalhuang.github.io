<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Popal&#39;s Blog</title>
  <subtitle>邊做邊學</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-01-03T08:17:51.595Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>popal</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>hdfs ec command Memo</title>
    <link href="http://yoursite.com/2018/01/03/%5Bhadoop%5Dhdfs_ec_cmd/"/>
    <id>http://yoursite.com/2018/01/03/[hadoop]hdfs_ec_cmd/</id>
    <published>2018-01-02T16:00:00.000Z</published>
    <updated>2018-01-03T08:17:51.595Z</updated>
    
    <content type="html"><![CDATA[<h4 id="hdfs-ec-使用方式-以XOR-2-1-1024k-Policy做為測試"><a href="#hdfs-ec-使用方式-以XOR-2-1-1024k-Policy做為測試" class="headerlink" title="hdfs ec 使用方式(以XOR-2-1-1024k Policy做為測試)"></a>hdfs ec 使用方式(以XOR-2-1-1024k Policy做為測試)</h4><blockquote>
<p>EC相關架構的介紹可以參考網路相關的文章<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div></pre></td><td class="code"><pre><div class="line">Usage: bin/hdfs ec [COMMAND]</div><div class="line">          [-listPolicies]</div><div class="line">          [-addPolicies -policyFile &lt;file&gt;]</div><div class="line">          [-getPolicy -path &lt;path&gt;]</div><div class="line">          [-removePolicy -policy &lt;policy&gt;]</div><div class="line">          [-setPolicy -path &lt;path&gt; [-policy &lt;policy&gt;] [-replicate]]</div><div class="line">          [-unsetPolicy -path &lt;path&gt;]</div><div class="line">          [-listCodecs]</div><div class="line">          [-enablePolicy -policy &lt;policy&gt;]</div><div class="line">          [-disablePolicy -policy &lt;policy&gt;]</div><div class="line">          [-help &lt;command-name&gt;]</div><div class="line"></div><div class="line">##列出所有Erasure Coding可用的相關Policies</div><div class="line">hadoop@hadoop-master:~$ hdfs ec -listPolicies</div><div class="line">Erasure Coding Policies:</div><div class="line">ErasureCodingPolicy=[Name=RS-10-4-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=10, numParityUnits=4]], CellSize=1048576, Id=5], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-3-2-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=3, numParityUnits=2]], CellSize=1048576, Id=2], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-6-3-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=1], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-LEGACY-6-3-1024k, Schema=[ECSchema=[Codec=rs-legacy, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=3], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=XOR-2-1-1024k, Schema=[ECSchema=[Codec=xor, numDataUnits=2, numParityUnits=1]], CellSize=1048576, Id=4], State=DISABLED</div><div class="line"></div><div class="line">##列出所有Erasure Coding Codec列表</div><div class="line">hadoop@hadoop-master:~$ hdfs ec -listCodecs</div><div class="line">Erasure Coding Codecs: Codec [Coder List]</div><div class="line">        RS [RS_NATIVE, RS_JAVA]</div><div class="line">        RS-LEGACY [RS-LEGACY_JAVA]</div><div class="line">        XOR [XOR_NATIVE, XOR_JAVA]</div><div class="line"></div><div class="line">##Enable XOR-2-1-1024k的EC Policy		</div><div class="line">hadoop@hadoop-master:~$ hdfs ec -enablePolicy -policy XOR-2-1-1024k</div><div class="line">Erasure coding policy XOR-2-1-1024k is enabled</div><div class="line">hadoop@hadoop-master:~$ hdfs ec -listPolicies</div><div class="line">Erasure Coding Policies:</div><div class="line">ErasureCodingPolicy=[Name=RS-10-4-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=10, numParityUnits=4]], CellSize=1048576, Id=5], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-3-2-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=3, numParityUnits=2]], CellSize=1048576, Id=2], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-6-3-1024k, Schema=[ECSchema=[Codec=rs, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=1], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=RS-LEGACY-6-3-1024k, Schema=[ECSchema=[Codec=rs-legacy, numDataUnits=6, numParityUnits=3]], CellSize=1048576, Id=3], State=DISABLED</div><div class="line">ErasureCodingPolicy=[Name=XOR-2-1-1024k, Schema=[ECSchema=[Codec=xor, numDataUnits=2, numParityUnits=1]], CellSize=1048576, Id=4], State=ENABLED</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -mkdir -p /user/hadoop/example/lab_2</div><div class="line"></div><div class="line">##將目錄設定為XOR-2-1-1024k的EC Policy</div><div class="line">hadoop@hadoop-master:~$ hdfs ec -setPolicy -path /user/hadoop/example/lab_2 -policy XOR-2-1-1024k</div><div class="line">Set erasure coding policy XOR-2-1-1024k on /user/hadoop/example/lab_2</div><div class="line"></div><div class="line">##上傳檔案</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put ~/test9.tar.gz /user/hadoop/example/lab_2</div><div class="line">2018-01-03 15:41:12,678 WARN erasurecode.ErasureCodeNative: ISA-L support is not available in your platform... using builtin-java codec where applicable</div><div class="line">2018-01-03 15:41:12,741 WARN hdfs.DFSOutputStream: Cannot allocate parity block(index=2, policy=XOR-2-1-1024k). Not enough datanodes? Exclude nodes=[]</div><div class="line">2018-01-03 15:41:12,953 WARN hdfs.DFSOutputStream: Block group &lt;1&gt; has 1 corrupt blocks. It&apos;s at high risk of losing data.</div><div class="line"></div><div class="line">##觀察上傳檔案的複本數</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_2</div><div class="line">Found 1 items</div><div class="line">-rw-r--r--   1 hadoop supergroup        373 2018-01-03 15:41 /user/hadoop/example/lab_2/test9.tar.gz</div><div class="line"></div><div class="line">##以下為使用fsck指令觀察該檔案Block相關訊息</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/example/lab_2/test9.tar.gz -files -blocks -locations</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;blocks=1&amp;locations=1&amp;path=%2Fuser%2Fhadoop%2Fexample%2Flab_2%2Ftest9.tar.gz</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/example/lab_2/test9.tar.gz at Wed Jan 03 15:46:48 CST 2018</div><div class="line">/user/hadoop/example/lab_2/test9.tar.gz 373 bytes, erasure-coded: policy=XOR-2-1-1024k, 1 block(s):  OK</div><div class="line">0. BP-1139418417-192.168.51.4-1514272982687:blk_-9223372036854775776_2346 len=373 Live_repl=2  </div><div class="line">[blk_-9223372036854775776:DatanodeInfoWithStorage[192.168.51.5:9866,DS-f59711c6-801d-4ebc-b55c-228f225117b8,DISK], </div><div class="line"> blk_-9223372036854775774:DatanodeInfoWithStorage[192.168.51.6:9866,DS-482194d9-aa70-4ab8-8253-907739d5b1a1,DISK]]</div><div class="line"></div><div class="line"></div><div class="line">Status: HEALTHY</div><div class="line"> Number of data-nodes:  2</div><div class="line"> Number of racks:               1</div><div class="line"> Total dirs:                    0</div><div class="line"> Total symlinks:                0</div><div class="line"></div><div class="line">Replicated Blocks:</div><div class="line"> Total size:    0 B</div><div class="line"> Total files:   0</div><div class="line"> Total blocks (validated):      0</div><div class="line"> Minimally replicated blocks:   0</div><div class="line"> Over-replicated blocks:        0</div><div class="line"> Under-replicated blocks:       0</div><div class="line"> Mis-replicated blocks:         0</div><div class="line"> Default replication factor:    1</div><div class="line"> Average block replication:     0.0</div><div class="line"> Missing blocks:                0</div><div class="line"> Corrupt blocks:                0</div><div class="line"> Missing replicas:              0</div><div class="line"></div><div class="line">Erasure Coded Block Groups:</div><div class="line"> Total size:    373 B</div><div class="line"> Total files:   1</div><div class="line"> Total block groups (validated):        1 (avg. block group size 373 B)</div><div class="line"> Minimally erasure-coded block groups:  1 (100.0 %)</div><div class="line"> Over-erasure-coded block groups:       0 (0.0 %)</div><div class="line"> Under-erasure-coded block groups:      0 (0.0 %)</div><div class="line"> Unsatisfactory placement block groups: 0 (0.0 %)</div><div class="line"> Average block group size:      2.0</div><div class="line"> Missing block groups:          0</div><div class="line"> Corrupt block groups:          0</div><div class="line"> Missing internal blocks:       0 (0.0 %)</div><div class="line">FSCK ended at Wed Jan 03 15:46:48 CST 2018 in 2 milliseconds</div><div class="line"></div><div class="line"></div><div class="line">The filesystem under path &apos;/user/hadoop/example/lab_2/test9.tar.gz&apos; is HEALTHY</div><div class="line"></div><div class="line">##以blockId觀察複本狀況</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck -blockId blk_-9223372036854775776</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;blockId=blk_-9223372036854775776+&amp;path=%2F</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 at Wed Jan 03 15:49:12 CST 2018</div><div class="line"></div><div class="line">Block Id: blk_-9223372036854775776</div><div class="line">Block belongs to: /user/hadoop/example/lab_2/test9.tar.gz</div><div class="line">No. of Expected Replica: 2</div><div class="line">No. of live Replica: 2</div><div class="line">No. of excess Replica: 0</div><div class="line">No. of stale Replica: 0</div><div class="line">No. of decommissioned Replica: 0</div><div class="line">No. of decommissioning Replica: 0</div><div class="line">No. of corrupted Replica: 0</div><div class="line">null</div><div class="line"></div><div class="line"></div><div class="line">Fsck on blockId &apos;blk_-9223372036854775776</div><div class="line"></div><div class="line">##以下為模擬shutdown 一台Datanode,資料是否還會存在??</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -shutdownDatanode hadoop-slave2:9867</div><div class="line">Submitted a shutdown request to datanode hadoop-slave2:9867</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/example/lab_2/test9.tar.gz -files -blocks -locations</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;blocks=1&amp;locations=1&amp;path=%2Fuser%2Fhadoop%2Fexample%2Flab_2%2Ftest9.tar.gz</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/example/lab_2/test9.tar.gz at Wed Jan 03 16:11:01 CST 2018</div><div class="line">/user/hadoop/example/lab_2/test9.tar.gz 373 bytes, erasure-coded: policy=XOR-2-1-1024k, 1 block(s):  </div><div class="line">Under replicated BP-1139418417-192.168.51.4-1514272982687:blk_-9223372036854775776_2346. </div><div class="line">Target Replicas is 2 but found 1 live replica(s), 0 decommissioned replica(s), 0 decommissioning replica(s).</div><div class="line">0. BP-1139418417-192.168.51.4-1514272982687:blk_-9223372036854775776_2346 len=373 Live_repl=1  </div><div class="line">[blk_-9223372036854775776:DatanodeInfoWithStorage[192.168.51.5:9866,DS-f59711c6-801d-4ebc-b55c-228f225117b8,DISK]]</div><div class="line"></div><div class="line"></div><div class="line">Status: HEALTHY</div><div class="line"> Number of data-nodes:  1</div><div class="line"> Number of racks:               1</div><div class="line"> Total dirs:                    0</div><div class="line"> Total symlinks:                0</div><div class="line"></div><div class="line">Replicated Blocks:</div><div class="line"> Total size:    0 B</div><div class="line"> Total files:   0</div><div class="line"> Total blocks (validated):      0</div><div class="line"> Minimally replicated blocks:   0</div><div class="line"> Over-replicated blocks:        0</div><div class="line"> Under-replicated blocks:       0</div><div class="line"> Mis-replicated blocks:         0</div><div class="line"> Default replication factor:    1</div><div class="line"> Average block replication:     0.0</div><div class="line"> Missing blocks:                0</div><div class="line"> Corrupt blocks:                0</div><div class="line"> Missing replicas:              0</div><div class="line"></div><div class="line">Erasure Coded Block Groups:</div><div class="line"> Total size:    373 B</div><div class="line"> Total files:   1</div><div class="line"> Total block groups (validated):        1 (avg. block group size 373 B)</div><div class="line"> Minimally erasure-coded block groups:  1 (100.0 %)</div><div class="line"> Over-erasure-coded block groups:       0 (0.0 %)</div><div class="line"> Under-erasure-coded block groups:      1 (100.0 %)</div><div class="line"> Unsatisfactory placement block groups: 0 (0.0 %)</div><div class="line"> Average block group size:      1.0</div><div class="line"> Missing block groups:          0</div><div class="line"> Corrupt block groups:          0</div><div class="line"> Missing internal blocks:       1 (50.0 %)</div><div class="line">FSCK ended at Wed Jan 03 16:11:01 CST 2018 in 3 milliseconds</div><div class="line"></div><div class="line"></div><div class="line">The filesystem under path &apos;/user/hadoop/example/lab_2/test9.tar.gz&apos; is HEALTHY</div><div class="line"></div><div class="line">雖然複本數是設定為1,但因為使用的是EC策略,資料仍然是可下載而且資料內容也是正確的</div></pre></td></tr></table></figure></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;hdfs-ec-使用方式-以XOR-2-1-1024k-Policy做為測試&quot;&gt;&lt;a href=&quot;#hdfs-ec-使用方式-以XOR-2-1-1024k-Policy做為測試&quot; class=&quot;headerlink&quot; title=&quot;hdfs ec 使用方式(以XO
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>hdfs client command Memo</title>
    <link href="http://yoursite.com/2018/01/03/%5Bhadoop%5Dhdfs_other_cmd/"/>
    <id>http://yoursite.com/2018/01/03/[hadoop]hdfs_other_cmd/</id>
    <published>2018-01-02T16:00:00.000Z</published>
    <updated>2018-01-03T06:16:27.827Z</updated>
    
    <content type="html"><![CDATA[<h5 id="hdfs-getconf相關用法"><a href="#hdfs-getconf相關用法" class="headerlink" title="hdfs getconf相關用法"></a>hdfs getconf相關用法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">Usage:</div><div class="line">hadoop getconf</div><div class="line">        [-namenodes]            gets list of namenodes in the cluster.</div><div class="line">        [-secondaryNameNodes]   gets list of secondary namenodes in the cluster.</div><div class="line">        [-backupNodes]          gets list of backup nodes in the cluster.</div><div class="line">        [-includeFile]          gets the include file path that defines the datanodes that can join the cluster.</div><div class="line">        [-excludeFile]          gets the exclude file path that defines the datanodes that need to decommissioned.</div><div class="line">        [-nnRpcAddresses]       gets the namenode rpc addresses</div><div class="line">        [-confKey [key]]		gets a specific key from the configuration</div><div class="line">---</div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -namenodes</div><div class="line">hadoop-master</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -secondaryNameNodes</div><div class="line">hadoop-master</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -backupNodes</div><div class="line">0.0.0.0</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -nnRpcAddresses</div><div class="line">hadoop-master:8020</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -includeFile</div><div class="line">Configuration dfs.hosts is missing.</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -excludeFile</div><div class="line">Configuration dfs.hosts.exclude is missing.</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs getconf -confKey &quot;fs.trash.interval&quot;</div><div class="line">1440</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="hdfs-envvars相關用法"><a href="#hdfs-envvars相關用法" class="headerlink" title="hdfs envvars相關用法"></a>hdfs envvars相關用法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs envvars</div><div class="line">JAVA_HOME=&apos;/bgdt/java/jdk1.8.0_101&apos;</div><div class="line">HADOOP_HDFS_HOME=&apos;/bgdt/hadoop-3.0.0&apos;</div><div class="line">HDFS_DIR=&apos;share/hadoop/hdfs&apos;</div><div class="line">HDFS_LIB_JARS_DIR=&apos;share/hadoop/hdfs/lib&apos;</div><div class="line">HADOOP_CONF_DIR=&apos;/bgdt/hadoop-3.0.0/etc/hadoop&apos;</div><div class="line">HADOOP_TOOLS_HOME=&apos;/bgdt/hadoop-3.0.0&apos;</div><div class="line">HADOOP_TOOLS_DIR=&apos;share/hadoop/tools&apos;</div><div class="line">HADOOP_TOOLS_LIB_JARS_DIR=&apos;share/hadoop/tools/lib&apos;</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="hdfs-classpath相關用法"><a href="#hdfs-classpath相關用法" class="headerlink" title="hdfs classpath相關用法"></a>hdfs classpath相關用法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs classpath</div><div class="line">/bgdt/hadoop-3.0.0/etc/hadoop:/bgdt/hadoop-3.0.0/share/hadoop/common/lib/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/common/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/hdfs:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/hdfs/lib/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/hdfs/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/mapreduce/lib/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/mapreduce/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/yarn:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/yarn/lib/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/yarn/*:</div><div class="line">/bgdt/hadoop-3.0.0/share/hadoop/yarn/hadoop-yarn-api-3.0.0</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="hdfs-version相關用法"><a href="#hdfs-version相關用法" class="headerlink" title="hdfs version相關用法"></a>hdfs version相關用法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs version</div><div class="line">Hadoop 3.0.0</div><div class="line">Source code repository https://git-wip-us.apache.org/repos/asf/hadoop.git -r c25427ceca461ee979d30edd7a4b0f50718e6533</div><div class="line">Compiled by andrew on 2017-12-08T19:16Z</div><div class="line">Compiled with protoc 2.5.0</div><div class="line">From source with checksum 397832cb5529187dc8cd74ad54ff22</div><div class="line">This command was run using /bgdt/hadoop-3.0.0/share/hadoop/common/hadoop-common-3.0.0.jar</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="hdfs-groups相關用法"><a href="#hdfs-groups相關用法" class="headerlink" title="hdfs groups相關用法"></a>hdfs groups相關用法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs groups</div><div class="line">hadoop : hadoop</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;hdfs-getconf相關用法&quot;&gt;&lt;a href=&quot;#hdfs-getconf相關用法&quot; class=&quot;headerlink&quot; title=&quot;hdfs getconf相關用法&quot;&gt;&lt;/a&gt;hdfs getconf相關用法&lt;/h5&gt;&lt;blockquote&gt;
&lt;fig
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>hdfs fsck command Memo</title>
    <link href="http://yoursite.com/2018/01/03/%5Bhadoop%5Dhadoop_fsck_cmd/"/>
    <id>http://yoursite.com/2018/01/03/[hadoop]hadoop_fsck_cmd/</id>
    <published>2018-01-02T16:00:00.000Z</published>
    <updated>2018-01-03T05:51:16.396Z</updated>
    
    <content type="html"><![CDATA[<h4 id="hadoop-fsck使用方式"><a href="#hadoop-fsck使用方式" class="headerlink" title="hadoop fsck使用方式"></a>hadoop fsck使用方式</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/test1.txt at Wed Jan 03 13:15:13 CST 2018</div><div class="line"></div><div class="line">Status: HEALTHY</div><div class="line"> Number of data-nodes:  2</div><div class="line"> Number of racks:               1</div><div class="line"> Total dirs:                    0</div><div class="line"> Total symlinks:                0</div><div class="line"></div><div class="line">Replicated Blocks:</div><div class="line"> Total size:    133 B</div><div class="line"> Total files:   1</div><div class="line"> Total blocks (validated):      1 (avg. block size 133 B)</div><div class="line"> Minimally replicated blocks:   1 (100.0 %)</div><div class="line"> Over-replicated blocks:        0 (0.0 %)</div><div class="line"> Under-replicated blocks:       0 (0.0 %)</div><div class="line"> Mis-replicated blocks:         0 (0.0 %)</div><div class="line"> Default replication factor:    2</div><div class="line"> Average block replication:     2.0</div><div class="line"> Missing blocks:                0</div><div class="line"> Corrupt blocks:                0</div><div class="line"> Missing replicas:              0 (0.0 %)</div><div class="line"></div><div class="line">Erasure Coded Block Groups:</div><div class="line"> Total size:    0 B</div><div class="line"> Total files:   0</div><div class="line"> Total block groups (validated):        0</div><div class="line"> Minimally erasure-coded block groups:  0</div><div class="line"> Over-erasure-coded block groups:       0</div><div class="line"> Under-erasure-coded block groups:      0</div><div class="line"> Unsatisfactory placement block groups: 0</div><div class="line"> Average block group size:      0.0</div><div class="line"> Missing block groups:          0</div><div class="line"> Corrupt block groups:          0</div><div class="line"> Missing internal blocks:       0</div><div class="line">FSCK ended at Wed Jan 03 13:15:13 CST 2018 in 1 milliseconds</div><div class="line"></div><div class="line"></div><div class="line">The filesystem under path &apos;/user/hadoop/test1.txt&apos; is HEALTHY</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="hdfs-fsck-相關參數操作說明"><a href="#hdfs-fsck-相關參數操作說明" class="headerlink" title="hdfs fsck 相關參數操作說明"></a>hdfs fsck 相關參數操作說明</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">##檢查並列出所有文件的狀態</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -files</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/test1.txt at Wed Jan 03 13:17:02 CST 2018</div><div class="line">/user/hadoop/test1.txt 133 bytes, replicated: replication=2, 1 block(s):  OK</div><div class="line"></div><div class="line">##列出所有Blocks資訊</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -files -blocks</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;blocks=1&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/test1.txt at Wed Jan 03 13:18:46 CST 2018</div><div class="line">/user/hadoop/test1.txt 133 bytes, replicated: replication=2, 1 block(s):  OK</div><div class="line">0. BP-1139418417-192.168.51.4-1514272982687:blk_1073743138_2323 len=133 Live_repl=2</div><div class="line"></div><div class="line">##列出所有Blocks的位置訊息</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -files -blocks -locations</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;blocks=1&amp;locations=1&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/test1.txt at Wed Jan 03 13:19:53 CST 2018</div><div class="line">/user/hadoop/test1.txt 133 bytes, replicated: replication=2, 1 block(s):  OK</div><div class="line">0. BP-1139418417-192.168.51.4-1514272982687:blk_1073743138_2323 len=133 Live_repl=2  </div><div class="line">[DatanodeInfoWithStorage[192.168.51.6:9866,DS-482194d9-aa70-4ab8-8253-907739d5b1a1,DISK], </div><div class="line"> DatanodeInfoWithStorage[192.168.51.5:9866,DS-f59711c6-801d-4ebc-b55c-228f225117b8,DISK]]</div><div class="line"></div><div class="line">##列出所有完整的replication的位置訊息</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -files -blocks -replicaDetails</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;files=1&amp;blocks=1&amp;replicadetails=1&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 for path /user/hadoop/test1.txt at Wed Jan 03 13:21:56 CST 2018</div><div class="line">/user/hadoop/test1.txt 133 bytes, replicated: replication=2, 1 block(s):  OK</div><div class="line">0. BP-1139418417-192.168.51.4-1514272982687:blk_1073743138_2323 len=133 Live_repl=2  </div><div class="line">[DatanodeInfoWithStorage[192.168.51.6:9866,DS-482194d9-aa70-4ab8-8253-907739d5b1a1,DISK](LIVE), </div><div class="line"> DatanodeInfoWithStorage[192.168.51.5:9866,DS-f59711c6-801d-4ebc-b55c-228f225117b8,DISK](LIVE)]</div><div class="line"></div><div class="line">##查看文件中損壞Blocks的狀況</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -list-corruptfileblocks</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;listcorruptfileblocks=1&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">The filesystem under path &apos;/user/hadoop/test1.txt&apos; has 0 CORRUPT files</div><div class="line"></div><div class="line">##列出指定的block的詳細資訊</div><div class="line">hadoop@hadoop-master:~$ hdfs fsck /user/hadoop/test1.txt -blockId blk_1073743138</div><div class="line">Connecting to namenode via http://hadoop-master:9870/fsck?ugi=hadoop&amp;blockId=blk_1073743138+&amp;path=%2Fuser%2Fhadoop%2Ftest1.txt</div><div class="line">FSCK started by hadoop (auth:SIMPLE) from /192.168.51.4 at Wed Jan 03 13:34:40 CST 2018</div><div class="line"></div><div class="line">Block Id: blk_1073743138</div><div class="line">Block belongs to: /user/hadoop/test1.txt</div><div class="line">No. of Expected Replica: 2</div><div class="line">No. of live Replica: 2</div><div class="line">No. of excess Replica: 0</div><div class="line">No. of stale Replica: 0</div><div class="line">No. of decommissioned Replica: 0</div><div class="line">No. of decommissioning Replica: 0</div><div class="line">No. of corrupted Replica: 0</div><div class="line">Block replica on datanode/rack: hadoop-slave1/default-rack is HEALTHY</div><div class="line">Block replica on datanode/rack: hadoop-slave2/default-rack is HEALTHY</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;hadoop-fsck使用方式&quot;&gt;&lt;a href=&quot;#hadoop-fsck使用方式&quot; class=&quot;headerlink&quot; title=&quot;hadoop fsck使用方式&quot;&gt;&lt;/a&gt;hadoop fsck使用方式&lt;/h4&gt;&lt;blockquote&gt;
&lt;figure 
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>hdfs dfsadmin command Memo</title>
    <link href="http://yoursite.com/2018/01/03/%5Bhadoop%5Dhdfs_dfsadmin_cmd/"/>
    <id>http://yoursite.com/2018/01/03/[hadoop]hdfs_dfsadmin_cmd/</id>
    <published>2018-01-02T16:00:00.000Z</published>
    <updated>2018-01-03T10:47:35.967Z</updated>
    
    <content type="html"><![CDATA[<h5 id="hdfs-dfsadmin相關語法"><a href="#hdfs-dfsadmin相關語法" class="headerlink" title="hdfs dfsadmin相關語法"></a>hdfs dfsadmin相關語法</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">Note: Administrative commands can only be run as the HDFS superuser.</div><div class="line">        [-report [-live] [-dead] [-decommissioning] [-enteringmaintenance] [-inmaintenance]]</div><div class="line">        [-safemode &lt;enter | leave | get | wait&gt;]</div><div class="line">        [-saveNamespace [-beforeShutdown]]</div><div class="line">        [-rollEdits]</div><div class="line">        [-restoreFailedStorage true|false|check]</div><div class="line">        [-refreshNodes]</div><div class="line">        [-setQuota &lt;quota&gt; &lt;dirname&gt;...&lt;dirname&gt;]</div><div class="line">        [-clrQuota &lt;dirname&gt;...&lt;dirname&gt;]</div><div class="line">        [-setSpaceQuota &lt;quota&gt; [-storageType &lt;storagetype&gt;] &lt;dirname&gt;...&lt;dirname&gt;]</div><div class="line">        [-clrSpaceQuota [-storageType &lt;storagetype&gt;] &lt;dirname&gt;...&lt;dirname&gt;]</div><div class="line">        [-finalizeUpgrade]</div><div class="line">        [-rollingUpgrade [&lt;query|prepare|finalize&gt;]]</div><div class="line">        [-refreshServiceAcl]</div><div class="line">        [-refreshUserToGroupsMappings]</div><div class="line">        [-refreshSuperUserGroupsConfiguration]</div><div class="line">        [-refreshCallQueue]</div><div class="line">        [-refresh &lt;host:ipc_port&gt; &lt;key&gt; [arg1..argn]</div><div class="line">        [-reconfig &lt;namenode|datanode&gt; &lt;host:ipc_port&gt; &lt;start|status|properties&gt;]</div><div class="line">        [-printTopology]</div><div class="line">        [-refreshNamenodes datanode_host:ipc_port]</div><div class="line">        [-getVolumeReport datanode_host:ipc_port]</div><div class="line">        [-deleteBlockPool datanode_host:ipc_port blockpoolId [force]]</div><div class="line">        [-setBalancerBandwidth &lt;bandwidth in bytes per second&gt;]</div><div class="line">        [-getBalancerBandwidth &lt;datanode_host:ipc_port&gt;]</div><div class="line">        [-fetchImage &lt;local directory&gt;]</div><div class="line">        [-allowSnapshot &lt;snapshotDir&gt;]</div><div class="line">        [-disallowSnapshot &lt;snapshotDir&gt;]</div><div class="line">        [-shutdownDatanode &lt;datanode_host:ipc_port&gt; [upgrade]]</div><div class="line">        [-evictWriters &lt;datanode_host:ipc_port&gt;]</div><div class="line">        [-getDatanodeInfo &lt;datanode_host:ipc_port&gt;]</div><div class="line">        [-metasave filename]</div><div class="line">        [-triggerBlockReport [-incremental] &lt;datanode_host:ipc_port&gt;]</div><div class="line">        [-listOpenFiles]</div><div class="line">        [-help [cmd]]</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-report"><a href="#hdfs-dfsadmin-report" class="headerlink" title="hdfs dfsadmin -report"></a>hdfs dfsadmin -report</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -report</div><div class="line">Configured Capacity: 42002972672 (39.12 GB)</div><div class="line">Present Capacity: 26379444224 (24.57 GB)</div><div class="line">DFS Remaining: 26331783168 (24.52 GB)</div><div class="line">DFS Used: 47661056 (45.45 MB)</div><div class="line">DFS Used%: 0.18%</div><div class="line">Replicated Blocks:</div><div class="line">        Under replicated blocks: 967</div><div class="line">        Blocks with corrupt replicas: 0</div><div class="line">        Missing blocks: 0</div><div class="line">        Missing blocks (with replication factor 1): 0</div><div class="line">        Pending deletion blocks: 0</div><div class="line">Erasure Coded Block Groups:</div><div class="line">        Low redundancy block groups: 0</div><div class="line">        Block groups with corrupt internal blocks: 0</div><div class="line">        Missing block groups: 0</div><div class="line">        Pending deletion blocks: 0</div><div class="line"></div><div class="line">-------------------------------------------------</div><div class="line">Live datanodes (2):</div><div class="line"></div><div class="line">Name: 192.168.51.5:9866 (hadoop-slave1)</div><div class="line">Hostname: hadoop-slave1</div><div class="line">Decommission Status : Normal</div><div class="line">Configured Capacity: 21001486336 (19.56 GB)</div><div class="line">DFS Used: 23842816 (22.74 MB)</div><div class="line">Non DFS Used: 6787604480 (6.32 GB)</div><div class="line">DFS Remaining: 13099626496 (12.20 GB)</div><div class="line">DFS Used%: 0.11%</div><div class="line">DFS Remaining%: 62.37%</div><div class="line">Configured Cache Capacity: 0 (0 B)</div><div class="line">Cache Used: 0 (0 B)</div><div class="line">Cache Remaining: 0 (0 B)</div><div class="line">Cache Used%: 100.00%</div><div class="line">Cache Remaining%: 0.00%</div><div class="line">Xceivers: 1</div><div class="line">Last contact: Wed Jan 03 17:52:32 CST 2018</div><div class="line">Last Block Report: Wed Jan 03 15:42:49 CST 2018</div><div class="line"></div><div class="line"></div><div class="line">Name: 192.168.51.6:9866 (hadoop-slave2)</div><div class="line">Hostname: hadoop-slave2</div><div class="line">Decommission Status : Normal</div><div class="line">Configured Capacity: 21001486336 (19.56 GB)</div><div class="line">DFS Used: 23818240 (22.71 MB)</div><div class="line">Non DFS Used: 6655098880 (6.20 GB)</div><div class="line">DFS Remaining: 13232156672 (12.32 GB)</div><div class="line">DFS Used%: 0.11%</div><div class="line">DFS Remaining%: 63.01%</div><div class="line">Configured Cache Capacity: 0 (0 B)</div><div class="line">Cache Used: 0 (0 B)</div><div class="line">Cache Remaining: 0 (0 B)</div><div class="line">Cache Used%: 100.00%</div><div class="line">Cache Remaining%: 0.00%</div><div class="line">Xceivers: 1</div><div class="line">Last contact: Wed Jan 03 17:52:33 CST 2018</div><div class="line">Last Block Report: Wed Jan 03 16:33:35 CST 2018</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-printTopology"><a href="#hdfs-dfsadmin-printTopology" class="headerlink" title="hdfs dfsadmin -printTopology"></a>hdfs dfsadmin -printTopology</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -printTopology</div><div class="line">Rack: /default-rack</div><div class="line">   192.168.51.5:9866 (hadoop-slave1)</div><div class="line">   192.168.51.6:9866 (hadoop-slave2)</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-getDatanodeInfo"><a href="#hdfs-dfsadmin-getDatanodeInfo" class="headerlink" title="hdfs dfsadmin -getDatanodeInfo"></a>hdfs dfsadmin -getDatanodeInfo</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -getDatanodeInfo 192.168.51.6:9867</div><div class="line">Uptime: 5100, Software version: 3.0.0, Config version: core-3.0.0,hdfs-1</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -getDatanodeInfo 192.168.51.5:9867</div><div class="line">Uptime: 10709, Software version: 3.0.0, Config version: core-3.0.0,hdfs-1</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-safemode"><a href="#hdfs-dfsadmin-safemode" class="headerlink" title="hdfs dfsadmin -safemode"></a>hdfs dfsadmin -safemode</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -safemode</div><div class="line">Usage: hdfs dfsadmin [-safemode enter | leave | get | wait | forceExit]</div><div class="line"></div><div class="line">##取得safemode模式</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -safemode get</div><div class="line">Safe mode is OFF</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put - /user/hadoop/snapshot/test3.txt</div><div class="line">3333</div><div class="line">4444</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/snapshot</div><div class="line">Found 3 items</div><div class="line">-rw-r--r--   1 hadoop supergroup         29 2018-01-03 16:53 /user/hadoop/snapshot/test1.txt</div><div class="line">-rw-r--r--   1 hadoop supergroup          7 2018-01-03 17:36 /user/hadoop/snapshot/test2.txt</div><div class="line">-rw-r--r--   1 hadoop supergroup         10 2018-01-03 18:04 /user/hadoop/snapshot/test3.txt</div><div class="line"></div><div class="line">##進入safemode模式</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -safemode enter</div><div class="line">Safe mode is ON</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -safemode get</div><div class="line">Safe mode is ON</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put - /user/hadoop/snapshot/test4.txt</div><div class="line">put: Cannot create file/user/hadoop/snapshot/test4.txt._COPYING_. Name node is in safe mode.</div><div class="line"></div><div class="line">##離開safemode模式</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -safemode leave</div><div class="line">Safe mode is OFF</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put - /user/hadoop/snapshot/test4.txt</div><div class="line">55555</div><div class="line">66666</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/snapshot</div><div class="line">Found 4 items</div><div class="line">-rw-r--r--   1 hadoop supergroup         29 2018-01-03 16:53 /user/hadoop/snapshot/test1.txt</div><div class="line">-rw-r--r--   1 hadoop supergroup          7 2018-01-03 17:36 /user/hadoop/snapshot/test2.txt</div><div class="line">-rw-r--r--   1 hadoop supergroup         10 2018-01-03 18:04 /user/hadoop/snapshot/test3.txt</div><div class="line">-rw-r--r--   1 hadoop supergroup         12 2018-01-03 18:05 /user/hadoop/snapshot/test4.txt</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-shutdownDatanode"><a href="#hdfs-dfsadmin-shutdownDatanode" class="headerlink" title="hdfs dfsadmin -shutdownDatanode"></a>hdfs dfsadmin -shutdownDatanode</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">##停掉 Datanode</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -shutdownDatanode hadoop-slave2:9867</div><div class="line">Submitted a shutdown request to datanode hadoop-slave2:9867</div><div class="line"></div><div class="line">##觀察 Datanode Status</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -report -dead</div><div class="line">Safe mode is ON</div><div class="line">Configured Capacity: 21001486336 (19.56 GB)</div><div class="line">Present Capacity: 13123469312 (12.22 GB)</div><div class="line">DFS Remaining: 13099626496 (12.20 GB)</div><div class="line">DFS Used: 23842816 (22.74 MB)</div><div class="line">DFS Used%: 0.18%</div><div class="line">Replicated Blocks:</div><div class="line">        Under replicated blocks: 971</div><div class="line">        Blocks with corrupt replicas: 0</div><div class="line">        Missing blocks: 2</div><div class="line">        Missing blocks (with replication factor 1): 2</div><div class="line">        Pending deletion blocks: 0</div><div class="line">Erasure Coded Block Groups:</div><div class="line">        Low redundancy block groups: 1</div><div class="line">        Block groups with corrupt internal blocks: 0</div><div class="line">        Missing block groups: 0</div><div class="line">        Pending deletion blocks: 0</div><div class="line"></div><div class="line">-------------------------------------------------</div><div class="line">Dead datanodes (1):</div><div class="line"></div><div class="line">Name: 192.168.51.6:9866 (hadoop-slave2)</div><div class="line">Hostname: hadoop-slave2</div><div class="line">Decommission Status : Normal</div><div class="line">Configured Capacity: 21001486336 (19.56 GB)</div><div class="line">DFS Used: 23834624 (22.73 MB)</div><div class="line">Non DFS Used: 6655102976 (6.20 GB)</div><div class="line">DFS Remaining: 13232136192 (12.32 GB)</div><div class="line">DFS Used%: 0.11%</div><div class="line">DFS Remaining%: 63.01%</div><div class="line">Configured Cache Capacity: 0 (0 B)</div><div class="line">Cache Used: 0 (0 B)</div><div class="line">Cache Remaining: 0 (0 B)</div><div class="line">Cache Used%: 100.00%</div><div class="line">Cache Remaining%: 0.00%</div><div class="line">Xceivers: 0</div><div class="line">Last contact: Wed Jan 03 18:16:00 CST 2018</div><div class="line">Last Block Report: Wed Jan 03 16:33:35 CST 2018</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-metasave"><a href="#hdfs-dfsadmin-metasave" class="headerlink" title="hdfs dfsadmin -metasave"></a>hdfs dfsadmin -metasave</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">## 產生所有metadata資訊,產生後會存放於hdfs系統的Log資料夾內</div><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -metasave metasave.txt</div><div class="line">Created metasave file metasave.txt in the log directory of namenode hdfs://hadoop-master:8020</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-listOpenFiles"><a href="#hdfs-dfsadmin-listOpenFiles" class="headerlink" title="hdfs dfsadmin -listOpenFiles"></a>hdfs dfsadmin -listOpenFiles</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -listOpenFiles</div><div class="line">Client Host             Client Name             Open File Path</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="hdfs-dfsadmin-triggerBlockReport"><a href="#hdfs-dfsadmin-triggerBlockReport" class="headerlink" title="hdfs dfsadmin -triggerBlockReport"></a>hdfs dfsadmin -triggerBlockReport</h6><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hdfs dfsadmin -triggerBlockReport 192.168.51.5:9867</div><div class="line">Triggering a full block report on 192.168.51.5:9867.</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;hdfs-dfsadmin相關語法&quot;&gt;&lt;a href=&quot;#hdfs-dfsadmin相關語法&quot; class=&quot;headerlink&quot; title=&quot;hdfs dfsadmin相關語法&quot;&gt;&lt;/a&gt;hdfs dfsadmin相關語法&lt;/h5&gt;&lt;blockquote&gt;

    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>Hadoop權限操作說明</title>
    <link href="http://yoursite.com/2018/01/02/%5Bhadoop%5DHadoop_permission_memo/"/>
    <id>http://yoursite.com/2018/01/02/[hadoop]Hadoop_permission_memo/</id>
    <published>2018-01-01T16:00:00.000Z</published>
    <updated>2018-01-02T06:37:50.373Z</updated>
    
    <content type="html"><![CDATA[<h4 id="使用到的HDFS語法整理"><a href="#使用到的HDFS語法整理" class="headerlink" title="使用到的HDFS語法整理"></a>使用到的HDFS語法整理</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">hadoop fs -ls -d /user/hadoop</div><div class="line">hadoop fs -put ~/test1.txt /user/hadoop</div><div class="line">hadoop fs -chmod -R 757 /user/hadoop</div><div class="line">hadoop fs -ls  /user/hadoop</div><div class="line">hadoop fs -chown hadoop /user/hadoop/test1.txt</div><div class="line">hadoop fs -appendToFile - /user/hadoop/test1.txt</div><div class="line">hadoop fs -cat /user/hadoop/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="以下為操作驗證"><a href="#以下為操作驗證" class="headerlink" title="以下為操作驗證"></a>以下為操作驗證</h4><h5 id="使用hadoop語法查看目錄權限"><a href="#使用hadoop語法查看目錄權限" class="headerlink" title="使用hadoop語法查看目錄權限"></a>使用hadoop語法查看目錄權限</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$hadoop fs -ls -d /user/hadoop</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2017-12-27 18:39 /user/hadoop</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="使用putty-以hadoop帳號-登入-hadoop-master主機建立一個新帳號"><a href="#使用putty-以hadoop帳號-登入-hadoop-master主機建立一個新帳號" class="headerlink" title="使用putty(以hadoop帳號)登入,hadoop-master主機建立一個新帳號"></a>使用putty(以hadoop帳號)登入,hadoop-master主機建立一個新帳號</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$sudo useradd -m popal</div><div class="line">hadoop@hadoop-master:~$ls -la /home</div><div class="line">hadoop@hadoop-master:~$sudo passwd popal</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="建立一個文字檔"><a href="#建立一個文字檔" class="headerlink" title="建立一個文字檔"></a>建立一個文字檔</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$su - popal</div><div class="line">popal@hadoop-master:~$vi ~/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="使用hadoop語法-上傳至HDFS時-出現錯誤訊息"><a href="#使用hadoop語法-上傳至HDFS時-出現錯誤訊息" class="headerlink" title="使用hadoop語法,上傳至HDFS時,出現錯誤訊息"></a>使用hadoop語法,上傳至HDFS時,出現錯誤訊息</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -put ~/test1.txt /user/hadoop</div><div class="line">Error:&quot;put: Permission denied: user=popal, access=WRITE, inode=&quot;/user/hadoop&quot;:hadoop:supergroup:drwxr-xr-x&quot;</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="將-user-hadoop權限變更"><a href="#將-user-hadoop權限變更" class="headerlink" title="將/user/hadoop權限變更"></a>將/user/hadoop權限變更</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">popal@hadoop-master:~$su - hadoop</div><div class="line">hadoop@hadoop-master:~$hadoop fs -chmod -R 757 /user/hadoop</div><div class="line">hadoop@hadoop-master:~$hadoop fs -ls -d /user/hadoop</div><div class="line">drwxr-xrwx   - hadoop supergroup          0 2017-12-27 18:39 /user/hadoop</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="使用popal帳號再傳送一次檔案"><a href="#使用popal帳號再傳送一次檔案" class="headerlink" title="使用popal帳號再傳送一次檔案"></a>使用popal帳號再傳送一次檔案</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$su - popal</div><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -put ~/test1.txt /user/hadoop</div><div class="line">(沒有任何錯誤訊息,並傳送成功)</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="觀察檔案是否有上傳至HDFS"><a href="#觀察檔案是否有上傳至HDFS" class="headerlink" title="觀察檔案是否有上傳至HDFS"></a>觀察檔案是否有上傳至HDFS</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -ls  /user/hadoop</div><div class="line">-rw-r--r--   3 popal  supergroup         95 2018-01-02 10:43 /user/hadoop/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="將原本權限復原"><a href="#將原本權限復原" class="headerlink" title="將原本權限復原"></a>將原本權限復原</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">popal@hadoop-master:~$su - hadoop</div><div class="line">hadoop@hadoop-master:~$hadoop fs -chmod -R 755 /user/hadoop</div><div class="line">hadoop@hadoop-master:~$hadoop fs -ls /user/hadoop</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="將test1-txt的擁有者變更成hadoop"><a href="#將test1-txt的擁有者變更成hadoop" class="headerlink" title="將test1.txt的擁有者變更成hadoop"></a>將test1.txt的擁有者變更成hadoop</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$hadoop fs -chown hadoop /user/hadoop/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="使用popal使用者變更test1-txt內容"><a href="#使用popal使用者變更test1-txt內容" class="headerlink" title="使用popal使用者變更test1.txt內容"></a>使用popal使用者變更test1.txt內容</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$su - popal</div><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -appendToFile - /user/hadoop/test1.txt</div><div class="line">Error&quot;appendToFile: Permission denied: user=popal, access=WRITE, inode=&quot;/user/hadoop/test1.txt&quot;:hadoop:supergroup:-rwxr-xr-x&quot;</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="將-user-hadoop-test1-txt的擁有者變更"><a href="#將-user-hadoop-test1-txt的擁有者變更" class="headerlink" title="將/user/hadoop/test1.txt的擁有者變更"></a>將/user/hadoop/test1.txt的擁有者變更</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">popal@hadoop-master:~$su - hadoop</div><div class="line">hadoop@hadoop-master:~$hadoop fs -chown popal /user/hadoop/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="使用popal的帳號再變更-user-hadoop-test1-txt"><a href="#使用popal的帳號再變更-user-hadoop-test1-txt" class="headerlink" title="使用popal的帳號再變更/user/hadoop/test1.txt"></a>使用popal的帳號再變更/user/hadoop/test1.txt</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$su - popal</div><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -appendToFile - /user/hadoop/test1.txt</div><div class="line">popal@hadoop-master:~$/bgdt/hadoop-3.0.0/bin/hadoop fs -cat /user/hadoop/test1.txt</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;使用到的HDFS語法整理&quot;&gt;&lt;a href=&quot;#使用到的HDFS語法整理&quot; class=&quot;headerlink&quot; title=&quot;使用到的HDFS語法整理&quot;&gt;&lt;/a&gt;使用到的HDFS語法整理&lt;/h4&gt;&lt;blockquote&gt;
&lt;figure class=&quot;highl
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>hadoop fs command Memo</title>
    <link href="http://yoursite.com/2018/01/02/%5Bhadoop%5Dhadoop_fs_cmd/"/>
    <id>http://yoursite.com/2018/01/02/[hadoop]hadoop_fs_cmd/</id>
    <published>2018-01-01T16:00:00.000Z</published>
    <updated>2018-01-03T05:00:48.798Z</updated>
    
    <content type="html"><![CDATA[<h4 id="建立與刪除目錄"><a href="#建立與刪除目錄" class="headerlink" title="建立與刪除目錄"></a>建立與刪除目錄</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">##建立目錄但不會將上層目錄一併建立完成</div><div class="line">hadoop@hadoop-master:~$hadoop fs -mkdir /user/hadoop/example/lab_1</div><div class="line">mkdir: `/user/hadoop/example/lab_1&apos;: No such file or directory</div><div class="line"></div><div class="line">##建立目錄,會連同上層目錄一併建立</div><div class="line">hadoop@hadoop-master:~$hadoop fs -mkdir -p /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$hadoop fs ls -d /user/hadoop/example</div><div class="line"></div><div class="line">##刪除一個空目錄</div><div class="line">hadoop@hadoop-master:~$hadoop fs -rmdir /user/hadoop/example/lab_1</div><div class="line"></div><div class="line">##透過std in 建立一個test1.txt檔案</div><div class="line">hadoop@hadoop-master:~$hadoop fs -put -f - /user/hadoop/example/test1.txt</div><div class="line"></div><div class="line">##無法刪除,目錄下有檔案</div><div class="line">hadoop@hadoop-master:~$hadoop fs -rmdir  /user/hadoop/example</div><div class="line">&quot;rmdir: `/user/hadoop/example&apos;: Directory is not empty&quot;</div><div class="line"></div><div class="line">##將所有檔案刪除完成後,刪除目錄</div><div class="line">hadoop@hadoop-master:~$hadoop fs -rm -r -f  /user/hadoop/example			</div><div class="line"></div><div class="line">##建立目錄</div><div class="line">hadoop@hadoop-master:~$hadoop fs -mkdir -p /user/hadoop/example/lab_1</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="檔案建立-複製-刪除-搬移"><a href="#檔案建立-複製-刪除-搬移" class="headerlink" title="檔案建立/複製/刪除/搬移"></a>檔案建立/複製/刪除/搬移</h4><h5 id="put-get操作檔案"><a href="#put-get操作檔案" class="headerlink" title="put/get操作檔案"></a>put/get操作檔案</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$rm -rf  ~/get_hdfs_test2.txt</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$dd if=/dev/urandom of=test2.txt bs=1K count=1</div><div class="line">1+0 records in</div><div class="line">1+0 records out</div><div class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.00234966 s, 436 kB/s</div><div class="line"></div><div class="line">##使用PUT上傳檔案到HDFS</div><div class="line">hadoop@hadoop-master:~$hadoop fs -put ~/test2.txt /user/hadoop/example/</div><div class="line">hadoop@hadoop-master:~$hadoop fs -ls /user/hadoop/example</div><div class="line">Found 2 items</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 15:40 /user/hadoop/example/lab_1</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/test2.txt</div><div class="line"></div><div class="line">##使用GET下載檔案到Local</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -get /user/hadoop/example/test2.txt ~/get_hdfs_test2.txt</div><div class="line">hadoop@hadoop-master:~$ ls -la ~/get*</div><div class="line">-rw-r--r-- 1 hadoop hadoop 1024 Jan  2 15:44 /home/hadoop/get_hdfs_test2.txt</div><div class="line"></div><div class="line"></div><div class="line">##使用getmerge結合數個檔案內容,並下載至Local</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put - /user/hadoop/example/lab_1/test1.txt</div><div class="line">1,&quot;test_001&quot;,10000</div><div class="line">2,&quot;test_002&quot;,20000</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put - /user/hadoop/example/lab_1/test2.txt</div><div class="line">3,&quot;test_003&quot;,30000</div><div class="line">4,&quot;test_004&quot;,40000</div><div class="line">hadoop@hadoop-master:~$ rm -rf ~/merge_file.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -getmerge -nl /user/hadoop/example/lab_1/* ~/merge_file.txt</div><div class="line">hadoop@hadoop-master:~$ ls -la ~/merge_file.txt</div><div class="line">-rw-r--r-- 1 hadoop hadoop 78 Jan  2 15:53 /home/hadoop/merge_file.txt</div><div class="line">hadoop@hadoop-master:~$ cat ~/merge_file.txt</div><div class="line">1,&quot;test_001&quot;,10000</div><div class="line">2,&quot;test_002&quot;,20000</div><div class="line"></div><div class="line">3,&quot;test_003&quot;,30000</div><div class="line">4,&quot;test_004&quot;,40000</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="copy-move操作檔案"><a href="#copy-move操作檔案" class="headerlink" title="copy/move操作檔案"></a>copy/move操作檔案</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line">## copyfromlocal/copytolocal操作</div><div class="line">hadoop@hadoop-master:~$ dd if=/dev/urandom of=test3.txt bs=1K count=1</div><div class="line">1+0 records in</div><div class="line">1+0 records out</div><div class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.00109903 s, 932 kB/s</div><div class="line">hadoop@hadoop-master:~$ rm -rf ~/cp_hdfs_tolocal_test3.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -copyFromLocal ~/test3.txt /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 3 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -copyToLocal  /user/hadoop/example/lab_1/test3.txt ~/cp_hdfs_tolocal_test3.txt</div><div class="line">hadoop@hadoop-master:~$ ls -la ~/cp_hdfs_tolocal_test3.txt</div><div class="line">-rw-r--r-- 1 hadoop hadoop 1024 Jan  2 16:01 /home/hadoop/cp_hdfs_tolocal_test3.txt</div><div class="line">hadoop@hadoop-master:~$</div><div class="line"></div><div class="line">## cp操作(同一個HDFS中資料複製)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 3 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cp /user/hadoop/example/test2.txt  /user/hadoop/example/lab_1/test4.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 4 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example</div><div class="line">Found 2 items</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 16:14 /user/hadoop/example/lab_1</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/test2.txt</div><div class="line"></div><div class="line">## cp操作(不同HDFS中資料複製)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cp hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test5.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 5 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cat /user/hadoop/example/lab_1/test5.txt</div><div class="line">id,end_date,start_date,location</div><div class="line">1,2015-10-14 00:00:00,2015-09-14 00:00:00,CA-SF</div><div class="line">2,2015-10-15 01:00:20,2015-08-14 00:00:00,CA-SD</div><div class="line">3,2015-10-16 02:30:00,2015-01-14 00:00:00,NY-NY</div><div class="line">4,2015-10-17 03:00:20,2015-02-14 00:00:00,NY-NY</div><div class="line">5,2015-10-18 04:30:00,2014-04-14 00:00:00,CA-SD</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls hdfs://172.20.22.95:8020/user/hadoop/tmp</div><div class="line">Found 1 items</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2017-11-22 17:09 hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv</div><div class="line"></div><div class="line">## moveFromLocal/moveToLocal</div><div class="line">hadoop@hadoop-master:~$ dd if=/dev/urandom of=test6.txt bs=1K count=1</div><div class="line">1+0 records in</div><div class="line">1+0 records out</div><div class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.00116886 s, 876 kB/s</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -moveFromLocal ~/test6.txt /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 6 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -moveToLocal /user/hadoop/example/test6.txt ~/mv_hdfs_tolocal_test6.txt</div><div class="line">moveToLocal: Option &apos;-moveToLocal&apos; is not implemented yet.</div><div class="line"></div><div class="line">## mv操作(同一個HDFS中資料複製),被搬移之後檔案會不見</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 6 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -mv /user/hadoop/example/test2.txt /user/hadoop/example/lab_1/test7.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 7 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example</div><div class="line">Found 1 items</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 16:21 /user/hadoop/example/lab_1</div><div class="line"></div><div class="line">## mv操作(不同一個HDFS中資料複製),如果hadoop版本不一致無法使用mv搬移檔案</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls hdfs://172.20.22.95:8020/user/hadoop/tmp</div><div class="line">Found 1 items</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2017-11-22 17:09 hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls hdfs://192.168.51.4:8020/user/hadoop/example/lab_1</div><div class="line">Found 7 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test7.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -mv hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test8.txt</div><div class="line">mv: `hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv&apos;: Does not match target filesystem</div><div class="line">hadoop@hadoop-master:~$  hadoop fs -cp hdfs://172.20.22.95:8020/user/hadoop/tmp/test2.csv  hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test8.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls hdfs://192.168.51.4:8020/user/hadoop/example/lab_1</div><div class="line">Found 8 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 hdfs://192.168.51.4:8020/user/hadoop/example/lab_1/test8.txt</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="查看檔案內容"><a href="#查看檔案內容" class="headerlink" title="查看檔案內容"></a>查看檔案內容</h4><h5 id="檢視壓縮檔案內容-tar-gz"><a href="#檢視壓縮檔案內容-tar-gz" class="headerlink" title="檢視壓縮檔案內容(.tar.gz)"></a>檢視壓縮檔案內容(.tar.gz)</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ tar -zcvf ~/test9.tar.gz &quot;test1.csv&quot; &quot;test2.csv&quot; &quot;test3.csv&quot;</div><div class="line">test1.csv</div><div class="line">test2.csv</div><div class="line">test3.csv</div><div class="line">hadoop@hadoop-master:~$ tar -ztvf ~/test9.tar.gz</div><div class="line">-rw-rw-r-- hadoop/hadoop   272 2017-11-08 15:49 test1.csv</div><div class="line">-rw-rw-r-- hadoop/hadoop   300 2017-11-06 19:14 test2.csv</div><div class="line">-rw-rw-r-- hadoop/hadoop   422 2017-08-21 16:30 test3.csv</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -put ~/test9.tar.gz /user/hadoop/example/lab_1/</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 9 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:50 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">##可以使用hadoop fs -text來查看壓縮檔案內容</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -text /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line">test1.csv0000664000175100017510000000042013200533434012136 0ustar  hadoophadoop100,1,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.1&quot;</div><div class="line">200,2,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.2&quot;</div><div class="line">150,3,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.3&quot;</div><div class="line">300,4,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.4&quot;</div><div class="line">..........</div><div class="line">5,&quot;http://www.google.com&quot;;&quot;192.168.1.5&quot;;&quot;201&quot;,&quot;005&quot;;&quot;test1_005&quot;;&quot;500&quot;</div><div class="line">6,&quot;http://www.google.com&quot;;&quot;192.168.1.6&quot;;&quot;403&quot;,&quot;006&quot;;&quot;test1_006&quot;;&quot;1600&quot;</div><div class="line"></div><div class="line">##hadoop fs -cat查看壓縮檔時,會出現亂碼,需要配合zcat指令來查看</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cat /user/hadoop/example/lab_1/test9.tar.gz | zcat</div><div class="line">test1.csv0000664000175100017510000000042013200533434012136 0ustar  hadoophadoop100,1,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.1&quot;</div><div class="line">200,2,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.2&quot;</div><div class="line">150,3,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.3&quot;</div><div class="line">300,4,&quot;http://www.google.com&quot;,&quot;http://www.google.com&quot;,&quot;192.168.1.4&quot;</div><div class="line">..........</div><div class="line">5,&quot;http://www.google.com&quot;;&quot;192.168.1.5&quot;;&quot;201&quot;,&quot;005&quot;;&quot;test1_005&quot;;&quot;500&quot;</div><div class="line">6,&quot;http://www.google.com&quot;;&quot;192.168.1.6&quot;;&quot;403&quot;,&quot;006&quot;;&quot;test1_006&quot;;&quot;1600&quot;</div></pre></td></tr></table></figure>
</blockquote>
<h5 id="檢視檔案內容-且資料append到檔案時-會馬上呈現"><a href="#檢視檔案內容-且資料append到檔案時-會馬上呈現" class="headerlink" title="檢視檔案內容,且資料append到檔案時,會馬上呈現"></a>檢視檔案內容,且資料append到檔案時,會馬上呈現</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">##hadoop fs -tail指令的功能(與cat/text相同可以觀察檔案內容)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -tail /user/hadoop/example/lab_1/test1.txt</div><div class="line">1,&quot;test_001&quot;,10000</div><div class="line">2,&quot;test_002&quot;,20000</div></pre></td></tr></table></figure>
</blockquote>
<h6 id="以下使用圖片說明"><a href="#以下使用圖片說明" class="headerlink" title="以下使用圖片說明"></a>以下使用圖片說明</h6><blockquote>
<p>hadoop fs -tail時,可以查看檔案完整內容<br><img src="/images/hadoop_fs_cmd/tail_1.jpg" alt=""><br>hadoop fs -tail -f 時,持續呈現檔案Append的相關內容<br><img src="/images/hadoop_fs_cmd/tail_2_1.jpg" alt=""><br><img src="/images/hadoop_fs_cmd/tail_2_2.jpg" alt=""></p>
</blockquote>
<h4 id="建立空檔案vs-清空檔案內容"><a href="#建立空檔案vs-清空檔案內容" class="headerlink" title="建立空檔案vs.清空檔案內容"></a>建立空檔案vs.清空檔案內容</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">##使用 -touchz建立一個空的檔案,常用於建立時戳或者flag檔案</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 9 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         76 2018-01-02 17:28 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -touchz /user/hadoop/example/lab_1/test10.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 10 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         76 2018-01-02 17:28 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cat /user/hadoop/example/lab_1/test1.txt</div><div class="line">1,&quot;test_001&quot;,10000</div><div class="line">2,&quot;test_002&quot;,20000</div><div class="line">3,&quot;test_003&quot;,30000</div><div class="line">4,&quot;test_004&quot;,40000</div><div class="line"></div><div class="line">## -truncate -w 10,只留10 bytes資料</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -truncate -w 10 /user/hadoop/example/lab_1/test1.txt</div><div class="line">Waiting for /user/hadoop/example/lab_1/test1.txt ...</div><div class="line">Truncated /user/hadoop/example/lab_1/test1.txt to length: 10</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cat /user/hadoop/example/lab_1/test1.txt</div><div class="line">1,&quot;test_00</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         10 2018-01-02 17:42 /user/hadoop/example/lab_1/test1.txt</div><div class="line"></div><div class="line">## -truncate -w 0,資料全部清空</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -truncate -w 0 /user/hadoop/example/lab_1/test1.txt</div><div class="line">Truncated /user/hadoop/example/lab_1/test1.txt to length: 0</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -cat /user/hadoop/example/lab_1/test1.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-find找檔案"><a href="#使用hadoop-fs-find找檔案" class="headerlink" title="使用hadoop fs -find找檔案"></a>使用hadoop fs -find找檔案</h4><blockquote>
<p>此部分可以參考Linux find指令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">說明:</div><div class="line">-iname pattern 所要查找的文檔名，不區分大小寫</div><div class="line">-name pattern  所要查找的文檔名，區分大小寫</div><div class="line">-print 換行列印</div><div class="line">-print0 連續列印</div><div class="line"></div><div class="line">##-name後,可接欲找尋的檔案名稱,&quot;*&quot;代表任何值</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -find / -name &quot;test*.txt&quot; -print</div><div class="line">/user/hadoop/example/lab_1/test1.txt</div><div class="line">/user/hadoop/example/lab_1/test10.txt</div><div class="line">/user/hadoop/example/lab_1/test2.txt</div><div class="line">/user/hadoop/example/lab_1/test3.txt</div><div class="line">/user/hadoop/example/lab_1/test4.txt</div><div class="line">/user/hadoop/example/lab_1/test5.txt</div><div class="line">/user/hadoop/example/lab_1/test6.txt</div><div class="line">/user/hadoop/example/lab_1/test7.txt</div><div class="line">/user/hadoop/example/lab_1/test8.txt</div><div class="line">/user/hadoop/test1.txt</div><div class="line">##-name後,可接正規式的相關參數</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -find / -name &quot;[A-Z,a-z]*.db&quot; -print</div><div class="line">/user/hive/warehouse/test1.db</div><div class="line">/user/hive/warehouse/test2.db</div><div class="line">/user/hive/warehouse/test3.db</div><div class="line">/user/hive/warehouse/test4.db</div><div class="line">/user/hive/warehouse/test5.db</div><div class="line">/user/hive/warehouse/test6.db</div></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="使用hadoop-fs-df-du查看檔案目錄的大小"><a href="#使用hadoop-fs-df-du查看檔案目錄的大小" class="headerlink" title="使用hadoop fs -df/-du查看檔案目錄的大小"></a>使用hadoop fs -df/-du查看檔案目錄的大小</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">##後面如果都沒接任何參數,看各個檔案的大小(以byte為單位)及檔名</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -du /user/hadoop/example/lab_1</div><div class="line">0     0     /user/hadoop/example/lab_1/test1.txt</div><div class="line">0     0     /user/hadoop/example/lab_1/test10.txt</div><div class="line">38    76    /user/hadoop/example/lab_1/test2.txt</div><div class="line">1024  2048  /user/hadoop/example/lab_1/test3.txt</div><div class="line">1024  2048  /user/hadoop/example/lab_1/test4.txt</div><div class="line">272   544   /user/hadoop/example/lab_1/test5.txt</div><div class="line">1024  2048  /user/hadoop/example/lab_1/test6.txt</div><div class="line">1024  2048  /user/hadoop/example/lab_1/test7.txt</div><div class="line">272   544   /user/hadoop/example/lab_1/test8.txt</div><div class="line">373   746   /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">##加入&quot;-h&quot;,在顯示檔案大小時,會將單位標示出來</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -du -h /user/hadoop/example/lab_1</div><div class="line">0    0    /user/hadoop/example/lab_1/test1.txt</div><div class="line">0    0    /user/hadoop/example/lab_1/test10.txt</div><div class="line">38   76   /user/hadoop/example/lab_1/test2.txt</div><div class="line">1 K  2 K  /user/hadoop/example/lab_1/test3.txt</div><div class="line">1 K  2 K  /user/hadoop/example/lab_1/test4.txt</div><div class="line">272  544  /user/hadoop/example/lab_1/test5.txt</div><div class="line">1 K  2 K  /user/hadoop/example/lab_1/test6.txt</div><div class="line">1 K  2 K  /user/hadoop/example/lab_1/test7.txt</div><div class="line">272  544  /user/hadoop/example/lab_1/test8.txt</div><div class="line">373  746  /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">##加入&quot;-s&quot;,最主要是用來顯示該目錄下所有檔案的summary後的大小</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -du -h -s /user/hadoop/example/lab_1</div><div class="line">4.9 K  9.9 K  /user/hadoop/example/lab_1</div><div class="line"></div><div class="line">##hadoop fs -du 加入&quot;-v&quot;,可以看到每個欄位的標題</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -du -h -v  /user/hadoop/example/lab_1</div><div class="line">SIZE  DISK_SPACE_CONSUMED_WITH_ALL_REPLICAS  FULL_PATH_NAME</div><div class="line">0     0                                      /user/hadoop/example/lab_1/test1.txt</div><div class="line">0     0                                      /user/hadoop/example/lab_1/test10.txt</div><div class="line">38    76                                     /user/hadoop/example/lab_1/test2.txt</div><div class="line">1 K   2 K                                    /user/hadoop/example/lab_1/test3.txt</div><div class="line">1 K   2 K                                    /user/hadoop/example/lab_1/test4.txt</div><div class="line">272   544                                    /user/hadoop/example/lab_1/test5.txt</div><div class="line">1 K   2 K                                    /user/hadoop/example/lab_1/test6.txt</div><div class="line">1 K   2 K                                    /user/hadoop/example/lab_1/test7.txt</div><div class="line">272   544                                    /user/hadoop/example/lab_1/test8.txt</div><div class="line">373   746                                    /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">## hadoop fs -df 顯示HDFS系統(多個)剩餘空間</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -df hdfs://172.20.22.95:8020 hdfs://192.168.51.4:8020</div><div class="line">Filesystem                         Size         Used      Available  Use%</div><div class="line">hdfs://172.20.22.95:8020  2232839094272  29245636608  1911548899328    1%</div><div class="line">hdfs://192.168.51.4:8020    42002972672     47734784    26333745152    0%</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-ls查看檔案目錄相關資訊"><a href="#使用hadoop-fs-ls查看檔案目錄相關資訊" class="headerlink" title="使用hadoop fs -ls查看檔案目錄相關資訊"></a>使用hadoop fs -ls查看檔案目錄相關資訊</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">##</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example</div><div class="line">Found 2 items</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1</div><div class="line">-rw-r--r--   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">##-r  Reverse the order of the sort</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls -r /user/hadoop/example</div><div class="line">Found 2 items</div><div class="line">-rw-r--r--   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1</div><div class="line"></div><div class="line">## 檢視&quot;-R&quot;遞回目錄下所有檔案及目錄</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls -R /user/hadoop/example</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line">-rw-r--r--   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">## &quot;-d&quot;只顯示目前只定的檔案或目錄</div><div class="line">hadoop fs -ls -d /user/hadoop/example</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-02 18:29 /user/hadoop/example</div><div class="line"></div><div class="line">## &quot;-e&quot; Display the erasure coding policy of files and directories.</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls -e /user/hadoop/example/lab_1</div><div class="line">Found 10 items</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2  hadoop supergroup Replicated        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-count查看檔案目錄相關資訊"><a href="#使用hadoop-fs-count查看檔案目錄相關資訊" class="headerlink" title="使用hadoop fs -count查看檔案目錄相關資訊"></a>使用hadoop fs -count查看檔案目錄相關資訊</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">##計算指定的目錄或檔案的數量大小</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -count &quot;/user/hadoop/example/*&quot;</div><div class="line">           1           10               5051 /user/hadoop/example/lab_1</div><div class="line">           0            1                 36 /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">## &quot;-q&quot;選項會多出以下欄位</div><div class="line">## QUOTA,REM_QUOTA,SPACE_QUOTA,REM_SPACE_QUOTA,DIR_COUNT,FILE_COUNT,CONTENT_SIZE,PATHNAME	   </div><div class="line">hadoop@hadoop-master:~$ hadoop fs -count -q &quot;/user/hadoop/example/*&quot;</div><div class="line">        none             inf            none             inf            1           10               5051 /user/hadoop/example/lab_1</div><div class="line">        none             inf            none             inf            0            1                 36 /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">## &quot;-u&quot; option shows the quota and the usage against the quota without the detailed content summary</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -count -u &quot;/user/hadoop/example/*&quot;</div><div class="line">        none             inf            none             inf /user/hadoop/example/lab_1</div><div class="line">        none             inf            none             inf /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">## &quot;-e&quot; option shows the erasure coding policy.</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -count -e &quot;/user/hadoop/example/*&quot;</div><div class="line">           1           10               5051 EC: /user/hadoop/example/lab_1</div><div class="line">           0            1                 36 Replicated /user/hadoop/example/test.txt</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-stat查看檔案目錄相關資訊"><a href="#使用hadoop-fs-stat查看檔案目錄相關資訊" class="headerlink" title="使用hadoop fs -stat查看檔案目錄相關資訊"></a>使用hadoop fs -stat查看檔案目錄相關資訊</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">##相關-stat Format說明</div><div class="line">%a: octal</div><div class="line">%A: symbolic</div><div class="line">%b: filesize in bytes</div><div class="line">%F: type</div><div class="line">%g: group name of owner</div><div class="line">%n: name</div><div class="line">%o: block size</div><div class="line">%r: replication</div><div class="line">%u: user name of owner</div><div class="line">%x,%X :access date</div><div class="line">%y,%Y :modification date</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -stat /user/*</div><div class="line">2018-01-02 09:05:22</div><div class="line">2017-12-26 10:44:41</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -stat &quot;%A,perm:%a,type:%F,%u:%g,size:%b,block size:%o,%r,mtime:%y atime:%x name:%n&quot; &quot;/user/hadoop/example/lab_1/*&quot;</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:0,block size:67108864,2,mtime:2018-01-02 09:45:22 atime:2018-01-02 09:18:30 name:test1.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:0,block size:67108864,2,mtime:2018-01-02 09:38:21 atime:2018-01-02 09:38:21 name:test10.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:38,block size:67108864,2,mtime:2018-01-02 07:51:41 atime:2018-01-02 07:51:16 name:test2.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:1024,block size:67108864,2,mtime:2018-01-02 07:59:28 atime:2018-01-02 07:59:28 name:test3.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:1024,block size:67108864,2,mtime:2018-01-02 08:07:12 atime:2018-01-02 08:07:12 name:test4.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:272,block size:67108864,2,mtime:2018-01-02 08:11:21 atime:2018-01-02 08:11:21 name:test5.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:1024,block size:67108864,2,mtime:2018-01-02 08:14:24 atime:2018-01-02 08:14:23 name:test6.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:1024,block size:67108864,2,mtime:2018-01-02 07:40:46 atime:2018-01-02 07:40:46 name:test7.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:272,block size:67108864,2,mtime:2018-01-02 08:31:28 atime:2018-01-02 08:31:28 name:test8.txt</div><div class="line">rw-r--r--,perm:644,type:regular file,hadoop:supergroup,size:373,block size:67108864,2,mtime:2018-01-02 09:05:38 atime:2018-01-02 09:05:37 name:test9.tar.gz</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-test檔案測試"><a href="#使用hadoop-fs-test檔案測試" class="headerlink" title="使用hadoop fs -test檔案測試"></a>使用hadoop fs -test檔案測試</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line">##相關參數說明:</div><div class="line">-d  return 0 if &lt;path&gt; is a directory.</div><div class="line">-e  return 0 if &lt;path&gt; exists.</div><div class="line">-f  return 0 if &lt;path&gt; is a file.</div><div class="line">-s  return 0 if file &lt;path&gt; is greater than zero bytes in size.</div><div class="line">-w  return 0 if file &lt;path&gt; exists and write permission is granted.</div><div class="line">-r  return 0 if file &lt;path&gt; exists and read permission is granted.</div><div class="line">-z  return 0 if file &lt;path&gt; is zero bytes in size, else return 1.</div><div class="line">---</div><div class="line"></div><div class="line">## &quot;-e&quot; 判斷指定的路徑是否存在(0:是,1:否)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -e /user/hadoop</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -e /user/vagrant</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line"></div><div class="line">## &quot;-d&quot; 判斷是否為目錄(0:是,1:否)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -d /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -d /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line"></div><div class="line"></div><div class="line">## &quot;-f&quot; 判斷是否為目錄(0:是,1:否)</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -f /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -f /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line"></div><div class="line">## &quot;-w&quot;判斷檔案是否有寫的權限</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/test.txt</div><div class="line">-rwxr-xr-x   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -w  /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line">hadoop@hadoop-master:~$ su - popal</div><div class="line">Password:</div><div class="line">popal@hadoop-master:~$ /bgdt/hadoop-3.0.0/bin/hadoop fs -test -w  /user/hadoop/example/test.txt</div><div class="line">popal@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -chmod 766 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/test.txt</div><div class="line">-rwxrw-rw-   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ su - popal</div><div class="line">Password:</div><div class="line">popal@hadoop-master:~$ /bgdt/hadoop-3.0.0/bin/hadoop fs -test -w /user/hadoop/example/test.txt</div><div class="line">popal@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line"></div><div class="line">## &quot;-r&quot;判斷檔案是否有讀的權限</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/test.txt</div><div class="line">-rwxrw-rw-   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ su - popal</div><div class="line">Password:</div><div class="line">popal@hadoop-master:~$ /bgdt/hadoop-3.0.0/bin/hadoop fs -test -r /user/hadoop/example/test.txt</div><div class="line">popal@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line">popal@hadoop-master:~$ exit</div><div class="line">logout</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -chmod 700 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/test.txt</div><div class="line">-rwx------   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line">hadoop@hadoop-master:~$ su - popal</div><div class="line">Password:</div><div class="line">popal@hadoop-master:~$ /bgdt/hadoop-3.0.0/bin/hadoop fs -test -r /user/hadoop/example/test.txt</div><div class="line">popal@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line"></div><div class="line">## &quot;-z&quot;判斷檔案是否為0 bytes</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 10 items</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -z /user/hadoop/example/lab_1/test1.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -z /user/hadoop/example/lab_1/test2.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line"></div><div class="line">## &quot;-s&quot;判斷檔案是否不為0 bytes</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -s /user/hadoop/example/lab_1/test1.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -test -s /user/hadoop/example/lab_1/test2.txt</div><div class="line">hadoop@hadoop-master:~$ echo $?</div><div class="line">0</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-setrep-設定檔案複本數"><a href="#使用hadoop-fs-setrep-設定檔案複本數" class="headerlink" title="使用hadoop fs -setrep 設定檔案複本數"></a>使用hadoop fs -setrep 設定檔案複本數</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 10 items</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -setrep -w 1 /user/hadoop/example/lab_1/test1.txt</div><div class="line">Replication 1 set: /user/hadoop/example/lab_1/test1.txt</div><div class="line">Waiting for /user/hadoop/example/lab_1/test1.txt ... done</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">Found 10 items</div><div class="line">-rw-r--r--   1 hadoop supergroup          0 2018-01-02 17:45 /user/hadoop/example/lab_1/test1.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-02 17:38 /user/hadoop/example/lab_1/test10.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup         38 2018-01-02 15:51 /user/hadoop/example/lab_1/test2.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:59 /user/hadoop/example/lab_1/test3.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:07 /user/hadoop/example/lab_1/test4.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:11 /user/hadoop/example/lab_1/test5.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 16:14 /user/hadoop/example/lab_1/test6.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup       1024 2018-01-02 15:40 /user/hadoop/example/lab_1/test7.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        272 2018-01-02 16:31 /user/hadoop/example/lab_1/test8.txt</div><div class="line">-rw-r--r--   2 hadoop supergroup        373 2018-01-02 17:05 /user/hadoop/example/lab_1/test9.tar.gz</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="使用hadoop-fs-rm刪除檔案"><a href="#使用hadoop-fs-rm刪除檔案" class="headerlink" title="使用hadoop fs -rm刪除檔案"></a>使用hadoop fs -rm刪除檔案</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">## hadoop fs -rm指令,只能刪檔案</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rm  /user/hadoop/example/lab_1/*</div><div class="line">Deleted /user/hadoop/example/lab_1/test1.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test10.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test2.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test3.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test4.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test5.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test6.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test7.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test8.txt</div><div class="line">Deleted /user/hadoop/example/lab_1/test9.tar.gz</div><div class="line"></div><div class="line">## &quot;-rm&quot;無法刪目錄,如要刪除目錄需要用&quot;-rmdir or -rm -r&quot;</div><div class="line">hadoop fs -rm  /user/hadoop/example</div><div class="line">rm: `/user/hadoop/example&apos;: Is a directory</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rmdir  /user/hadoop/example</div><div class="line">rmdir: `/user/hadoop/example&apos;: Directory is not empty</div><div class="line"></div><div class="line">## &quot;-rmdir&quot;只能刪除空目錄</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rmdir /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example/lab_1</div><div class="line">ls: `/user/hadoop/example/lab_1&apos;: No such file or directory</div><div class="line"></div><div class="line">## &quot;-rm -r&quot;,可以刪除所有檔案</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -mkdir /user/hadoop/example/lab_1</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -touchz /user/hadoop/example/lab_1/test1.txt</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rmdir /user/hadoop/example/lab_1</div><div class="line">rmdir: `/user/hadoop/example/lab_1&apos;: Directory is not empty</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rm /user/hadoop/example/lab_1</div><div class="line">rm: `/user/hadoop/example/lab_1&apos;: Is a directory</div><div class="line"></div><div class="line">## &quot;-rm -r&quot;,會將刪除的檔案或目錄先丟到垃圾桶</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rm -r /user/hadoop/example/lab_1</div><div class="line">2018-01-03 11:38:37,066 INFO fs.TrashPolicyDefault: </div><div class="line">Moved: &apos;hdfs://hadoop-master:8020/user/hadoop/example/lab_1&apos; to trash </div><div class="line">at: hdfs://hadoop-master:8020/user/hadoop/.Trash/Current/user/hadoop/example/lab_1</div><div class="line"></div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls /user/hadoop/example</div><div class="line">Found 1 items</div><div class="line">-rwx------   2 hadoop supergroup         36 2018-01-02 18:29 /user/hadoop/example/test.txt</div><div class="line"></div><div class="line">##檢查垃圾桶</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -ls -R /user/hadoop/.Trash</div><div class="line">drwx------   - hadoop supergroup          0 2018-01-03 11:38 /user/hadoop/.Trash/Current</div><div class="line">drwx------   - hadoop supergroup          0 2018-01-03 11:38 /user/hadoop/.Trash/Current/user</div><div class="line">drwx------   - hadoop supergroup          0 2018-01-03 11:38 /user/hadoop/.Trash/Current/user/hadoop</div><div class="line">drwx------   - hadoop supergroup          0 2018-01-03 11:38 /user/hadoop/.Trash/Current/user/hadoop/example</div><div class="line">drwxr-xr-x   - hadoop supergroup          0 2018-01-03 11:37 /user/hadoop/.Trash/Current/user/hadoop/example/lab_1</div><div class="line">-rw-r--r--   2 hadoop supergroup          0 2018-01-03 11:37 /user/hadoop/.Trash/Current/user/hadoop/example/lab_1/test1.txt</div><div class="line"></div><div class="line">## &quot;-rm -r -skipTrash&quot;,會直接刪除目錄或檔案,並且不會進垃圾桶</div><div class="line">hadoop@hadoop-master:~$ hadoop fs -rm -r -skipTrash /user/hadoop/example/lab_1</div><div class="line">Deleted /user/hadoop/example/lab_1</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;建立與刪除目錄&quot;&gt;&lt;a href=&quot;#建立與刪除目錄&quot; class=&quot;headerlink&quot; title=&quot;建立與刪除目錄&quot;&gt;&lt;/a&gt;建立與刪除目錄&lt;/h4&gt;&lt;blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>Spark2.2.1環境安裝說明</title>
    <link href="http://yoursite.com/2017/12/29/%5Bspark2.2%5Dspark2.2.1_Install/"/>
    <id>http://yoursite.com/2017/12/29/[spark2.2]spark2.2.1_Install/</id>
    <published>2017-12-28T16:00:00.000Z</published>
    <updated>2018-01-02T06:40:23.190Z</updated>
    
    <content type="html"><![CDATA[<h3 id="相關環境說明"><a href="#相關環境說明" class="headerlink" title="相關環境說明"></a>相關環境說明</h3><blockquote>
<table>
<thead>
<tr>
<th>IP Address</th>
<th>HostName</th>
<th>角色</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.51.4</td>
<td>hadoop-master</td>
<td>NameNode(NN),SecondaryNameNode, HiveServer2</td>
</tr>
<tr>
<td>192.168.51.5</td>
<td>hadoop-slave1</td>
<td>DataNode(DN1)</td>
</tr>
<tr>
<td>192.168.51.6</td>
<td>hadoop-slave2</td>
<td>DataNode(DN2)</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="環境準備"><a href="#環境準備" class="headerlink" title="環境準備"></a>環境準備</h3><h4 id="Install-Linux-OS-略"><a href="#Install-Linux-OS-略" class="headerlink" title="Install Linux OS(略)"></a>Install Linux OS(略)</h4><h4 id="Install-Linux-JDK8-略"><a href="#Install-Linux-JDK8-略" class="headerlink" title="Install Linux JDK8(略)"></a>Install Linux JDK8(略)</h4><h4 id="Install-Linux-Hadoop3-0-0-略"><a href="#Install-Linux-Hadoop3-0-0-略" class="headerlink" title="Install Linux Hadoop3.0.0(略)"></a>Install Linux Hadoop3.0.0(略)</h4><h4 id="Install-MariaDB-略"><a href="#Install-MariaDB-略" class="headerlink" title="Install MariaDB(略)"></a>Install MariaDB(略)</h4><h4 id="Install-Hive2-3-略"><a href="#Install-Hive2-3-略" class="headerlink" title="Install Hive2.3(略)"></a>Install Hive2.3(略)</h4><h3 id="Download-Spark2-2-1-tagz-file"><a href="#Download-Spark2-2-1-tagz-file" class="headerlink" title="Download Spark2.2.1 tagz file"></a>Download Spark2.2.1 tagz file</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget -P /bgdt http://apache.stu.edu.tw/spark/spark-2.2.1/spark-2.2.1-bin-hadoop2.7.tgz</div><div class="line">wget -P /bgdt http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.39/mysql-connector-java-5.1.39.jar</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="解壓縮下載的spark-2-2-1-bin-hadoop2-7-tgz-file-並更改目錄名稱-過長"><a href="#解壓縮下載的spark-2-2-1-bin-hadoop2-7-tgz-file-並更改目錄名稱-過長" class="headerlink" title="解壓縮下載的spark-2.2.1-bin-hadoop2.7.tgz file,並更改目錄名稱(過長)"></a>解壓縮下載的spark-2.2.1-bin-hadoop2.7.tgz file,並更改目錄名稱(過長)</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tar -zxvf /bgdt/spark-2.2.1-bin-hadoop2.7.tgz -C /bgdt</div><div class="line">mv /bgdt/spark-2.2.1-bin-hadoop2.7 /bgdt/spark-2.2.1</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="加入SPARK-HOME相關的環境變數"><a href="#加入SPARK-HOME相關的環境變數" class="headerlink" title="加入SPARK_HOME相關的環境變數"></a>加入SPARK_HOME相關的環境變數</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">vi ~/.bashrc</div><div class="line"></div><div class="line">##Spark Segement</div><div class="line">export SPARK_HOME=/bgdt/spark-2.2.1</div><div class="line">export PATH=$PATH:$SPARK_HOME/sbin:$SPARK_HOME/bin</div><div class="line"></div><div class="line">source ~/.bashrc</div><div class="line"></div><div class="line">cp /bgdt/mysql-connector-java-5.1.39.jar /bgdt/spark-2.2.1/jars</div><div class="line">ln -s /bgdt/hive-2.3.2/conf/hive-site.xml /bgdt/spark-2.2.1/conf/hive-site.xml</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="執行-spark-shell-for-python"><a href="#執行-spark-shell-for-python" class="headerlink" title="執行 spark shell(for python)"></a>執行 spark shell(for python)</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ pyspark</div><div class="line">Python 2.7.13 (default, Jan 19 2017, 14:48:08)</div><div class="line">[GCC 6.3.0 20170118] on linux2</div><div class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</div><div class="line">Setting default log level to &quot;WARN&quot;.</div><div class="line">To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).</div><div class="line">2017-12-29 11:34:53,515 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</div><div class="line">2017-12-29 11:35:06,762 WARN metastore.ObjectStore: Failed to get database global_temp, returning NoSuchObjectException</div><div class="line">Welcome to</div><div class="line">      ____              __</div><div class="line">     / __/__  ___ _____/ /__</div><div class="line">    _\ \/ _ \/ _ `/ __/  &apos;_/</div><div class="line">   /__ / .__/\_,_/_/ /_/\_\   version 2.2.1</div><div class="line">      /_/</div><div class="line"></div><div class="line">Using Python version 2.7.13 (default, Jan 19 2017 14:48:08)</div><div class="line">SparkSession available as &apos;spark&apos;.</div><div class="line">&gt;&gt;&gt; spark</div><div class="line">&lt;pyspark.sql.session.SparkSession object at 0x7f62b8e37610&gt;</div><div class="line">&gt;&gt;&gt; sc</div><div class="line">&lt;SparkContext master=local[*] appName=PySparkShell&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="執行-spark-shell-for-scala"><a href="#執行-spark-shell-for-scala" class="headerlink" title="執行 spark shell(for scala)"></a>執行 spark shell(for scala)</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ spark-shell</div><div class="line">Setting default log level to &quot;WARN&quot;.</div><div class="line">To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).</div><div class="line">2017-12-29 11:44:58,352 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</div><div class="line">Spark context Web UI available at http://192.168.51.4:4040</div><div class="line">Spark context available as &apos;sc&apos; (master = local[*], app id = local-1514519099800).</div><div class="line">Spark session available as &apos;spark&apos;.</div><div class="line">Welcome to</div><div class="line">      ____              __</div><div class="line">     / __/__  ___ _____/ /__</div><div class="line">    _\ \/ _ \/ _ `/ __/  &apos;_/</div><div class="line">   /___/ .__/\_,_/_/ /_/\_\   version 2.2.1</div><div class="line">      /_/</div><div class="line"></div><div class="line">Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_101)</div><div class="line">Type in expressions to have them evaluated.</div><div class="line">Type :help for more information.</div><div class="line"></div><div class="line">scala&gt; spark</div><div class="line">res0: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7afb9c93</div><div class="line"></div><div class="line">scala&gt; sc</div><div class="line">res1: org.apache.spark.SparkContext = org.apache.spark.SparkContext@14292d71</div><div class="line"></div><div class="line">scala&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="執行spark-sql-Shell"><a href="#執行spark-sql-Shell" class="headerlink" title="執行spark-sql Shell"></a>執行spark-sql Shell</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">hadoop@hadoop-master:~$ spark-sql</div><div class="line">2017-12-29 18:04:01,165 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</div><div class="line">2017-12-29 18:04:01,307 INFO metastore.HiveMetaStore: 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore</div><div class="line">2017-12-29 18:04:01,344 INFO metastore.ObjectStore: ObjectStore, initialize called</div><div class="line">2017-12-29 18:04:01,642 INFO DataNucleus.Persistence: Property hive.metastore.integral.jdo.pushdown unknown - will be ignored</div><div class="line">2017-12-29 18:04:01,642 INFO DataNucleus.Persistence: Property datanucleus.cache.level2 unknown - will be ignored</div><div class="line">2017-12-29 18:04:05,450 INFO metastore.ObjectStore: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes=&quot;Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order&quot;</div><div class="line">2017-12-29 18:04:07,495 INFO DataNucleus.Datastore: The class &quot;org.apache.hadoop.hive.metastore.model.MFieldSchema&quot; is tagged as &quot;embedded-only&quot; so does not have its own datastore table.</div><div class="line">2017-12-29 18:04:07,497 INFO DataNucleus.Datastore: The class &quot;org.apache.hadoop.hive.metastore.model.MOrder&quot; is tagged as &quot;embedded-only&quot; so does not have its own datastore table.</div><div class="line">......</div><div class="line">......</div><div class="line">......</div><div class="line">2017-12-29 18:04:20,967 INFO metastore.HiveMetaStore: 0: get_database: global_temp</div><div class="line">2017-12-29 18:04:20,967 INFO HiveMetaStore.audit: ugi=hadoop    ip=unknown-ip-addr      cmd=get_database: global_temp</div><div class="line">2017-12-29 18:04:20,970 WARN metastore.ObjectStore: Failed to get database global_temp, returning NoSuchObjectException</div><div class="line">2017-12-29 18:04:21,293 INFO session.SessionState: Created local directory: /tmp/d8b65bb8-f4f6-43f2-b544-39331b237673_resources</div><div class="line">2017-12-29 18:04:21,298 INFO session.SessionState: Created HDFS directory: /tmp/hive/hadoop/d8b65bb8-f4f6-43f2-b544-39331b237673</div><div class="line">2017-12-29 18:04:21,306 INFO session.SessionState: Created local directory: /tmp/hadoop/d8b65bb8-f4f6-43f2-b544-39331b237673</div><div class="line">2017-12-29 18:04:21,310 INFO session.SessionState: Created HDFS directory: /tmp/hive/hadoop/d8b65bb8-f4f6-43f2-b544-39331b237673/_tmp_space.db</div><div class="line">2017-12-29 18:04:21,311 INFO client.HiveClientImpl: Warehouse location for Hive client (version 1.2.1) is /user/hive/warehouse</div><div class="line">2017-12-29 18:04:21,406 INFO state.StateStoreCoordinatorRef: Registered StateStoreCoordinator endpoint</div><div class="line"></div><div class="line">spark-sql&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Spark2-2-1-amp-Hive2-3-2整合測試"><a href="#Spark2-2-1-amp-Hive2-3-2整合測試" class="headerlink" title="Spark2.2.1 &amp; Hive2.3.2整合測試"></a>Spark2.2.1 &amp; Hive2.3.2整合測試</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">###開啟第1個putty連線</div><div class="line">hadoop@hadoop-master:~$spark-sql</div><div class="line">spark-sql&gt;create database test1;</div><div class="line">..... INFO execution.SparkSqlParser: Parsing command: create database test1</div><div class="line">..... INFO metastore.HiveMetaStore: 0: create_database: Database(name:test1, description:, locationUri:hdfs://hadoop-master:8020/user/hive/warehouse/test1.db, parameters:&#123;&#125;)</div><div class="line">..... INFO HiveMetaStore.audit: ugi=hadoop    ip=unknown-ip-addr      cmd=create_database: Database(name:test1, description:, locationUri:hdfs://hadoop-master:8020/user/hive/warehouse/test1.db, parameters:&#123;&#125;)</div><div class="line">..... WARN metastore.ObjectStore: Failed to get database test1, returning NoSuchObjectException</div><div class="line">..... INFO common.FileUtils: Creating directory if it doesn&apos;t exist: hdfs://hadoop-master:8020/user/hive/warehouse/test1.db</div><div class="line">Time taken: 0.326 seconds</div><div class="line">..... INFO CliDriver: Time taken: 0.326 seconds</div><div class="line"></div><div class="line">spark-sql&gt;show databases;</div><div class="line">INFO execution.SparkSqlParser: Parsing command: show databases</div><div class="line">INFO metastore.HiveMetaStore: 0: get_databases: *</div><div class="line">HiveMetaStore.audit: ugi=hadoop    ip=unknown-ip-addr      cmd=get_databases: *</div><div class="line">INFO codegen.CodeGenerator: Code generated in 544.163987 ms</div><div class="line">default</div><div class="line">test1</div><div class="line"></div><div class="line">###開啟第2個putty連線</div><div class="line">hadoop@hadoop-master:~$hive</div><div class="line">hive&gt;show databases;</div><div class="line">OK</div><div class="line">default</div><div class="line">test1</div><div class="line">......</div><div class="line"></div><div class="line">hive&gt;create database test2;</div><div class="line">OK</div><div class="line">Time taken: 0.341 seconds</div><div class="line"></div><div class="line">hive&gt;show databases;</div><div class="line">OK</div><div class="line">default</div><div class="line">test1</div><div class="line">test2</div><div class="line">......</div><div class="line"></div><div class="line">spark-sql&gt;show databases;</div><div class="line">default</div><div class="line">test1</div><div class="line">test2</div><div class="line"></div><div class="line">###以上驗證由兩種不同方式所建立的資料庫是可以同步的</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;相關環境說明&quot;&gt;&lt;a href=&quot;#相關環境說明&quot; class=&quot;headerlink&quot; title=&quot;相關環境說明&quot;&gt;&lt;/a&gt;相關環境說明&lt;/h3&gt;&lt;blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP Address&lt;/th&gt;
&lt;th
    
    </summary>
    
      <category term="spark" scheme="http://yoursite.com/categories/spark/"/>
    
    
  </entry>
  
  <entry>
    <title>Hive2.3+Hadooop3.0.0環境安裝說明</title>
    <link href="http://yoursite.com/2017/12/28/%5Bhive%5DHive2.3_for_Hadoop3_Install/"/>
    <id>http://yoursite.com/2017/12/28/[hive]Hive2.3_for_Hadoop3_Install/</id>
    <published>2017-12-27T16:00:00.000Z</published>
    <updated>2017-12-29T09:50:56.906Z</updated>
    
    <content type="html"><![CDATA[<h3 id="相關環境說明"><a href="#相關環境說明" class="headerlink" title="相關環境說明"></a>相關環境說明</h3><blockquote>
<table>
<thead>
<tr>
<th>IP Address</th>
<th>HostName</th>
<th>角色</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.51.4</td>
<td>hadoop-master</td>
<td>NameNode(NN),SecondaryNameNode, HiveServer2</td>
</tr>
<tr>
<td>192.168.51.5</td>
<td>hadoop-slave1</td>
<td>DataNode(DN1)</td>
</tr>
<tr>
<td>192.168.51.6</td>
<td>hadoop-slave2</td>
<td>DataNode(DN2)</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="環境準備"><a href="#環境準備" class="headerlink" title="環境準備"></a>環境準備</h3><h4 id="Install-Linux-OS-略"><a href="#Install-Linux-OS-略" class="headerlink" title="Install Linux OS(略)"></a>Install Linux OS(略)</h4><h4 id="Install-Linux-JDK8-略"><a href="#Install-Linux-JDK8-略" class="headerlink" title="Install Linux JDK8(略)"></a>Install Linux JDK8(略)</h4><h4 id="Install-Linux-Hadoop3-0-0-略"><a href="#Install-Linux-Hadoop3-0-0-略" class="headerlink" title="Install Linux Hadoop3.0.0(略)"></a>Install Linux Hadoop3.0.0(略)</h4><h4 id="Install-MariaDB-略"><a href="#Install-MariaDB-略" class="headerlink" title="Install MariaDB(略)"></a>Install MariaDB(略)</h4><h3 id="Hive2-3-Install-File-Download"><a href="#Hive2-3-Install-File-Download" class="headerlink" title="Hive2.3 Install File Download"></a>Hive2.3 Install File Download</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget -P /bgdt https://archive.apache.org/dist/hive/hive-2.3.2/apache-hive-2.3.2-bin.tar.gz </div><div class="line">wget -P /bgdt http://central.maven.org/maven2/mysql/mysql-connector-java/5.1.39/mysql-connector-java-5.1.39.jar</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="解壓縮"><a href="#解壓縮" class="headerlink" title="解壓縮"></a>解壓縮</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -zxvf /bgdt/apache-hive-2.3.2-bin.tar.gz -C /bgdt</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="使用Mariadb建立Hive2-3所使用的MetaStore-DataBase"><a href="#使用Mariadb建立Hive2-3所使用的MetaStore-DataBase" class="headerlink" title="使用Mariadb建立Hive2.3所使用的MetaStore DataBase"></a>使用Mariadb建立Hive2.3所使用的MetaStore DataBase</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">step1:</div><div class="line">sudo -S /usr/local/mysql/bin/mysqld --user=root &amp;	##啟動mariadb</div><div class="line">hadoop@hadoop-master:~$ netstat -tnl | grep &quot;3306&quot;</div><div class="line">tcp6       0      0 :::3306                 :::*                    LISTEN</div><div class="line"></div><div class="line">step2:</div><div class="line">/usr/local/mysql/bin/mysql -u root --password=\!QAZxsw2	##進入Mariadb CLI</div><div class="line">MariaDB [(none)]&gt;</div><div class="line"></div><div class="line">step3:</div><div class="line">MariaDB [(none)]&gt;grant all privileges on *.* to &apos;root&apos;@&apos;hadoop-master&apos; identified by &apos;!QAZxsw2&apos; with grant option;</div><div class="line"></div><div class="line">step4:</div><div class="line">MariaDB [(none)]&gt; create database metastore3_db;	##這邊建立的database就是之後ConnectionURL中,使用的DB名稱</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="在HDFS中建立hive儲存目錄"><a href="#在HDFS中建立hive儲存目錄" class="headerlink" title="在HDFS中建立hive儲存目錄"></a>在HDFS中建立hive儲存目錄</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop fs -mkdir -p /user/hive/warehouse</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="使用SchemaTool建立Hive2-3-Meta-Data-Table-Schema"><a href="#使用SchemaTool建立Hive2-3-Meta-Data-Table-Schema" class="headerlink" title="使用SchemaTool建立Hive2.3 Meta Data Table Schema"></a>使用SchemaTool建立Hive2.3 Meta Data Table Schema</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">schematool -dbType mysql -initSchema				##此語法會重新建立新的Table,如果需要upgrade就不行用這個語法</div><div class="line">schematool -dbType mysql -upgradeSchemaFrom 0.7.0 -dryRun	##更新新的schema,但不會影響到既有的Table</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="相關配置檔設定"><a href="#相關配置檔設定" class="headerlink" title="相關配置檔設定"></a>相關配置檔設定</h3><blockquote>
<p>hive-site.xml檔案設定內容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">    &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</div><div class="line">    &lt;value&gt;/user/hive/warehouse&lt;/value&gt;</div><div class="line">    &lt;description&gt;location of default database for the warehouse&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</div><div class="line">	&lt;value&gt;jdbc:mysql://hadoop-master:3306/metastore3_db&lt;/value&gt;</div><div class="line">	&lt;description&gt;JDBC connect string for a JDBC metastore &lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</div><div class="line">	&lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</div><div class="line">	&lt;description&gt;Driver class name for a JDBC metastore&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</div><div class="line">	&lt;value&gt;root&lt;/value&gt;</div><div class="line">	&lt;description&gt;username to use against metastore database&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</div><div class="line">	&lt;value&gt;!QAZxsw2&lt;/value&gt;</div><div class="line">	&lt;description&gt;password to use against metastore database&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">   &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;  </div><div class="line">   &lt;value&gt;false&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="修改-bashrc"><a href="#修改-bashrc" class="headerlink" title="修改~/.bashrc"></a>修改~/.bashrc</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">vi ~/.bashrc</div><div class="line"></div><div class="line">##Hive Segement</div><div class="line">export HIVE_HOME=/bgdt/hive-2.3.2</div><div class="line">export PATH=$PATH:$HIVE_HOME/bin</div><div class="line"></div><div class="line"></div><div class="line">source ~/.bashrc</div><div class="line"></div><div class="line">cp /bgdt/mysql-connector-java-5.1.39.jar /bgdt/hive-2.3.2/lib</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="啟動Hive"><a href="#啟動Hive" class="headerlink" title="啟動Hive"></a>啟動Hive</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hive	##進入Hive CLI</div><div class="line">nohup /bgdt/hive-2.3.2/bin/hive --service hiveserver2 &amp;		##啟動Hive2.3 for JDBC Service</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;相關環境說明&quot;&gt;&lt;a href=&quot;#相關環境說明&quot; class=&quot;headerlink&quot; title=&quot;相關環境說明&quot;&gt;&lt;/a&gt;相關環境說明&lt;/h3&gt;&lt;blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP Address&lt;/th&gt;
&lt;th
    
    </summary>
    
      <category term="hive" scheme="http://yoursite.com/categories/hive/"/>
    
    
  </entry>
  
  <entry>
    <title>Hadoop3.0.0 Cluster環境安裝說明</title>
    <link href="http://yoursite.com/2017/12/27/%5Bhadoop%5Dhadoop_3_install/"/>
    <id>http://yoursite.com/2017/12/27/[hadoop]hadoop_3_install/</id>
    <published>2017-12-26T16:00:00.000Z</published>
    <updated>2017-12-27T10:44:12.148Z</updated>
    
    <content type="html"><![CDATA[<h3 id="相關環境說明"><a href="#相關環境說明" class="headerlink" title="相關環境說明"></a>相關環境說明</h3><blockquote>
<table>
<thead>
<tr>
<th>IP Address</th>
<th>HostName</th>
<th>角色</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.51.4</td>
<td>hadoop-master</td>
<td>NameNode(NN),SecondaryNameNode</td>
</tr>
<tr>
<td>192.168.51.5</td>
<td>hadoop-slave1</td>
<td>DataNode(DN1)</td>
</tr>
<tr>
<td>192.168.51.6</td>
<td>hadoop-slave2</td>
<td>DataNode(DN2)</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="環境準備"><a href="#環境準備" class="headerlink" title="環境準備"></a>環境準備</h3><h4 id="Install-Linux-OS-略"><a href="#Install-Linux-OS-略" class="headerlink" title="Install Linux OS(略)"></a>Install Linux OS(略)</h4><h4 id="Install-JDK8-略"><a href="#Install-JDK8-略" class="headerlink" title="Install JDK8(略)"></a>Install JDK8(略)</h4><h3 id="下載hadoop-3-0-0-tar-gz"><a href="#下載hadoop-3-0-0-tar-gz" class="headerlink" title="下載hadoop-3.0.0.tar.gz"></a>下載hadoop-3.0.0.tar.gz</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -P /bgdt http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-3.0.0/hadoop-3.0.0.tar.gz</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="檔案解壓縮"><a href="#檔案解壓縮" class="headerlink" title="檔案解壓縮"></a>檔案解壓縮</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">tar -zxvf /bgdt/hadoop-3.0.0.tar.gz -C /bgdt</div><div class="line">---</div><div class="line">解完壓縮檔之後進入hadoop-3.0.0目錄查看目錄結構</div><div class="line">[hadoop@hadoop-master:~$]ls -la /bgdt/hadoop-3.0.0</div><div class="line">total 220</div><div class="line">drwxr-xr-x 12 hadoop hadoop   4096 Dec 26 15:23 .</div><div class="line">drwxr-xr-x 10 hadoop hadoop   4096 Dec 27 16:54 ..</div><div class="line">drwxr-xr-x  2 hadoop hadoop   4096 Dec  9 03:42 bin</div><div class="line">drwxr-xr-x  3 hadoop hadoop   4096 Dec  9 03:17 etc</div><div class="line">drwxr-xr-x  2 hadoop hadoop   4096 Dec  9 03:42 include</div><div class="line">drwxr-xr-x  3 hadoop hadoop   4096 Dec  9 03:42 lib</div><div class="line">drwxr-xr-x  4 hadoop hadoop   4096 Dec  9 03:42 libexec</div><div class="line">-rw-r--r--  1 hadoop hadoop 147066 Nov 15 03:19 LICENSE.txt</div><div class="line">drwxrwxr-x  3 hadoop hadoop   4096 Dec 27 10:58 logs</div><div class="line">-rw-r--r--  1 hadoop hadoop  20891 Nov 15 03:19 NOTICE.txt</div><div class="line">-rw-r--r--  1 hadoop hadoop   1366 Jul  9  2016 README.txt</div><div class="line">drwxr-xr-x  3 hadoop hadoop   4096 Dec  9 03:17 sbin</div><div class="line">drwxr-xr-x  4 hadoop hadoop   4096 Dec  9 03:53 share</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="設定檔編輯"><a href="#設定檔編輯" class="headerlink" title="設定檔編輯"></a>設定檔編輯</h3><h4 id="修改-bashrc"><a href="#修改-bashrc" class="headerlink" title="修改~/.bashrc"></a>修改~/.bashrc</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">vi ~/.bashrc</div><div class="line">export JAVA_HOME=/bgdt/java/jdk1.8.0_101</div><div class="line">export HADOOP_HOME=/bgdt/hadoop-3.0.0</div><div class="line">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</div><div class="line">export PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin	</div><div class="line">---</div><div class="line">修改完成後:wq存檔</div><div class="line"></div><div class="line">[hadoop@hadoop-master:~$]source ~/.bashrc</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;fs.defaultFS&lt;/name&gt;</div><div class="line">	&lt;value&gt;hdfs://hadoop-master:8020&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</div><div class="line">	&lt;value&gt;file:/bgdt/hadoop-3.0.0/tmp&lt;/value&gt;</div><div class="line">	&lt;description&gt;Abase for other temporary directories.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;hadoop.proxyuser.hadoop.hosts&lt;/name&gt;</div><div class="line">	&lt;value&gt;*&lt;/value&gt;    </div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;hadoop.proxyuser.hadoop.groups&lt;/name&gt;</div><div class="line">	&lt;value&gt;*&lt;/value&gt;    </div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</div><div class="line">	&lt;value&gt;hadoop-master:50090&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.replication&lt;/name&gt;</div><div class="line">	&lt;value&gt;3&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</div><div class="line">	&lt;value&gt;file:/bgdt/hadoop-3.0.0/tmp/dfs/name&lt;/value&gt;</div><div class="line">&lt;/property&gt; </div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</div><div class="line">	&lt;value&gt;file:/bgdt/hadoop-3.0.0/tmp/dfs/data&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.block.size&lt;/name&gt;</div><div class="line">	&lt;value&gt;64M&lt;/value&gt;   </div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="maperd-site-xml"><a href="#maperd-site-xml" class="headerlink" title="maperd-site.xml"></a>maperd-site.xml</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</div><div class="line">&lt;configuration&gt;   </div><div class="line">&lt;property&gt;  </div><div class="line">	&lt;name&gt;mapreduce.framework.name&lt;/name&gt;  </div><div class="line">	&lt;value&gt;yarn&lt;/value&gt;  </div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</div><div class="line">	&lt;value&gt;mna1:10020&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</div><div class="line">	&lt;value&gt;mna1:19888&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;  </div><div class="line">	&lt;name&gt;mapreduce.application.classpath&lt;/name&gt;  </div><div class="line">	&lt;value&gt;  </div><div class="line">		$HADOOP_HOME/share/hadoop/common/*,</div><div class="line">		$HADOOP_HOME/share/hadoop/hdfs/*,  </div><div class="line">		$HADOOP_HOME/share/hadoop/mapreduce/*,  </div><div class="line">		$HADOOP_HOME/share/hadoop/yarn/*</div><div class="line">	&lt;/value&gt;</div><div class="line">&lt;/property&gt;  </div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</div><div class="line">&lt;configuration&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</div><div class="line">	&lt;value&gt;hadoop-master&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</div><div class="line">	&lt;value&gt;mapreduce_shuffle&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;yarn.log.server.url&lt;/name&gt;</div><div class="line">	&lt;value&gt;http://hadoop-master:19888/jobhistory/logs&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;/configuration&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="worker"><a href="#worker" class="headerlink" title="worker"></a>worker</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop-slave1</div><div class="line">hadoop-slave2</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="壓縮檔案後scp至DataNode"><a href="#壓縮檔案後scp至DataNode" class="headerlink" title="壓縮檔案後scp至DataNode"></a>壓縮檔案後scp至DataNode</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">將NameNode hadoop目錄壓縮後copy至其他DataNode,進行解壓縮</div><div class="line">---</div><div class="line">[hadoop@hadoop-master:~$]cd /bgdt</div><div class="line">[hadoop@hadoop-master:~$]tar -zcvf ~/hadoop-3.0.0.tar.gz hadoop-3.0.0</div><div class="line">[hadoop@hadoop-master:~$]scp ~/hadoop-3.0.0.tar.gz hadoop-slave1:/bgdt</div><div class="line">[hadoop@hadoop-master:~$]scp ~/hadoop-3.0.0.tar.gz hadoop-slave2:/bgdt</div><div class="line">---</div><div class="line">ssh至DataNode並將hadoop-3.0.0.tar.gz解壓縮</div><div class="line">ssh hadoop-slave1</div><div class="line">[hadoop@hadoop-slave1:~$]tar -zxvf /bgdt/hadoop-3.0.0.tar.gz -C /bgdt</div><div class="line">ssh hadoop-slave2</div><div class="line">[hadoop@hadoop-slave2:~$]tar -zxvf /bgdt/hadoop-3.0.0.tar.gz -C /bgdt</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="HDFS格式化"><a href="#HDFS格式化" class="headerlink" title="HDFS格式化"></a>HDFS格式化</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop namenode -format</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Hadoop-3-0-0-Port-Number-List"><a href="#Hadoop-3-0-0-Port-Number-List" class="headerlink" title="Hadoop 3.0.0 Port Number List"></a>Hadoop 3.0.0 Port Number List</h3><blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">Service Name</th>
<th style="text-align:left">Hadoop 2.X Port Number</th>
<th style="text-align:left">Hadoop 3.X Port Number</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Hadoop HDFS NameNode</td>
<td style="text-align:left">8020</td>
<td style="text-align:left">9820</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS NameNode HTTP UI</td>
<td style="text-align:left">50070</td>
<td style="text-align:left">9870</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS NameNode HTTPS UI</td>
<td style="text-align:left">50470</td>
<td style="text-align:left">9840</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS SecondaryNameNode HTTP UI</td>
<td style="text-align:left">50091</td>
<td style="text-align:left">9869</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS SecondaryNameNode HTTPS UI</td>
<td style="text-align:left">50090</td>
<td style="text-align:left">9868</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS</td>
<td style="text-align:left">8020</td>
<td style="text-align:left">9820</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS DataNode IPC Port</td>
<td style="text-align:left">50020</td>
<td style="text-align:left">9867</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS DataNode</td>
<td style="text-align:left">50010</td>
<td style="text-align:left">9866</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS DataNode HTTP UI</td>
<td style="text-align:left">50075</td>
<td style="text-align:left">9864</td>
</tr>
<tr>
<td style="text-align:left">Hadoop HDFS DataNode HTTPS UI</td>
<td style="text-align:left">50475</td>
<td style="text-align:left">9865</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="Hadoop服務啟動命令"><a href="#Hadoop服務啟動命令" class="headerlink" title="Hadoop服務啟動命令"></a>Hadoop服務啟動命令</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">啟動方式1:使用start-*.sh</div><div class="line">-----</div><div class="line">[hadoop@hadoop-master:~$]start-dfs.sh</div><div class="line">[hadoop@hadoop-master:~$]start-yarn.sh</div><div class="line">[hadoop@hadoop-master:~$]jps</div><div class="line">2340 ResourceManager</div><div class="line">1834 NameNode</div><div class="line">2107 SecondaryNameNode</div><div class="line">[hadoop@hadoop-master:~$]ssh hadoop-slave1</div><div class="line">[hadoop@hadoop-slave1:~$]jps</div><div class="line">1568 DataNode</div><div class="line">1738 NodeManager</div><div class="line">[hadoop@hadoop-master:~$]ssh hadoop-slave2</div><div class="line">[hadoop@hadoop-slave2:~$]jps</div><div class="line">1715 NodeManager</div><div class="line">1545 DataNode</div><div class="line"></div><div class="line">啟動方式2:</div><div class="line">-----</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon start namenode</div><div class="line">[hadoop@hadoop-master:~$]yarn --daemon start resourcemanager</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon start proxyserver</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon start httpfs</div><div class="line">[hadoop@hadoop-master:~$]mapred --daemon start historyserver</div><div class="line">-</div><div class="line">[hadoop@hadoop-slave1:~$]hdfs --daemon start datanode</div><div class="line">[hadoop@hadoop-slave1:~$]yarn --daemon start nodemanager</div><div class="line">-</div><div class="line">[hadoop@hadoop-slave2:~$]hdfs --daemon start datanode</div><div class="line">[hadoop@hadoop-slave2:~$]yarn --daemon start nodemanager</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Hadoop服務關閉"><a href="#Hadoop服務關閉" class="headerlink" title="Hadoop服務關閉"></a>Hadoop服務關閉</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">停止方式1:使用stop-*.sh</div><div class="line">-----</div><div class="line">[hadoop@hadoop-master:~$]stop-dfs.sh</div><div class="line">[hadoop@hadoop-master:~$]stop-yarn.sh</div><div class="line"></div><div class="line">停止方式2:</div><div class="line">-----</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon stop namenode</div><div class="line">[hadoop@hadoop-master:~$]yarn --daemon stop resourcemanager</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon stop proxyserver</div><div class="line">[hadoop@hadoop-master:~$]hdfs --daemon stop httpfs</div><div class="line">[hadoop@hadoop-master:~$]mapred --daemon stop historyserver</div><div class="line">-</div><div class="line">[hadoop@hadoop-slave1:~$]hdfs --daemon stop datanode</div><div class="line">[hadoop@hadoop-slave1:~$]yarn --daemon stop nodemanager</div><div class="line">-</div><div class="line">[hadoop@hadoop-slave2:~$]hdfs --daemon stop datanode</div><div class="line">[hadoop@hadoop-slave2:~$]yarn --daemon stop nodemanager</div><div class="line"></div><div class="line">停止DataNode方式3:</div><div class="line">-----</div><div class="line">[hadoop@hadoop-master:~$]hdfs dfsadmin -shutdownDatanode 192.168.51.5:9867</div><div class="line">[hadoop@hadoop-master:~$]hdfs dfsadmin -shutdownDatanode 192.168.51.6:9867</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Hadoop-MapReduce-Example"><a href="#Hadoop-MapReduce-Example" class="headerlink" title="Hadoop MapReduce Example"></a>Hadoop MapReduce Example</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hadoop jar /bgdt/hadoop-3.0.0/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.0.0.jar pi 4 100</div><div class="line">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.0.0.jar grep input output &apos;dfs[a-z.]+&apos;</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Hadoop-Web-UI"><a href="#Hadoop-Web-UI" class="headerlink" title="Hadoop Web UI"></a>Hadoop Web UI</h3><h4 id="web-1"><a href="#web-1" class="headerlink" title="web-1"></a>web-1</h4><blockquote>
<p>Hadoop WebUI-1 Port:9870,此頁面可以觀察Namenode相關資訊<br><img src="/images/hadoop_3_install/hadoop_3_install_1.jpg" alt=""></p>
</blockquote>
<h4 id="web-2"><a href="#web-2" class="headerlink" title="web-2"></a>web-2</h4><blockquote>
<p>Hadoop WebUI-2 此頁面可以觀察DataNode狀態<br><img src="/images/hadoop_3_install/hadoop_3_install_2.jpg" alt=""></p>
</blockquote>
<h4 id="web-3"><a href="#web-3" class="headerlink" title="web-3"></a>web-3</h4><blockquote>
<p>Hadoop WebUI-3 此頁面可以觀察HDFS檔案結構,新版的Browser可以直接由介面上上傳檔案,但先決條件為沒有設定相關權限<br><img src="/images/hadoop_3_install/hadoop_3_install_3.jpg" alt=""></p>
</blockquote>
<h4 id="web-4"><a href="#web-4" class="headerlink" title="web-4"></a>web-4</h4><blockquote>
<p>Hadoop WebUI-4,Port:8088,此頁面為ResourceManager的管理介面,系統會列出所有Application的運行狀態<br><img src="/images/hadoop_3_install/hadoop_3_install_4.jpg" alt=""></p>
</blockquote>
<h4 id="UI-5"><a href="#UI-5" class="headerlink" title="UI-5"></a>UI-5</h4><blockquote>
<p>此圖為Run Hadoop MapReduce時,產生的錯誤訊息(此部分為Hadoop3.0.0的問題,Exception可以暫時略過不管)<br>  <a href="https://issues.apache.org/jira/browse/HDFS-10429" target="_blank" rel="external">HDFS-10429</a> DataStreamer interrupted warning always appears when using CLI upload file<br><img src="/images/hadoop_3_install/hadoop_3_install_5.jpg" alt=""></p>
</blockquote>
<h4 id="UI-6"><a href="#UI-6" class="headerlink" title="UI-6"></a>UI-6</h4><blockquote>
<p>程式Run完後,在此畫面可以觀察Application最後的執行狀態,如果有啟動JobHistory時可以觀察到相關的Log<br><img src="/images/hadoop_3_install/hadoop_3_install_6.jpg" alt=""></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;相關環境說明&quot;&gt;&lt;a href=&quot;#相關環境說明&quot; class=&quot;headerlink&quot; title=&quot;相關環境說明&quot;&gt;&lt;/a&gt;相關環境說明&lt;/h3&gt;&lt;blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP Address&lt;/th&gt;
&lt;th
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>Excel之下拉式選單設計技巧-1</title>
    <link href="http://yoursite.com/2017/12/08/%5Bexcel%5DExcel_skill/"/>
    <id>http://yoursite.com/2017/12/08/[excel]Excel_skill/</id>
    <published>2017-12-07T16:00:00.000Z</published>
    <updated>2018-01-02T06:40:53.736Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Excel操作的小小筆記</p>
</blockquote>
<ol>
<li><p>開啟Excel,之後先建立一個名叫部門代碼表的Sheet<br><img src="/images/excel_skill_1/List.jpg" alt=""></p>
</li>
<li><p>建立完工作表之後,需在”公式”-&gt;”名稱管理員”-&gt;”新增”中定義相關的名稱<br>其中有需要注意以下幾個地方:<br>1.名稱:部門代碼表<br>2.範圍:整個活頁簿<br>3.參照到:需要在要定義的工作表中選出定義的範圍(=部門代碼表!$A:$B)<br>“=部門代碼表!”–&gt;意思是部門代碼表這個工作表(Sheet)<br>“$A:$B”–&gt;表示工作表中的A欄和B欄全部<br>選取的內容是A和B兩個欄位全部,因為我們會想要隨時增加部門進來所以不限定列數<br><img src="/images/excel_skill_1/List_9.jpg" alt=""></p>
</li>
<li><p>我們再新增一個”部門名稱”的定義給名稱管理員,相關欄位同上圖,只是這次我們只選擇A欄<br>這個部份的定義是要給下拉式選單當成選擇的項目<br><img src="/images/excel_skill_1/List_10.jpg" alt=""></p>
</li>
<li><p>最後我們查看名稱管理員會出現兩個名稱定義(部門代碼表,部門名稱)<br><img src="/images/excel_skill_1/List_11.jpg" alt=""></p>
</li>
<li><p>再來我們開啟另一個工作表,隨便選一個cell做為下拉式選單測試<br>接著點選”資料”-&gt;”資料驗證”-&gt;”設定”<br>然後”儲存格內允許”–&gt;清單<br>“來源”–&gt;填入”=部門名稱”<br>“儲存格內的下拉式選單”記得勾選<br><img src="/images/excel_skill_1/List_12.jpg" alt=""></p>
</li>
<li><p>此時點選按鈕就會出現一個下拉式選單<br><img src="/images/excel_skill_1/List_13.jpg" alt=""></p>
</li>
<li><p>最後一個步驟,選擇一個要呈現結果的cell,填入以下公式<br>=VLOOKUP(A1,部門代碼表,2,FALSE)<br>以下說明VLOOKUP(自動查找函數)相關參數<br>查閱欄位：填入欄位編號<br>查閱範圍：定義的範圍名稱<br>欄位編號：取出欄位編號，在定義的範圍名稱欄位代號(由左至右1,2,….)<br>是否完全符合：搜尋時是否要完全符合查詢欄位的值，TRUE-部分符合，FALSE-完全符合。<br><img src="/images/excel_skill_1/List_14.jpg" alt=""></p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Excel操作的小小筆記&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;開啟Excel,之後先建立一個名叫部門代碼表的Sheet&lt;br&gt;&lt;img src=&quot;/images/excel_skill_1/List.jpg&quot; alt=&quot;&quot;&gt;
    
    </summary>
    
      <category term="excel" scheme="http://yoursite.com/categories/excel/"/>
    
    
  </entry>
  
  <entry>
    <title>Hive相關語法整理-3(Partition Table)</title>
    <link href="http://yoursite.com/2017/11/07/%5Bhive%5Dhive_sql_3/"/>
    <id>http://yoursite.com/2017/11/07/[hive]hive_sql_3/</id>
    <published>2017-11-06T16:00:00.000Z</published>
    <updated>2017-11-07T09:55:02.515Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Create-Partition-Table"><a href="#Create-Partition-Table" class="headerlink" title="Create Partition Table"></a>Create Partition Table</h2><blockquote>
<p>CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name<br>  [(col_name data_type [COMMENT col_comment], … [constraint_specification])]<br>  [COMMENT table_comment]<br>  [PARTITIONED BY (col_name data_type [COMMENT col_comment], …)]<br>  [<br>   [ROW FORMAT row_format]<br>   [STORED AS file_format]<br>     | STORED BY ‘storage.handler.class.name’ [WITH SERDEPROPERTIES (…)]<br>  ]<br>  [LOCATION hdfs_path]<br>  [TBLPROPERTIES (property_name=property_value, …)]<br>  [AS select_statement];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">create table page_view_7(</div><div class="line">  viewTime int, </div><div class="line">  userid bigint,</div><div class="line">  page_url string, </div><div class="line">  referrer_url string,</div><div class="line">  ip string)</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="Alter-Partition"><a href="#Alter-Partition" class="headerlink" title="Alter Partition"></a>Alter Partition</h2><h3 id="Add-Partition"><a href="#Add-Partition" class="headerlink" title="Add Partition"></a>Add Partition</h3><blockquote>
<p>ALTER TABLE table_name ADD [IF NOT EXISTS]<br>  PARTITION partition_spec [LOCATION ‘location’][, PARTITION partition_spec [LOCATION ‘location’], …];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">ALTER TABLE page_view_7 ADD PARTITION (dt=&apos;2008-08-08&apos;, country=&apos;us&apos;);</div><div class="line">ALTER TABLE page_view_7 ADD PARTITION (dt=&apos;2017-11-01&apos;, country=&apos;us&apos;) location &quot;/user/hadoop/data/page_view_7/partitions&quot;;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Rename-Partition"><a href="#Rename-Partition" class="headerlink" title="Rename Partition"></a>Rename Partition</h3><blockquote>
<p>ALTER TABLE table_name PARTITION partition_spec RENAME TO PARTITION partition_spec;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">alter table page_view_7 partition (dt=&quot;2017-11-07&quot;,country=&quot;taiwan&quot;) rename to partition (dt=&quot;test_2017-11-07&quot;,country=&quot;taiwan&quot;);</div><div class="line"></div><div class="line">hive&gt; show partitions page_view_7;</div><div class="line">OK</div><div class="line">dt=2008-08-08/country=Taiwan</div><div class="line">dt=2008-08-08/country=us</div><div class="line">dt=2008-08-09/country=us</div><div class="line">dt=2008-08-10/country=us</div><div class="line">dt=2017-08-08/country=taiwan</div><div class="line">dt=2017-08-08/country=us</div><div class="line">dt=2017-11-01/country=us</div><div class="line">dt=test_2017-11-07/country=taiwan</div><div class="line">Time taken: 0.054 seconds, Fetched: 8 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Exchange-Partition"><a href="#Exchange-Partition" class="headerlink" title="Exchange Partition"></a>Exchange Partition</h3><blockquote>
<p>ALTER TABLE table_name_2 EXCHANGE PARTITION (partition_spec) WITH TABLE table_name_1;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">alter table pv_7 exchange partition (dt=&quot;test_2017-11-07&quot;,country=&quot;taiwan&quot;) with table page_view_7;</div><div class="line"></div><div class="line">Demo:</div><div class="line">hive&gt; create table pv_7 like page_view_7;</div><div class="line">OK</div><div class="line">Time taken: 0.59 seconds</div><div class="line">hive&gt; alter table pv_7 exchange partition (dt=&quot;test_2017-11-07&quot;,country=&quot;taiwan&quot;) with table page_view_7;</div><div class="line">OK</div><div class="line">Time taken: 0.297 seconds</div><div class="line">hive&gt; show partitions page_view_7;</div><div class="line">OK</div><div class="line">dt=2008-08-08/country=Taiwan</div><div class="line">dt=2008-08-08/country=us</div><div class="line">dt=2008-08-09/country=us</div><div class="line">dt=2008-08-10/country=us</div><div class="line">dt=2017-08-08/country=taiwan</div><div class="line">dt=2017-08-08/country=us</div><div class="line">dt=2017-11-01/country=us</div><div class="line">Time taken: 0.058 seconds, Fetched: 7 row(s)</div><div class="line">hive&gt; show partitions pv_7;</div><div class="line">OK</div><div class="line">dt=test_2017-11-07/country=taiwan</div><div class="line">Time taken: 0.055 seconds, Fetched: 1 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Drop-Partition"><a href="#Drop-Partition" class="headerlink" title="Drop Partition"></a>Drop Partition</h3><blockquote>
<p>ALTER TABLE table_name DROP [IF EXISTS] PARTITION partition_spec[, PARTITION partition_spec, …]<br>  [IGNORE PROTECTION] [PURGE];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">alter table page_view_7 drop if exists partition (dt=&quot;2017-11-01&quot;,country=&quot;us&quot;);</div><div class="line"></div><div class="line">Demo:</div><div class="line">hive&gt; show partitions page_view_7;</div><div class="line">OK</div><div class="line">dt=2008-08-08/country=Taiwan</div><div class="line">dt=2008-08-08/country=us</div><div class="line">dt=2008-08-09/country=us</div><div class="line">dt=2008-08-10/country=us</div><div class="line">dt=2017-08-08/country=taiwan</div><div class="line">dt=2017-08-08/country=us</div><div class="line">dt=2017-11-01/country=us</div><div class="line">Time taken: 0.054 seconds, Fetched: 7 row(s)</div><div class="line">hive&gt; alter table page_view_7 drop if exists partition (dt=&quot;2017-11-01&quot;,country=&quot;us&quot;);</div><div class="line">Dropped the partition dt=2017-11-01/country=us</div><div class="line">OK</div><div class="line">Time taken: 0.36 seconds</div><div class="line">hive&gt; show partitions page_view_7;</div><div class="line">OK</div><div class="line">dt=2008-08-08/country=Taiwan</div><div class="line">dt=2008-08-08/country=us</div><div class="line">dt=2008-08-09/country=us</div><div class="line">dt=2008-08-10/country=us</div><div class="line">dt=2017-08-08/country=taiwan</div><div class="line">dt=2017-08-08/country=us</div><div class="line">Time taken: 0.052 seconds, Fetched: 6 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="Show-Partition"><a href="#Show-Partition" class="headerlink" title="Show Partition"></a>Show Partition</h3>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Create-Partition-Table&quot;&gt;&lt;a href=&quot;#Create-Partition-Table&quot; class=&quot;headerlink&quot; title=&quot;Create Partition Table&quot;&gt;&lt;/a&gt;Create Partition Tab
    
    </summary>
    
      <category term="hive" scheme="http://yoursite.com/categories/hive/"/>
    
    
  </entry>
  
  <entry>
    <title>Hive相關語法整理-1</title>
    <link href="http://yoursite.com/2017/11/06/%5Bhive%5Dhive_sql_1/"/>
    <id>http://yoursite.com/2017/11/06/[hive]hive_sql_1/</id>
    <published>2017-11-05T16:00:00.000Z</published>
    <updated>2017-11-06T10:12:00.165Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Create-Database"><a href="#Create-Database" class="headerlink" title="Create Database"></a>Create Database</h2><blockquote>
<p>create (database|schema) [if not exists] database_name<br> [comment database_comment]<br> [location hdfs_path]<br> [with dbproperties (property_name=property_value, …)];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">create database test1;</div><div class="line"></div><div class="line">create database if not exists test1;</div><div class="line"></div><div class="line">create database if not exists mydatabase</div><div class="line">with dbproperties(&apos;Experiment Name&apos; = &apos;Correlation age/sentiment&apos;,</div><div class="line">&apos;date&apos; = &apos;2013-07-11&apos;,</div><div class="line">&apos;Lead Developer&apos; = &apos;John Foo&apos;,</div><div class="line">&apos;Lead Developer Email&apos; = &apos;jfoo@somewhere.com&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Alter-Database"><a href="#Alter-Database" class="headerlink" title="Alter Database"></a>Alter Database</h2><blockquote>
<p>ALTER (DATABASE|SCHEMA) database_name SET DBPROPERTIES (property_name=property_value, …);<br>  ALTER (DATABASE|SCHEMA) database_name SET OWNER [USER|ROLE] user_or_role;<br>  ALTER (DATABASE|SCHEMA) database_name SET LOCATION hdfs_path;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line"> alter database mydatabase set dbproperties(&quot;date&quot;=&quot;2017-11-06&quot;);</div><div class="line"> alter database mydatabase set dbproperties(&quot;test&quot;=&quot;2017-11-06&quot;);</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Show-Database"><a href="#Show-Database" class="headerlink" title="Show Database"></a>Show Database</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">show databases;</div><div class="line">show databases like &quot;test*&quot;;</div></pre></td></tr></table></figure>
</blockquote>
<h2 id="Desc-Database"><a href="#Desc-Database" class="headerlink" title="Desc Database"></a>Desc Database</h2><blockquote>
<p>describe database [extended] db_name;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">desc database test_db;</div><div class="line">desc database extended test_db;</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Use-Database"><a href="#Use-Database" class="headerlink" title="Use Database"></a>Use Database</h2><blockquote>
<p>use db_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">use test1;</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Drop-Database"><a href="#Drop-Database" class="headerlink" title="Drop Database"></a>Drop Database</h2><blockquote>
<p>drop (database|schema) [if exists] database_name [restrict|cascade];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">drop database if exists test_db;	##Database內有Table的話無法drop,必須是要空的Database</div><div class="line">drop database test_db cascade;		##Database刪除時會Database內所有的Table資料一併刪除</div></pre></td></tr></table></figure></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Create-Database&quot;&gt;&lt;a href=&quot;#Create-Database&quot; class=&quot;headerlink&quot; title=&quot;Create Database&quot;&gt;&lt;/a&gt;Create Database&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;creat
    
    </summary>
    
      <category term="hive" scheme="http://yoursite.com/categories/hive/"/>
    
    
  </entry>
  
  <entry>
    <title>Hive相關語法整理-2(Table)</title>
    <link href="http://yoursite.com/2017/11/06/%5Bhive%5Dhive_sql_2/"/>
    <id>http://yoursite.com/2017/11/06/[hive]hive_sql_2/</id>
    <published>2017-11-05T16:00:00.000Z</published>
    <updated>2017-11-07T10:27:57.726Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Create-Table"><a href="#Create-Table" class="headerlink" title="Create Table"></a>Create Table</h2><blockquote>
<p>CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name<br>  [(col_name data_type [COMMENT col_comment], … [constraint_specification])]<br>  [COMMENT table_comment]<br>  [PARTITIONED BY (col_name data_type [COMMENT col_comment], …)]<br>  [CLUSTERED BY (col_name, col_name, …) [SORTED BY (col_name [ASC|DESC], …)] INTO num_buckets BUCKETS]<br>  [SKEWED BY (col_name, col_name, …)                  – (Note: Available in Hive 0.10.0 and later)]<br>     ON ((col_value, col_value, …), (col_value, col_value, …), …)<br>     [STORED AS DIRECTORIES]<br>  [<br>   [ROW FORMAT row_format]<br>   [STORED AS file_format]<br>     | STORED BY ‘storage.handler.class.name’ [WITH SERDEPROPERTIES (…)]  – (Note: Available in Hive 0.6.0 and later)<br>  ]<br>  [LOCATION hdfs_path]<br>  [TBLPROPERTIES (property_name=property_value, …)]   – (Note: Available in Hive 0.6.0 and later)<br>  [AS select_statement];   – (Note: Available in Hive 0.5.0 and later; not supported for external tables)</p>
<p>CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name<br>  LIKE existing_table_or_view_name<br>  [LOCATION hdfs_path];</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Example1:</div><div class="line">以下範例為Table建立各種型態欄位</div><div class="line">create table test1(a1 tinyint,a2 smallint,a3 int,a4 bigint);</div><div class="line">create table test2(a1 float,a2 double);</div><div class="line">create table test3(a1 string,a2 varchar(2000),a3 char(4));</div><div class="line">create table test4(a1 boolean,a2 date,a3 timestamp);</div><div class="line">create table test5(a1 map&lt;string,string&gt;,a2 array&lt;string&gt;,a3 struct&lt;c1:string,c2:int,c3:date&gt;);</div><div class="line">create table test5_1(a1 map&lt;string,string&gt;,a2 array&lt;string&gt;,a3 struct&lt;c1:string,c2:int,c3:date&gt;,a4 uniontype&lt;string,int,date&gt;);</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Example2:</div><div class="line">建立Partition Table</div><div class="line">create table test6_1(a1 string,a2 int)</div><div class="line">partitioned by(a3 string);</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Example3:</div><div class="line">建立Bluck Table</div><div class="line">create table test6_2(a1 string,a2 int)</div><div class="line">clustered by(a2) </div><div class="line">into 5 buckets;</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example4:</div><div class="line">CTAS 用法範例</div><div class="line">create table test7 as select &quot;ttt&quot;, concat(&quot;part_&quot;, &quot;aaa&quot;);</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example5:</div><div class="line">建立外部表格,表格刪除時Table檔案並不會跟著一起被刪除</div><div class="line">create external table if not exists test8(a1 string,a2 int);</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example6:</div><div class="line">建立暫存表格</div><div class="line">create temporary table if not exists test9(a1 string,a2 int);</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example7:</div><div class="line">建立與某一個表格相同欄位的表格 (copy 某個Table的欄位)</div><div class="line">create table test10 like test1;	--copy columns from table;</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Example8:</div><div class="line">create table taiwan_area(</div><div class="line">  cityname string COMMENT &quot;行政區名稱&quot;,</div><div class="line">  type string COMMENT &quot;行政區類別&quot;,</div><div class="line">  area float COMMENT &quot;區域面積&quot;,</div><div class="line">  village_num smallint COMMENT &quot;村里數&quot;,</div><div class="line">  neighborhood_num smallint COMMENT &quot;鄰數&quot;,</div><div class="line">  people_num int COMMENT &quot;人口數&quot;,</div><div class="line">  density int COMMENT &quot;人口密度&quot;,</div><div class="line">  zipcode smallint COMMENT &quot;郵遞區號&quot;</div><div class="line">)</div><div class="line">row format serde &apos;org.apache.hadoop.hive.serde2.OpenCSVSerde&apos;</div><div class="line">with SERDEPROPERTIES(</div><div class="line">&quot;separatorChar&quot; = &quot;,&quot;,</div><div class="line">&quot;quoteChar&quot;     = &quot;\&quot;&quot;,</div><div class="line">&quot;escapeChar&quot;    = &quot;\\&quot;</div><div class="line">)</div><div class="line">STORED AS TEXTFILE;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Result:</div><div class="line">hive&gt; desc taiwan_area;</div><div class="line">OK</div><div class="line">cityname                string                  from deserializer</div><div class="line">type                    string                  from deserializer</div><div class="line">area                    string                  from deserializer</div><div class="line">village_num             string                  from deserializer</div><div class="line">neighborhood_num        string                  from deserializer</div><div class="line">people_num              string                  from deserializer</div><div class="line">density                 string                  from deserializer</div><div class="line">zipcode                 string                  from deserializer</div><div class="line">Time taken: 0.254 seconds, Fetched: 8 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Example9:</div><div class="line">create table page_view(</div><div class="line">  viewTime int, </div><div class="line">  userid bigint,</div><div class="line">  page_url string, </div><div class="line">  referrer_url string,</div><div class="line">  ip string comment &apos;IP Address of the User&apos;)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;\001&apos;</div><div class="line">   collection items terminated by &apos;\002&apos;</div><div class="line">   map keys terminated by &apos;\003&apos;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Result:</div><div class="line">hive&gt; desc page_view;</div><div class="line">OK</div><div class="line">viewtime                int</div><div class="line">userid                  bigint</div><div class="line">page_url                string</div><div class="line">referrer_url            string</div><div class="line">ip                      string                  IP Address of the User</div><div class="line">dt                      string</div><div class="line">country                 string</div><div class="line"></div><div class="line"># Partition Information</div><div class="line"># col_name              data_type               comment</div><div class="line"></div><div class="line">dt                      string</div><div class="line">country                 string</div><div class="line">Time taken: 0.193 seconds, Fetched: 13 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<p>Example10:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Prepare CSV file:</div><div class="line">CSV檔內容如下:</div><div class="line">test1.csv</div><div class="line">echo 100,1,\&quot;http://www.google.com\&quot;,\&quot;http://www.google.com\&quot;,\&quot;192.168.1.1\&quot; &gt; ~/test1.csv</div><div class="line">echo 200,2,\&quot;http://www.google.com\&quot;,\&quot;http://www.google.com\&quot;,\&quot;192.168.1.2\&quot; &gt;&gt; ~/test1.csv</div><div class="line">echo 150,3,\&quot;http://www.google.com\&quot;,\&quot;http://www.google.com\&quot;,\&quot;192.168.1.3\&quot; &gt;&gt; ~/test1.csv</div><div class="line">echo 300,4,\&quot;http://www.google.com\&quot;,\&quot;http://www.google.com\&quot;,\&quot;192.168.1.4\&quot; &gt;&gt; ~/test1.csv</div><div class="line">直接在Linux系統上使用指令建立以上檔案</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">create table page_view_1(</div><div class="line">  viewTime int, </div><div class="line">  userid bigint,</div><div class="line">  page_url string, </div><div class="line">  referrer_url string,</div><div class="line">  ip string comment &apos;IP Address of the User&apos;)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">使用Load將資料insert至Table</div><div class="line">load data local inpath &quot;/home/hadoop/test1.csv&quot; overwrite into table page_view_1 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Result:</div><div class="line">hive&gt; select * from page_view_1;</div><div class="line">OK</div><div class="line">100     1       &quot;http://www.google.com&quot; &quot;http://www.google.com&quot; &quot;192.168.1.1&quot;   taipei  taiwan</div><div class="line">200     2       &quot;http://www.google.com&quot; &quot;http://www.google.com&quot; &quot;192.168.1.2&quot;   taipei  taiwan</div><div class="line">150     3       &quot;http://www.google.com&quot; &quot;http://www.google.com&quot; &quot;192.168.1.3&quot;   taipei  taiwan</div><div class="line">300     4       &quot;http://www.google.com&quot; &quot;http://www.google.com&quot; &quot;192.168.1.4&quot;   taipei  taiwan</div><div class="line">Time taken: 0.335 seconds, Fetched: 4 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Example11</div><div class="line">Step1:</div><div class="line">建立CSV檔</div><div class="line">test2.csv</div><div class="line">echo 1,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;404\&quot;,100 &gt;~/test2.csv</div><div class="line">echo 2,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;200\&quot;,100 &gt;&gt;~/test2.csv</div><div class="line">echo 3,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;500\&quot;,100 &gt;&gt;~/test2.csv</div><div class="line">echo 4,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;503\&quot;,100 &gt;&gt;~/test2.csv</div><div class="line">echo 5,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;201\&quot;,100 &gt;&gt;~/test2.csv</div><div class="line">echo 6,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;403\&quot;,100 &gt;&gt;~/test2.csv</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Step2:</div><div class="line">create table page_view_2( </div><div class="line">  userid bigint,</div><div class="line">  data struct&lt;page_url:string,ip:string,status:string&gt;,</div><div class="line">  view_count int)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">   collection items terminated by &apos;\;&apos;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Step3:</div><div class="line">load data local inpath &quot;/home/hadoop/test2.csv&quot; overwrite into table page_view_2 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Step4:</div><div class="line">hive&gt; select * from page_view_2;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;404\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;200\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;500\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;503\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;201\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">6       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;403\&quot;&quot;&#125;      100     taipei  taiwan</div><div class="line">Time taken: 2.183 seconds, Fetched: 6 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Example12:</div><div class="line">Step1:</div><div class="line">create table page_view_3(</div><div class="line">  viewTime int, </div><div class="line">  userid bigint,</div><div class="line">  page_url string, </div><div class="line">  referrer_url string,</div><div class="line">  ip string comment &apos;IP Address of the User&apos;)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format serde &apos;org.apache.hadoop.hive.serde2.OpenCSVSerde&apos;</div><div class="line">with serdeproperties(</div><div class="line">&quot;separatorChar&quot; = &quot;,&quot;,</div><div class="line">&quot;quoteChar&quot;     = &quot;\&quot;&quot;,</div><div class="line">&quot;escapeChar&quot;    = &quot;\\&quot;</div><div class="line">) </div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Step2:</div><div class="line">load data local inpath &quot;/home/hadoop/test1.csv&quot; overwrite into table page_view_3 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Step3:</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">100     1       http://www.google.com   http://www.google.com   192.168.1.1     taipei  taiwan</div><div class="line">200     2       http://www.google.com   http://www.google.com   192.168.1.2     taipei  taiwan</div><div class="line">150     3       http://www.google.com   http://www.google.com   192.168.1.3     taipei  taiwan</div><div class="line">300     4       http://www.google.com   http://www.google.com   192.168.1.4     taipei  taiwan</div><div class="line">Time taken: 1.003 seconds, Fetched: 4 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Example13</div><div class="line">使用delimited切割欄位,以分號來做為集合區分</div><div class="line">Step1:</div><div class="line">echo 1,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;100\&quot;,\&quot;001\&quot;\;\&quot;test1_001\&quot;\;100 &gt;~/test4.csv</div><div class="line">echo 2,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.2\&quot;\;\&quot;200\&quot;,\&quot;002\&quot;\;\&quot;test1_002\&quot;\;200 &gt;&gt;~/test4.csv</div><div class="line">echo 3,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.3\&quot;\;\&quot;300\&quot;,\&quot;003\&quot;\;\&quot;test1_003\&quot;\;300 &gt;&gt;~/test4.csv</div><div class="line">echo 4,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.4\&quot;\;\&quot;400\&quot;,\&quot;004\&quot;\;\&quot;test1_004\&quot;\;400 &gt;&gt;~/test4.csv</div><div class="line">echo 5,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.5\&quot;\;\&quot;500\&quot;,\&quot;005\&quot;\;\&quot;test1_005\&quot;\;500 &gt;&gt;~/test4.csv</div><div class="line">echo 6,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.6\&quot;\;\&quot;600\&quot;,\&quot;006\&quot;\;\&quot;test1_006\&quot;\;600 &gt;&gt;~/test4.csv</div><div class="line">echo 7,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.7\&quot;\;\&quot;700\&quot;,\&quot;007\&quot;\;\&quot;test1_007\&quot;\;700 &gt;&gt;~/test4.csv</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Step2:</div><div class="line">建立Table</div><div class="line">create table page_view_4( </div><div class="line">  id bigint,</div><div class="line">  data struct&lt;page_url:string,ip:string,status:string&gt;,</div><div class="line">  userdata struct&lt;id:string,name:string,viewcnt:int&gt;</div><div class="line">)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">   collection items terminated by &quot;\;&quot;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Step3:</div><div class="line">load data to page_view_4</div><div class="line">load data local inpath &quot;/home/hadoop/test4.csv&quot; overwrite into table page_view_4 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Step4:</div><div class="line">hive&gt; select * from page_view_4;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;100\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;001\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_001\&quot;&quot;,&quot;viewcnt&quot;:100&#125;   taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.2\&quot;&quot;,&quot;status&quot;:&quot;\&quot;200\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;002\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_002\&quot;&quot;,&quot;viewcnt&quot;:200&#125;   taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.3\&quot;&quot;,&quot;status&quot;:&quot;\&quot;300\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;003\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_003\&quot;&quot;,&quot;viewcnt&quot;:300&#125;   taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.4\&quot;&quot;,&quot;status&quot;:&quot;\&quot;400\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;004\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_004\&quot;&quot;,&quot;viewcnt&quot;:400&#125;   taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.5\&quot;&quot;,&quot;status&quot;:&quot;\&quot;500\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;005\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_005\&quot;&quot;,&quot;viewcnt&quot;:500&#125;   taipei  taiwan</div><div class="line">6       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.6\&quot;&quot;,&quot;status&quot;:&quot;\&quot;600\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;006\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_006\&quot;&quot;,&quot;viewcnt&quot;:600&#125;   taipei  taiwan</div><div class="line">7       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.7\&quot;&quot;,&quot;status&quot;:&quot;\&quot;700\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;007\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_007\&quot;&quot;,&quot;viewcnt&quot;:700&#125;   taipei  taiwan</div><div class="line">Time taken: 0.13 seconds, Fetched: 7 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Example14:</div><div class="line">使用冒號(:)來做為Map的key,value的區分範例</div><div class="line">Step1:</div><div class="line">echo 1,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;401\&quot;,id:001\;name:test1_001\;count:100 &gt; ~/test5.csv</div><div class="line">echo 2,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.2\&quot;\;\&quot;401\&quot;,id:002\;name:test1_002\;count:200 &gt;&gt; ~/test5.csv</div><div class="line">echo 3,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.3\&quot;\;\&quot;401\&quot;,id:003\;name:test1_003\;count:300 &gt;&gt; ~/test5.csv</div><div class="line">echo 4,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.4\&quot;\;\&quot;401\&quot;,id:004\;name:test1_004\;count:400 &gt;&gt; ~/test5.csv</div><div class="line">echo 5,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.5\&quot;\;\&quot;401\&quot;,id:005\;name:test1_005\;count:500 &gt;&gt; ~/test5.csv</div><div class="line">echo 6,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.6\&quot;\;\&quot;401\&quot;,id:006\;name:test1_006\;count:600 &gt;&gt; ~/test5.csv</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Step2:</div><div class="line">create table page_view_5( </div><div class="line">  id bigint,</div><div class="line">  data struct&lt;page_url:string,ip:string,status:string&gt;,</div><div class="line">  userdata map&lt;string,string&gt;</div><div class="line">)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(dt string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">   collection items terminated by &quot;\;&quot;</div><div class="line">   map keys terminated by &quot;\:&quot;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Step3:</div><div class="line">load data local inpath &quot;/home/hadoop/test5.csv&quot; overwrite into table page_view_5 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Step4:</div><div class="line">hive&gt; select * from page_view_5;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;001&quot;,&quot;name&quot;:&quot;test1_001&quot;,&quot;count&quot;:&quot;100&quot;&#125;   taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.2\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;002&quot;,&quot;name&quot;:&quot;test1_002&quot;,&quot;count&quot;:&quot;200&quot;&#125;   taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.3\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;003&quot;,&quot;name&quot;:&quot;test1_003&quot;,&quot;count&quot;:&quot;300&quot;&#125;   taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.4\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;004&quot;,&quot;name&quot;:&quot;test1_004&quot;,&quot;count&quot;:&quot;400&quot;&#125;   taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.5\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;005&quot;,&quot;name&quot;:&quot;test1_005&quot;,&quot;count&quot;:&quot;500&quot;&#125;   taipei  taiwan</div><div class="line">6       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.6\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;006&quot;,&quot;name&quot;:&quot;test1_006&quot;,&quot;count&quot;:&quot;600&quot;&#125;   taipei  taiwan</div><div class="line">Time taken: 1.217 seconds, Fetched: 6 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Example15:</div><div class="line">Step1:</div><div class="line">echo 1,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.1\&quot;\;\&quot;401\&quot;,id:001\;name:test1_001\;gender:F\;count:100,300\;400\;500 &gt; ~/test6.csv</div><div class="line">echo 2,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.2\&quot;\;\&quot;401\&quot;,id:002\;name:test1_002\;gender:M\;count:200,600\;700\;800 &gt;&gt; ~/test6.csv</div><div class="line">echo 3,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.3\&quot;\;\&quot;401\&quot;,id:003\;name:test1_003\;gender:F\;count:300,100\;200\;300 &gt;&gt; ~/test6.csv</div><div class="line">echo 4,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.4\&quot;\;\&quot;401\&quot;,id:004\;name:test1_004\;gender:M\;count:400,400\;500\;600 &gt;&gt; ~/test6.csv</div><div class="line">echo 5,\&quot;http://www.google.com\&quot;\;\&quot;192.168.1.5\&quot;\;\&quot;401\&quot;,id:005\;name:test1_005\;gender:F\;count:500,250\;100\;900 &gt;&gt; ~/test6.csv</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Step2:</div><div class="line">create table page_view_6( </div><div class="line">  id bigint,</div><div class="line">  data struct&lt;page_url:string,ip:string,status:string&gt;,</div><div class="line">  userdata map&lt;string,string&gt;,</div><div class="line">  countlist array&lt;int&gt;</div><div class="line">)</div><div class="line">comment &apos;This is the page view table&apos;</div><div class="line">partitioned by(city string, country string)</div><div class="line">row format delimited</div><div class="line">   fields terminated by &apos;,&apos;</div><div class="line">   collection items terminated by &quot;\;&quot;</div><div class="line">   map keys terminated by &quot;\:&quot;</div><div class="line">stored as textfile;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Step3:</div><div class="line">load data local inpath &quot;/home/hadoop/test6.csv&quot; overwrite into table page_view_6 partition(city=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Step4:</div><div class="line">hive&gt; select * from page_view_6;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;001&quot;,&quot;name&quot;:&quot;test1_001&quot;,&quot;gender&quot;:&quot;F&quot;,&quot;count&quot;:&quot;100&quot;&#125;      [300,400,500]   taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.2\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;002&quot;,&quot;name&quot;:&quot;test1_002&quot;,&quot;gender&quot;:&quot;M&quot;,&quot;count&quot;:&quot;200&quot;&#125;      [600,700,800]   taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.3\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;003&quot;,&quot;name&quot;:&quot;test1_003&quot;,&quot;gender&quot;:&quot;F&quot;,&quot;count&quot;:&quot;300&quot;&#125;      [100,200,300]   taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.4\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;004&quot;,&quot;name&quot;:&quot;test1_004&quot;,&quot;gender&quot;:&quot;M&quot;,&quot;count&quot;:&quot;400&quot;&#125;      [400,500,600]   taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.5\&quot;&quot;,&quot;status&quot;:&quot;\&quot;401\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;005&quot;,&quot;name&quot;:&quot;test1_005&quot;,&quot;gender&quot;:&quot;F&quot;,&quot;count&quot;:&quot;500&quot;&#125;      [250,100,900]   taipei  taiwan</div><div class="line">Time taken: 1.126 seconds, Fetched: 5 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<h2 id="Alter-Table"><a href="#Alter-Table" class="headerlink" title="Alter Table"></a>Alter Table</h2><h3 id="Rename-Table-Name"><a href="#Rename-Table-Name" class="headerlink" title="Rename Table Name"></a>Rename Table Name</h3><blockquote>
<p>alter table table_name rename to new_table_name;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Example1:</div><div class="line">將Table更改名稱或搬移至其他資料庫</div><div class="line">alter table page_view_3 rename to pv_3;</div><div class="line">alter table pv_3 rename to test.pv_3;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Alter-Table-Properties"><a href="#Alter-Table-Properties" class="headerlink" title="Alter Table Properties"></a>Alter Table Properties</h3><blockquote>
<p>alter table table_name set tblproperties table_properties;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Example1:</div><div class="line">修改Table的屬性</div><div class="line">alter table test.pv_3 set tblproperties (&quot;comment&quot; = &quot;page_view_3 rename to pv_3&quot;);</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Add-SerDe-Properties"><a href="#Add-SerDe-Properties" class="headerlink" title="Add SerDe Properties"></a>Add SerDe Properties</h3><blockquote>
<p>ALTER TABLE table_name [PARTITION partition_spec]<br>  SET SERDE serde_class_name [WITH SERDEPROPERTIES serde_properties];</p>
<p>ALTER TABLE table_name [PARTITION partition_spec] SET SERDEPROPERTIES serde_properties;<br>  serde_properties:<br>      : (property_name = property_value, property_name = property_value, … )<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alter table test.pv_3 set serdeproperties(&apos;field.delim&apos;=&apos;\u0001&apos;);</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Alter-Either-Table-or-Partition"><a href="#Alter-Either-Table-or-Partition" class="headerlink" title="Alter Either Table or Partition"></a>Alter Either Table or Partition</h3><blockquote>
<p>ALTER TABLE table_name [PARTITION partition_spec] SET FILEFORMAT file_format;<br>file_format:<br>    :sequence,textfile,rcfile,orc<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Example1</div><div class="line">alter table test.pv_3 set fileformat textfile;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<blockquote>
<p>ALTER TABLE table_name [PARTITIONpartitionSpec] SET LOCATION “newlocation”<br>修改表格存放路徑<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">alter table test.pv_3 set location &quot;/user/hadoop/data&quot;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="Import-Data-to-Table"><a href="#Import-Data-to-Table" class="headerlink" title="Import Data to Table"></a>Import Data to Table</h2><h3 id="load-data"><a href="#load-data" class="headerlink" title="load data"></a>load data</h3><blockquote>
<p>LOAD DATA [local] INPATH ‘hdfs_file_or_directory_path’<br>  [OVERWRITE] INTO TABLE tablename<br>  [PARTITION (partcol1=val1, partcol2=val2 …)]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">Example1:</div><div class="line">load data local inpath &quot;/home/hadoop/test1.csv&quot; overwrite into table page_view_3 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div><div class="line"></div><div class="line">Result:</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">Time taken: 0.106 seconds</div><div class="line">hive&gt; load data local inpath &quot;/home/hadoop/test1.csv&quot; overwrite into table page_view_3 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div><div class="line">Loading data to table default.page_view_3 partition (dt=taipei, country=taiwan)</div><div class="line">OK</div><div class="line">Time taken: 0.658 seconds</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">100     1       http://www.google.com   http://www.google.com   192.168.1.1     taipei  taiwan</div><div class="line">200     2       http://www.google.com   http://www.google.com   192.168.1.2     taipei  taiwan</div><div class="line">150     3       http://www.google.com   http://www.google.com   192.168.1.3     taipei  taiwan</div><div class="line">300     4       http://www.google.com   http://www.google.com   192.168.1.4     taipei  taiwan</div><div class="line">hive&gt; truncate table page_view_3;</div><div class="line">OK</div><div class="line">Time taken: 0.345 seconds</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">Time taken: 0.143 seconds</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Example2:</div><div class="line">load data inpath &quot;/user/hadoop/data/test1.csv&quot; overwrite into table page_view_3 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div><div class="line"></div><div class="line">Result:</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">Time taken: 0.129 seconds</div><div class="line">hive&gt; load data inpath &quot;/user/hadoop/data/test1.csv&quot; overwrite into table page_view_3 partition(dt=&quot;taipei&quot;,country=&quot;taiwan&quot;);</div><div class="line">Loading data to table default.page_view_3 partition (dt=taipei, country=taiwan)</div><div class="line">OK</div><div class="line">Time taken: 0.647 seconds</div><div class="line">hive&gt; select * from page_view_3;</div><div class="line">OK</div><div class="line">100     1       http://www.google.com   http://www.google.com   192.168.1.1     taipei  taiwan</div><div class="line">200     2       http://www.google.com   http://www.google.com   192.168.1.2     taipei  taiwan</div><div class="line">150     3       http://www.google.com   http://www.google.com   192.168.1.3     taipei  taiwan</div><div class="line">300     4       http://www.google.com   http://www.google.com   192.168.1.4     taipei  taiwan</div><div class="line">Time taken: 0.109 seconds, Fetched: 4 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<h3 id="create-table-…-as-select"><a href="#create-table-…-as-select" class="headerlink" title="create table ….as select"></a>create table ….as select</h3><blockquote>
<p>create table table_name as select_statement<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">複製一個Table到新Table中(包含資料)</div><div class="line">create table test.pv_4 as select * from page_view_4;</div><div class="line"></div><div class="line">hive&gt; select * from test.pv_4;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;100\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;001\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_001\&quot;&quot;,&quot;viewcnt&quot;:100&#125;   taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.2\&quot;&quot;,&quot;status&quot;:&quot;\&quot;200\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;002\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_002\&quot;&quot;,&quot;viewcnt&quot;:200&#125;   taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.3\&quot;&quot;,&quot;status&quot;:&quot;\&quot;300\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;003\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_003\&quot;&quot;,&quot;viewcnt&quot;:300&#125;   taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.4\&quot;&quot;,&quot;status&quot;:&quot;\&quot;400\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;004\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_004\&quot;&quot;,&quot;viewcnt&quot;:400&#125;   taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.5\&quot;&quot;,&quot;status&quot;:&quot;\&quot;500\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;005\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_005\&quot;&quot;,&quot;viewcnt&quot;:500&#125;   taipei  taiwan</div><div class="line">6       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.6\&quot;&quot;,&quot;status&quot;:&quot;\&quot;600\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;006\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_006\&quot;&quot;,&quot;viewcnt&quot;:600&#125;   taipei  taiwan</div><div class="line">7       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.7\&quot;&quot;,&quot;status&quot;:&quot;\&quot;700\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;007\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_007\&quot;&quot;,&quot;viewcnt&quot;:700&#125;   taipei  taiwan</div><div class="line">Time taken: 0.087 seconds, Fetched: 7 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="create-table-…like"><a href="#create-table-…like" class="headerlink" title="create table …like"></a>create table …like</h3><blockquote>
<p>CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name<br>  LIKE existing_table_or_view_name<br>  [LOCATION hdfs_path];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">複製一個Table到新Table中(僅 columns)</div><div class="line">create table test.pv_4_like like page_view_4;</div><div class="line">create table if not exists test.pv_4_new like page_view_4;</div><div class="line"></div><div class="line">hive&gt; select * from test.pv_4_new;</div><div class="line">OK</div><div class="line">Time taken: 0.099 seconds</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="from-…insert-select"><a href="#from-…insert-select" class="headerlink" title="from …insert select"></a>from …insert select</h3><blockquote>
<p>FROM from_statement<br>INSERT OVERWRITE TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 …) [IF NOT EXISTS]] select_statement1<br>[INSERT OVERWRITE TABLE tablename2 [PARTITION … [IF NOT EXISTS]] select_statement2]<br>[INSERT INTO TABLE tablename2 [PARTITION …] select_statement2] …;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">from page_view_3 insert overwrite table page_view_3_1 partition(dt=&quot;taipei&quot;,country=&quot;test1&quot;)  </div><div class="line">if not exists </div><div class="line">select page_url,viewTime,userid,viewTime,ip;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="Show-Table"><a href="#Show-Table" class="headerlink" title="Show Table"></a>Show Table</h2><h3 id="Show-Tables"><a href="#Show-Tables" class="headerlink" title="Show Tables"></a>Show Tables</h3><blockquote>
<p>SHOW TABLES [IN database_name] [‘identifier_with_wildcards’];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">Demo:</div><div class="line">hive&gt; show tables from test;</div><div class="line">OK</div><div class="line">list_bucket_single</div><div class="line">pv_3</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">test_a</div><div class="line">test_b</div><div class="line">test_c</div><div class="line">test_d</div><div class="line">test_e</div><div class="line">test_f</div><div class="line">Time taken: 0.024 seconds, Fetched: 11 row(s)</div><div class="line">hive&gt; show tables in test;</div><div class="line">OK</div><div class="line">list_bucket_single</div><div class="line">pv_3</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">test_a</div><div class="line">test_b</div><div class="line">test_c</div><div class="line">test_d</div><div class="line">test_e</div><div class="line">test_f</div><div class="line">Time taken: 0.018 seconds, Fetched: 11 row(s)</div><div class="line">hive&gt; show tables in test like &quot;test*&quot;;</div><div class="line">OK</div><div class="line">test_a</div><div class="line">test_b</div><div class="line">test_c</div><div class="line">test_d</div><div class="line">test_e</div><div class="line">test_f</div><div class="line">Time taken: 0.019 seconds, Fetched: 6 row(s)</div><div class="line">hive&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Show-Table-1"><a href="#Show-Table-1" class="headerlink" title="Show Table"></a>Show Table</h3><blockquote>
<p>SHOW TABLE EXTENDED [IN|FROM database_name] LIKE ‘identifier_with_wildcards’ [PARTITION(partition_spec)];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">show table extended from test like &quot;pv_3&quot;</div><div class="line"></div><div class="line">Demo:</div><div class="line">hive&gt; show table extended from test like &quot;pv_3&quot;;</div><div class="line">OK</div><div class="line">tableName:pv_3</div><div class="line">owner:hadoop</div><div class="line">location:hdfs://mna1:8020/user/hadoop/data</div><div class="line">inputformat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat</div><div class="line">outputformat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat</div><div class="line">columns:struct columns &#123; i32 viewtime, i64 userid, string page_url, string referrer_url, string ip&#125;</div><div class="line">partitioned:true</div><div class="line">partitionColumns:struct partition_columns &#123; string dt, string country&#125;</div><div class="line">totalNumberFiles:1</div><div class="line">totalFileSize:272</div><div class="line">maxFileSize:272</div><div class="line">minFileSize:272</div><div class="line">lastAccessTime:1510037040061</div><div class="line">lastUpdateTime:1510043296966</div><div class="line"></div><div class="line">Time taken: 0.037 seconds, Fetched: 15 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="Show-Table-Properties"><a href="#Show-Table-Properties" class="headerlink" title="Show Table Properties"></a>Show Table Properties</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">hive&gt; SHOW TBLPROPERTIES page_view_7;</div><div class="line">OK</div><div class="line">transient_lastDdlTime   1510042890</div><div class="line">Time taken: 0.029 seconds, Fetched: 1 row(s)</div><div class="line"></div><div class="line">hive&gt; SHOW TBLPROPERTIES page_view_7(&quot;transient_lastDdlTime&quot;);</div><div class="line">OK</div><div class="line">1510042890</div><div class="line">Time taken: 0.029 seconds, Fetched: 1 row(s)</div></pre></td></tr></table></figure>
</blockquote>
<hr>
<h3 id="Show-Create-Table"><a href="#Show-Create-Table" class="headerlink" title="Show Create Table"></a>Show Create Table</h3><blockquote>
<p>SHOW CREATE TABLE ([db_name.]table_name|view_name);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">show create table page_view_7;</div><div class="line"></div><div class="line">Demo:</div><div class="line">hive&gt; show create table page_view_7;</div><div class="line">OK</div><div class="line">CREATE TABLE `page_view_7`(</div><div class="line">  `viewtime` int,</div><div class="line">  `userid` bigint,</div><div class="line">  `page_url` string,</div><div class="line">  `referrer_url` string,</div><div class="line">  `ip` string)</div><div class="line">PARTITIONED BY (</div><div class="line">  `dt` string,</div><div class="line">  `country` string)</div><div class="line">ROW FORMAT SERDE</div><div class="line">  &apos;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&apos;</div><div class="line">WITH SERDEPROPERTIES (</div><div class="line">  &apos;field.delim&apos;=&apos;,&apos;,</div><div class="line">  &apos;serialization.format&apos;=&apos;,&apos;)</div><div class="line">STORED AS INPUTFORMAT</div><div class="line">  &apos;org.apache.hadoop.mapred.TextInputFormat&apos;</div><div class="line">OUTPUTFORMAT</div><div class="line">  &apos;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&apos;</div><div class="line">LOCATION</div><div class="line">  &apos;hdfs://mna1:8020/user/hive/warehouse/page_view_7&apos;</div><div class="line">TBLPROPERTIES (</div><div class="line">  &apos;transient_lastDdlTime&apos;=&apos;1510042890&apos;)</div><div class="line">Time taken: 0.126 seconds, Fetched: 22 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Describe-Table"><a href="#Describe-Table" class="headerlink" title="Describe Table"></a>Describe Table</h2><h3 id="desc-formatted"><a href="#desc-formatted" class="headerlink" title="desc formatted"></a>desc formatted</h3><blockquote>
<p>DESCRIBE [EXTENDED|FORMATTED]<br>  [db_name.]table_name[.col_name ( [.field_name] | [.’$elem$’] | [.’$key$’] | [.’$value$’] )* ];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">desc formatted page_view_7;</div><div class="line"></div><div class="line">demo:</div><div class="line">desc formatted page_view_7;</div><div class="line">OK</div><div class="line"># col_name              data_type               comment</div><div class="line"></div><div class="line">viewtime                int</div><div class="line">userid                  bigint</div><div class="line">page_url                string</div><div class="line">referrer_url            string</div><div class="line">ip                      string</div><div class="line"></div><div class="line"># Partition Information</div><div class="line"># col_name              data_type               comment</div><div class="line"></div><div class="line">dt                      string</div><div class="line">country                 string</div><div class="line"></div><div class="line"># Detailed Table Information</div><div class="line">Database:               default</div><div class="line">Owner:                  hadoop</div><div class="line">CreateTime:             Tue Nov 07 16:21:30 CST 2017</div><div class="line">LastAccessTime:         UNKNOWN</div><div class="line">Retention:              0</div><div class="line">Location:               hdfs://mna1:8020/user/hive/warehouse/page_view_7</div><div class="line">Table Type:             MANAGED_TABLE</div><div class="line">Table Parameters:</div><div class="line">        transient_lastDdlTime   1510042890</div><div class="line"></div><div class="line"># Storage Information</div><div class="line">SerDe Library:          org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</div><div class="line">InputFormat:            org.apache.hadoop.mapred.TextInputFormat</div><div class="line">OutputFormat:           org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</div><div class="line">Compressed:             No</div><div class="line">Num Buckets:            -1</div><div class="line">Bucket Columns:         []</div><div class="line">Sort Columns:           []</div><div class="line">Storage Desc Params:</div><div class="line">        field.delim             ,</div><div class="line">        serialization.format    ,</div><div class="line">Time taken: 0.105 seconds, Fetched: 36 row(s)</div><div class="line"></div><div class="line">hive&gt; desc formatted page_view_7 page_url;</div><div class="line">OK</div><div class="line"># col_name              data_type               min                     max                     num_nulls               distinct_count          avg_col_len            max_col_len              num_trues               num_falses              comment</div><div class="line"></div><div class="line">page_url                string                                                                                                                                                                                                                  from deserializer</div><div class="line">Time taken: 0.043 seconds, Fetched: 3 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="desc-extended"><a href="#desc-extended" class="headerlink" title="desc extended"></a>desc extended</h3><blockquote>
<p>desc [extended] [db_name.]table_name[.col_name];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">hive&gt; desc extended page_view_5 userdata;</div><div class="line">OK</div><div class="line">userdata                map&lt;string,string&gt;      from deserializer</div><div class="line">Time taken: 0.03 seconds, Fetched: 1 row(s)</div><div class="line">hive&gt; desc extended page_view_5 userdata.$key$;</div><div class="line">OK</div><div class="line">$key$                   string                  from deserializer</div><div class="line">Time taken: 0.029 seconds, Fetched: 1 row(s)</div><div class="line">hive&gt; desc extended page_view_5 userdata.$value$;</div><div class="line">OK</div><div class="line">$value$                 string                  from deserializer</div><div class="line">Time taken: 0.03 seconds, Fetched: 1 row(s)</div><div class="line">hive&gt; desc formatted page_view_6;</div><div class="line">OK</div><div class="line"># col_name              data_type               comment</div><div class="line"></div><div class="line">id                      bigint</div><div class="line">data                    struct&lt;page_url:string,ip:string,status:string&gt;</div><div class="line">userdata                map&lt;string,string&gt;</div><div class="line">countlist               array&lt;int&gt;</div><div class="line">hive&gt; desc extended page_view_6 countlist.$elem$;</div><div class="line">OK</div><div class="line">$elem$                  int                     from deserializer</div><div class="line">Time taken: 0.031 seconds, Fetched: 1 row(s)</div><div class="line"></div><div class="line">hive&gt; desc extended page_view_6 data.ip;</div><div class="line">OK</div><div class="line">ip                      string                  from deserializer</div><div class="line">Time taken: 0.064 seconds, Fetched: 1 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="Drop-Table"><a href="#Drop-Table" class="headerlink" title="Drop Table"></a>Drop Table</h2><h3 id="drop-table"><a href="#drop-table" class="headerlink" title="drop table"></a>drop table</h3><blockquote>
<p>drop table [db_name.]table_name;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">hive&gt; show tables from test like &quot;pv*&quot;;</div><div class="line">OK</div><div class="line">pv_3</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">Time taken: 0.017 seconds, Fetched: 4 row(s)</div><div class="line">hive&gt; drop table test.pv_3;</div><div class="line">OK</div><div class="line">Time taken: 1.598 seconds</div><div class="line">hive&gt; show tables from test like &quot;pv*&quot;;</div><div class="line">OK</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">Time taken: 0.018 seconds, Fetched: 3 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="truncate-table"><a href="#truncate-table" class="headerlink" title="truncate table"></a>truncate table</h3><blockquote>
<p>truncate table [db_name.]table_name;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">hive&gt; select * from test.pv_4;</div><div class="line">OK</div><div class="line">1       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.1\&quot;&quot;,&quot;status&quot;:&quot;\&quot;100\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;001\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_001\&quot;&quot;,&quot;viewcnt&quot;:100&#125;   taipei  taiwan</div><div class="line">2       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.2\&quot;&quot;,&quot;status&quot;:&quot;\&quot;200\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;002\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_002\&quot;&quot;,&quot;viewcnt&quot;:200&#125;   taipei  taiwan</div><div class="line">3       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.3\&quot;&quot;,&quot;status&quot;:&quot;\&quot;300\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;003\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_003\&quot;&quot;,&quot;viewcnt&quot;:300&#125;   taipei  taiwan</div><div class="line">4       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.4\&quot;&quot;,&quot;status&quot;:&quot;\&quot;400\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;004\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_004\&quot;&quot;,&quot;viewcnt&quot;:400&#125;   taipei  taiwan</div><div class="line">5       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.5\&quot;&quot;,&quot;status&quot;:&quot;\&quot;500\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;005\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_005\&quot;&quot;,&quot;viewcnt&quot;:500&#125;   taipei  taiwan</div><div class="line">6       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.6\&quot;&quot;,&quot;status&quot;:&quot;\&quot;600\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;006\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_006\&quot;&quot;,&quot;viewcnt&quot;:600&#125;   taipei  taiwan</div><div class="line">7       &#123;&quot;page_url&quot;:&quot;\&quot;http://www.google.com\&quot;&quot;,&quot;ip&quot;:&quot;\&quot;192.168.1.7\&quot;&quot;,&quot;status&quot;:&quot;\&quot;700\&quot;&quot;&#125;      &#123;&quot;id&quot;:&quot;\&quot;007\&quot;&quot;,&quot;name&quot;:&quot;\&quot;test1_007\&quot;&quot;,&quot;viewcnt&quot;:700&#125;   taipei  taiwan</div><div class="line">Time taken: 0.071 seconds, Fetched: 7 row(s)</div><div class="line">hive&gt; truncate table test.pv_4;</div><div class="line">OK</div><div class="line">Time taken: 0.124 seconds</div><div class="line">hive&gt; select * from test.pv_4;</div><div class="line">OK</div><div class="line">Time taken: 0.063 seconds</div><div class="line">hive&gt; show tables from test like &quot;pv*&quot;;</div><div class="line">OK</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">Time taken: 0.018 seconds, Fetched: 3 row(s)</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h3 id="multi-drop-table"><a href="#multi-drop-table" class="headerlink" title="multi drop table"></a>multi drop table</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Example:</div><div class="line">hive&gt; show tables from test like &quot;pv*&quot;;</div><div class="line">OK</div><div class="line">pv_4</div><div class="line">pv_4_like</div><div class="line">pv_4_new</div><div class="line">Time taken: 0.017 seconds, Fetched: 3 row(s)</div><div class="line"></div><div class="line">[hadoop@mna1 ~]$ hive -e &quot;show tables from test like &apos;pv*&apos;&quot; |xargs -I &apos;&#123;&#125;&apos; hive -e &quot;drop table test.&#123;&#125;&quot;</div><div class="line">hive&gt; show tables from test like &quot;pv*&quot;;</div><div class="line">OK</div><div class="line">Time taken: 1.548 seconds</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Create-Table&quot;&gt;&lt;a href=&quot;#Create-Table&quot; class=&quot;headerlink&quot; title=&quot;Create Table&quot;&gt;&lt;/a&gt;Create Table&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;CREATE [TEMPORARY
    
    </summary>
    
      <category term="hive" scheme="http://yoursite.com/categories/hive/"/>
    
    
  </entry>
  
  <entry>
    <title>透過vagrant打包一個VM Box</title>
    <link href="http://yoursite.com/2017/07/19/%5Bvagrant%5D%E6%89%93%E9%80%A0%E4%B8%80%E5%80%8B%E8%87%AA%E5%B7%B1%E9%96%8B%E7%99%BC%E5%A2%83%E5%A2%83/"/>
    <id>http://yoursite.com/2017/07/19/[vagrant]打造一個自己開發境境/</id>
    <published>2017-07-18T16:00:00.000Z</published>
    <updated>2017-07-18T07:15:28.059Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Download-amp-Install-Virtual-Box"><a href="#Download-amp-Install-Virtual-Box" class="headerlink" title="Download &amp; Install Virtual Box"></a>Download &amp; Install Virtual Box</h3><h4 id="Download-Virtual-Box-Install-EXE-file"><a href="#Download-Virtual-Box-Install-EXE-file" class="headerlink" title="Download Virtual Box Install EXE file"></a>Download Virtual Box Install EXE file</h4><p><img src="/images/vagrant/install_vbox_1.jpg" alt=""></p>
<h4 id="Install-VirtualBox"><a href="#Install-VirtualBox" class="headerlink" title="Install VirtualBox"></a>Install VirtualBox</h4><p><img src="/images/vagrant/install_vbox_2.jpg" alt=""><br><img src="/images/vagrant/install_vbox_3.jpg" alt=""><br><img src="/images/vagrant/install_vbox_4.jpg" alt=""><br><img src="/images/vagrant/install_vbox_5.jpg" alt=""></p>
<h4 id="Modify-Virtual-Box-Preferences"><a href="#Modify-Virtual-Box-Preferences" class="headerlink" title="Modify Virtual Box Preferences"></a>Modify Virtual Box Preferences</h4><p>點選”File”–&gt;”Preferences”<br><img src="/images/vagrant/install_vbox_6.jpg" alt=""><br>修改預設機器資料夾位置<br><img src="/images/vagrant/install_vbox_7.jpg" alt=""></p>
<h3 id="DownLoad-amp-Install-Vagrant"><a href="#DownLoad-amp-Install-Vagrant" class="headerlink" title="DownLoad &amp; Install Vagrant"></a>DownLoad &amp; Install Vagrant</h3><h4 id="Download-vagrant-1-9-1-msi"><a href="#Download-vagrant-1-9-1-msi" class="headerlink" title="Download vagrant_1.9.1.msi"></a>Download vagrant_1.9.1.msi</h4><p><img src="/images/vagrant/install_vagrant_1.jpg" alt=""></p>
<h4 id="Install-vagrant"><a href="#Install-vagrant" class="headerlink" title="Install vagrant"></a>Install vagrant</h4><p><img src="/images/vagrant/install_vagrant_2.jpg" alt=""><br><img src="/images/vagrant/install_vagrant_3.jpg" alt=""></p>
<h4 id="Setting-VAGRANT-HOME"><a href="#Setting-VAGRANT-HOME" class="headerlink" title="Setting VAGRANT_HOME"></a>Setting VAGRANT_HOME</h4><p><img src="/images/vagrant/install_vagrant_4.jpg" alt=""></p>
<h3 id="Create-VM"><a href="#Create-VM" class="headerlink" title="Create VM"></a>Create VM</h3><p><img src="/images/vagrant/create_vm_1.jpg" alt=""><br><img src="/images/vagrant/create_vm_2.jpg" alt=""><br><img src="/images/vagrant/create_vm_3.jpg" alt=""><br><img src="/images/vagrant/create_vm_4.jpg" alt=""></p>
<h3 id="DownLoad-Ubuntu-iso-amp-Install-Ubuntu-Linux"><a href="#DownLoad-Ubuntu-iso-amp-Install-Ubuntu-Linux" class="headerlink" title="DownLoad Ubuntu iso &amp; Install Ubuntu Linux"></a>DownLoad Ubuntu iso &amp; Install Ubuntu Linux</h3><h4 id="Download-ubuntu-17-04-server-amd64-iso"><a href="#Download-ubuntu-17-04-server-amd64-iso" class="headerlink" title="Download ubuntu-17.04-server-amd64.iso"></a>Download ubuntu-17.04-server-amd64.iso</h4><p><img src="/images/vagrant/download_iso_1.jpg" alt=""><br><img src="/images/vagrant/download_iso_2.jpg" alt=""></p>
<h4 id="Install-Linux-Server"><a href="#Install-Linux-Server" class="headerlink" title="Install Linux Server"></a>Install Linux Server</h4><p><img src="/images/vagrant/install_linux_1.jpg" alt=""><br><img src="/images/vagrant/install_linux_2.jpg" alt=""><br><img src="/images/vagrant/install_linux_3.jpg" alt=""><br><img src="/images/vagrant/install_linux_4.jpg" alt=""><br><img src="/images/vagrant/install_linux_5.jpg" alt=""><br><img src="/images/vagrant/install_linux_6.jpg" alt=""><br><img src="/images/vagrant/install_linux_7.jpg" alt=""><br><img src="/images/vagrant/install_linux_8.jpg" alt=""><br><img src="/images/vagrant/install_linux_9.jpg" alt=""><br><img src="/images/vagrant/install_linux_10.jpg" alt=""><br><img src="/images/vagrant/install_linux_11.jpg" alt=""><br><img src="/images/vagrant/install_linux_12.jpg" alt=""><br><img src="/images/vagrant/install_linux_13.jpg" alt=""><br><img src="/images/vagrant/install_linux_14.jpg" alt=""><br><img src="/images/vagrant/install_linux_15.jpg" alt=""><br><img src="/images/vagrant/install_linux_16.jpg" alt=""><br><img src="/images/vagrant/install_linux_17.jpg" alt=""><br><img src="/images/vagrant/install_linux_18.jpg" alt=""><br><img src="/images/vagrant/install_linux_19.jpg" alt=""><br><img src="/images/vagrant/install_linux_20.jpg" alt=""><br><img src="/images/vagrant/install_linux_21.jpg" alt=""><br><img src="/images/vagrant/install_linux_22.jpg" alt=""><br><img src="/images/vagrant/install_linux_23.jpg" alt=""><br><img src="/images/vagrant/install_linux_24.jpg" alt=""><br><img src="/images/vagrant/install_linux_25.jpg" alt=""><br><img src="/images/vagrant/install_linux_26.jpg" alt=""><br><img src="/images/vagrant/install_linux_27.jpg" alt=""><br><img src="/images/vagrant/install_linux_28.jpg" alt=""><br><img src="/images/vagrant/install_linux_29.jpg" alt=""><br><img src="/images/vagrant/install_linux_30.jpg" alt=""><br><img src="/images/vagrant/install_linux_31.jpg" alt=""><br><img src="/images/vagrant/install_linux_32.jpg" alt=""><br><img src="/images/vagrant/install_linux_33.jpg" alt=""><br><img src="/images/vagrant/install_linux_34.jpg" alt=""><br><img src="/images/vagrant/install_linux_35.jpg" alt=""><br><img src="/images/vagrant/install_linux_36.jpg" alt=""></p>
<h4 id="restart-Linux-Server"><a href="#restart-Linux-Server" class="headerlink" title="restart Linux Server"></a>restart Linux Server</h4><h3 id="Setting-Ubuntu-Linux"><a href="#Setting-Ubuntu-Linux" class="headerlink" title="Setting Ubuntu Linux"></a>Setting Ubuntu Linux</h3><h4 id="Modify-Locales"><a href="#Modify-Locales" class="headerlink" title="Modify Locales"></a>Modify Locales</h4><h4 id="Modify-visudo"><a href="#Modify-visudo" class="headerlink" title="Modify visudo"></a>Modify visudo</h4><h4 id="Create-SSH-Key"><a href="#Create-SSH-Key" class="headerlink" title="Create SSH Key"></a>Create SSH Key</h4><h4 id="Install-VBoxGuestAddition"><a href="#Install-VBoxGuestAddition" class="headerlink" title="Install VBoxGuestAddition"></a>Install VBoxGuestAddition</h4><h3 id="vagrant-package-amp-add"><a href="#vagrant-package-amp-add" class="headerlink" title="vagrant package &amp; add"></a>vagrant package &amp; add</h3><h3 id="Create-vagrantfile-vagrant-init"><a href="#Create-vagrantfile-vagrant-init" class="headerlink" title="Create vagrantfile(vagrant init)"></a>Create vagrantfile(vagrant init)</h3><h3 id="vagrant-up"><a href="#vagrant-up" class="headerlink" title="vagrant up"></a>vagrant up</h3>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Download-amp-Install-Virtual-Box&quot;&gt;&lt;a href=&quot;#Download-amp-Install-Virtual-Box&quot; class=&quot;headerlink&quot; title=&quot;Download &amp;amp; Install Virtu
    
    </summary>
    
      <category term="vagrant" scheme="http://yoursite.com/categories/vagrant/"/>
    
    
  </entry>
  
  <entry>
    <title>Spark程式開發系列_for Java1.8_001</title>
    <link href="http://yoursite.com/2017/05/22/%5Bspark%5Dspark_001/"/>
    <id>http://yoursite.com/2017/05/22/[spark]spark_001/</id>
    <published>2017-05-21T16:00:00.000Z</published>
    <updated>2018-01-02T06:40:19.019Z</updated>
    
    <content type="html"><![CDATA[<h3 id="SparkSession-Example-1"><a href="#SparkSession-Example-1" class="headerlink" title="SparkSession Example 1"></a>SparkSession Example 1</h3><ol>
<li><p>使用vi,或先用記事本建立以下json檔案(我的是建立在/home/vagrant/src/job/person5_data.json)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;id&quot;:&quot;0000000001&quot;,&quot;name&quot;:&quot;Test001&quot;,&quot;gender&quot;:&quot;M&quot;,&quot;age&quot;:&quot;40&quot;,&quot;telphone&quot;:&quot;123456789&quot;,&quot;address&quot;:&#123;&quot;country&quot;:&quot;Taiwan&quot;,&quot;city&quot;:&quot;Taipei&quot;,&quot;state&quot;:&quot;Sanxia&quot;,&quot;street&quot;:&quot;test.&quot;&#125;,&quot;child&quot;:[&#123;&quot;age&quot;:&quot;5&quot;,&quot;name&quot;:&quot;sub_001&quot;,&quot;gender&quot;:&quot;M&quot;&#125;,&#123;&quot;age&quot;:&quot;6&quot;,&quot;name&quot;:&quot;sub_002&quot;,&quot;gender&quot;:&quot;M&quot;&#125;]&#125;,</div><div class="line">&#123;&quot;id&quot;:&quot;0000000002&quot;,&quot;name&quot;:&quot;Test002&quot;,&quot;gender&quot;:&quot;F&quot;,&quot;age&quot;:&quot;29&quot;,&quot;telphone&quot;:&quot;223456670&quot;,&quot;address&quot;:&#123;&quot;country&quot;:&quot;Taiwan&quot;,&quot;city&quot;:&quot;Taipei&quot;,&quot;state&quot;:&quot;Sanzhi&quot;,&quot;street&quot;:&quot;test.&quot;&#125;,&quot;child&quot;:[&#123;&quot;age&quot;:&quot;7&quot;,&quot;name&quot;:&quot;sub_003&quot;,&quot;gender&quot;:&quot;M&quot;&#125;,&#123;&quot;age&quot;:&quot;8&quot;,&quot;name&quot;:&quot;sub_004&quot;,&quot;gender&quot;:&quot;F&quot;&#125;]&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>將person5_data.json檔案放到HDFS目錄上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hadoop fs -put -f /home/vagrant/src/job/person5_data.json /user/hadoop/data</div></pre></td></tr></table></figure>
</li>
<li><p>Create SparkSession</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">import org.apache.spark.sql.AnalysisException;</div><div class="line">import org.apache.spark.sql.Dataset;</div><div class="line">import org.apache.spark.sql.Row;</div><div class="line">import org.apache.spark.sql.SaveMode;</div><div class="line">import org.apache.spark.sql.SparkSession;</div><div class="line">import org.apache.spark.sql.catalog.Database;</div><div class="line"></div><div class="line">public class SparkExample0 &#123;</div><div class="line"></div><div class="line">	public static void main(String[] args) throws AnalysisException &#123;</div><div class="line">		</div><div class="line">		//1. Create SparkSession</div><div class="line">		SparkSession spark = SparkSession.builder()	</div><div class="line">			.master(&quot;local&quot;)												</div><div class="line">			.config(&quot;spark.executor.memory&quot;, &quot;2g&quot;)	</div><div class="line">			.appName(&quot;SparkExample0&quot;)								</div><div class="line">			.enableHiveSupport()										</div><div class="line">			.getOrCreate();													</div><div class="line">		</div><div class="line">		//2. set new runtime options</div><div class="line">		spark.conf().set(&quot;spark.sql.shuffle.partitions&quot;, 6);</div><div class="line">						</div><div class="line">		//3. SparkSession-透過read方式來讀取各種不同來源的資料						</div><div class="line">		Dataset&lt;Row&gt; ds1 = spark.read().format(&quot;json&quot;).load(&quot;/user/hadoop/data/person5_data.json&quot;);</div><div class="line">		ds1.printSchema();</div><div class="line">		</div><div class="line">		//4. 將檔案存成Hive資料表</div><div class="line">		ds1.repartition(1).write().mode(SaveMode.Overwrite).saveAsTable(&quot;example.person_data5&quot;);													</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>使用spark-submit執行Java Spark程式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">spark-submit --class &quot;SparkExample0&quot; /home/vagrant/src/job/Spark2Example.jar</div></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;SparkSession-Example-1&quot;&gt;&lt;a href=&quot;#SparkSession-Example-1&quot; class=&quot;headerlink&quot; title=&quot;SparkSession Example 1&quot;&gt;&lt;/a&gt;SparkSession Example
    
    </summary>
    
      <category term="spark" scheme="http://yoursite.com/categories/spark/"/>
    
    
  </entry>
  
  <entry>
    <title>Vagrant Command Line說明筆記</title>
    <link href="http://yoursite.com/2017/02/20/%5Bvagrant%5DVagrantMemo/"/>
    <id>http://yoursite.com/2017/02/20/[vagrant]VagrantMemo/</id>
    <published>2017-02-19T16:00:00.000Z</published>
    <updated>2017-07-18T05:24:19.802Z</updated>
    
    <content type="html"><![CDATA[<h4 id="vagrant-package"><a href="#vagrant-package" class="headerlink" title="vagrant package"></a>vagrant package</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vagrant package --base &lt;vm_name&gt; --output &lt;box_name&gt;.box</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="vagrant-box"><a href="#vagrant-box" class="headerlink" title="vagrant box"></a>vagrant box</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vagrant box add ubuntu/precise64	##https://atlas.hashicorp.com/</div><div class="line">vagrant box add precise64 http://files.vagrantup.com/precise64.box</div><div class="line">vagrant box list</div><div class="line">vagrant box remove precise64</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="vagrant-init"><a href="#vagrant-init" class="headerlink" title="vagrant init"></a>vagrant init</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vagrant init  precise64	##會在執行語法的目錄下產生一個Vagrantfile的配置檔</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="vagrant-啟動-停止-重啟-移除-全部VM"><a href="#vagrant-啟動-停止-重啟-移除-全部VM" class="headerlink" title="vagrant 啟動/停止/重啟/移除 全部VM"></a>vagrant 啟動/停止/重啟/移除 全部VM</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">##以下為啟動/停止/重啟/移除全部VM的用法</div><div class="line">vagrant up	##啟動全部VM</div><div class="line">vagrant halt	##停止全部VM</div><div class="line">vagrant reload	##重啟全部VM</div><div class="line">vagrant destroy	##移除全部VM</div><div class="line"></div><div class="line">##以下為啟動/停止/重啟/移除單一VM的用法</div><div class="line">vagrant up master</div><div class="line">vagrant halt master</div><div class="line">vagrant reload master</div><div class="line">vagrant destroy master</div><div class="line"></div><div class="line">##以下為啟動/停止/重啟/移除多個VM的用法(VM名稱中間空格,以做為多個VM名稱區隔)</div><div class="line">vagrant up master slave1</div><div class="line">vagrant halt master slave1</div><div class="line">vagrant reload master slave1</div><div class="line">vagrant destroy master slave1</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="other-command"><a href="#other-command" class="headerlink" title="other command"></a>other command</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vagrant version</div><div class="line">vagrant status</div><div class="line">vagrant ssh-config &lt;vm_name&gt;</div><div class="line">vagrant ssh</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;vagrant-package&quot;&gt;&lt;a href=&quot;#vagrant-package&quot; class=&quot;headerlink&quot; title=&quot;vagrant package&quot;&gt;&lt;/a&gt;vagrant package&lt;/h4&gt;&lt;blockquote&gt;
&lt;figure 
    
    </summary>
    
      <category term="vagrant" scheme="http://yoursite.com/categories/vagrant/"/>
    
    
  </entry>
  
  <entry>
    <title>Vagrant file 配置檔案說明</title>
    <link href="http://yoursite.com/2017/02/20/%5Bvagrant%5DVagrantfile%E9%85%8D%E7%BD%AE%E6%AA%94%E8%AA%AA%E6%98%8E/"/>
    <id>http://yoursite.com/2017/02/20/[vagrant]Vagrantfile配置檔說明/</id>
    <published>2017-02-19T16:00:00.000Z</published>
    <updated>2017-02-20T06:02:47.965Z</updated>
    
    <content type="html"><![CDATA[<h4 id="vagrant-file配置檔案說明"><a href="#vagrant-file配置檔案說明" class="headerlink" title="vagrant file配置檔案說明"></a>vagrant file配置檔案說明</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"># -*- mode: ruby -*-</div><div class="line"># vi: set ft=ruby :</div><div class="line"></div><div class="line">MASTER_IP	= &apos;192.168.51.4&apos;</div><div class="line">DN1_IP		= &apos;192.168.51.5&apos;</div><div class="line">DN2_IP		= &apos;192.168.51.6&apos;</div><div class="line"></div><div class="line">Vagrant.configure(&quot;2&quot;) do |config|  </div><div class="line">  config.ssh.insert_key =false  </div><div class="line">   </div><div class="line">  #define data1 server</div><div class="line">  config.vm.define &quot;slave1&quot; do |slave1|</div><div class="line">	slave1.vm.hostname = &quot;hadoop-slave1&quot;		##設定VM主機名稱</div><div class="line">	slave1.vm.network &quot;private_network&quot;, ip: DN1_IP	##設定主機 ip</div><div class="line">	slave1.vm.box = &quot;ubuntu/yakkety64&quot;		##設定VM使用的OS Box</div><div class="line">	slave1.vm.synced_folder &quot;.&quot;, &quot;/home/vagrant/src&quot;, mount_options: [&quot;dmode=775,fmode=664&quot;]	##設定公用分享目錄	</div><div class="line">	slave1.vm.provider &quot;virtualbox&quot; do |v|</div><div class="line">		v.name = &quot;slave1&quot;</div><div class="line">		v.cpus = 1</div><div class="line">		v.memory = 2500</div><div class="line">	end    </div><div class="line">	slave1.vm.provision &quot;shell&quot;, path: &quot;bootstrap-slave.sh&quot;	##設定VM第一次被啟動時,所需執行的Shell,且使用root帳號執行</div><div class="line">  end</div><div class="line"></div><div class="line">  #define data2 server</div><div class="line">  config.vm.define &quot;slave2&quot; do |slave2|</div><div class="line">	slave2.vm.hostname = &quot;hadoop-slave2&quot;		##設定VM主機名稱</div><div class="line">	slave2.vm.network &quot;private_network&quot;, ip: DN2_IP	##設定主機 ip</div><div class="line">	slave2.vm.box = &quot;ubuntu/yakkety64&quot;		##設定VM使用的OS Box</div><div class="line">	slave2.vm.synced_folder &quot;.&quot;, &quot;/home/vagrant/src&quot;, mount_options: [&quot;dmode=775,fmode=664&quot;]	##設定公用分享目錄</div><div class="line">	slave2.vm.provider &quot;virtualbox&quot; do |v|</div><div class="line">		v.name = &quot;slave2&quot;	##設定VM名稱</div><div class="line">		v.cpus = 1		##設定VM所使用的CPU core數量</div><div class="line">		v.memory = 2500		##設定VM記憶體大小</div><div class="line">	end</div><div class="line">  	slave2.vm.provision &quot;shell&quot;, path: &quot;bootstrap-slave.sh&quot;	##設定VM第一次被啟動時,所需執行的Shell,且使用root帳號執行</div><div class="line">  end</div><div class="line">  </div><div class="line">  #define Master server</div><div class="line">  config.vm.define &quot;master&quot; do |master|</div><div class="line">	master.vm.hostname = &quot;hadoop-master&quot;			##設定VM主機名稱</div><div class="line">	master.vm.network &quot;private_network&quot;, ip: MASTER_IP	##設定主機 ip</div><div class="line">	master.vm.box = &quot;ubuntu/yakkety64&quot;			##設定VM使用的OS Box</div><div class="line">	master.vm.synced_folder &quot;.&quot;, &quot;/home/vagrant/src&quot;, mount_options: [&quot;dmode=775,fmode=664&quot;]	##設定公用分享目錄	</div><div class="line">	master.vm.provider &quot;virtualbox&quot; do |v|</div><div class="line">		v.name = &quot;master&quot;	##設定VM名稱</div><div class="line">		v.cpus = 1		##設定VM所使用的CPU core數量</div><div class="line">		v.memory = 3500		##設定VM記憶體大小</div><div class="line">	end    </div><div class="line">	master.vm.provision &quot;shell&quot;, path: &quot;bootstrap-master.sh&quot;					##設定VM第一次被啟動時,所需執行的Shell,且使用root帳號執行</div><div class="line">	#master.vm.provision &quot;shell&quot;, path: &quot;bootstrap-complete.sh&quot;, run: &quot;always&quot;			##每次啟動VM時,都必須執行的Shell,且使用root帳號執行</div><div class="line">	#master.vm.provision &quot;shell&quot;, path: &quot;bootstrap-complete.sh&quot;, run: &quot;always&quot;,privileged: false	##設定VM第一次被啟動時,所需執行的Shell,且使非root帳號執行</div><div class="line">  end   </div><div class="line">  </div><div class="line">end</div></pre></td></tr></table></figure></blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;vagrant-file配置檔案說明&quot;&gt;&lt;a href=&quot;#vagrant-file配置檔案說明&quot; class=&quot;headerlink&quot; title=&quot;vagrant file配置檔案說明&quot;&gt;&lt;/a&gt;vagrant file配置檔案說明&lt;/h4&gt;&lt;blockquo
    
    </summary>
    
      <category term="vagrant" scheme="http://yoursite.com/categories/vagrant/"/>
    
    
  </entry>
  
  <entry>
    <title>Hadoop資料儲存於多個目錄中的模擬測試</title>
    <link href="http://yoursite.com/2017/01/10/%5Bhadoop%5DhadoopMultiDirectoryStore/"/>
    <id>http://yoursite.com/2017/01/10/[hadoop]hadoopMultiDirectoryStore/</id>
    <published>2017-01-09T16:00:00.000Z</published>
    <updated>2017-01-10T09:59:13.871Z</updated>
    
    <content type="html"><![CDATA[<h3 id="環境說明"><a href="#環境說明" class="headerlink" title="環境說明"></a>環境說明</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">namenode *1(for Linux OS)</div><div class="line">datanode *4(for Linux OS)</div></pre></td></tr></table></figure>
</blockquote>
<h4 id="相關設定說明"><a href="#相關設定說明" class="headerlink" title="相關設定說明"></a>相關設定說明</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mkdir -p /bgdt/data/data2</div><div class="line"></div><div class="line">##修改hdfs-site.xml</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.data.dir&lt;/name&gt;</div><div class="line">	&lt;value&gt;/bgdt/hadoop-2.7.2/tmp/dfs/data,/bgdt/data/data2&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">	&lt;name&gt;dfs.datanode.failed.volumes.tolerated&lt;/name&gt;</div><div class="line">	&lt;value&gt;1&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="進入劇本之前"><a href="#進入劇本之前" class="headerlink" title="進入劇本之前"></a>進入劇本之前</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">##重啟dfs與yarn</div><div class="line">start-dfs.sh</div><div class="line">start-yarn.sh</div><div class="line"></div><div class="line">##並下達以下指令:</div><div class="line">hadoop balancer</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="劇本1"><a href="#劇本1" class="headerlink" title="劇本1"></a>劇本1</h3><blockquote>
<p>系統Run了一段時間後,發現空間不夠了,想增加一個空間給目前的Hadoop cluster環境,因此有了以下的劇本與想法<br>1.用新加一個目錄,來取代模擬新分割區<br>2.copy 一個檔案至HDFS系統後,透過介面查詢相關block id,找出相對實體檔案的儲存位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">hadoop fs -mkdir -P /user/hadoop/data</div><div class="line">hadoop fs -put /opt/staff.csv /user/hadoop/data</div><div class="line"></div><div class="line">##打開Web UI觀察 /user/hadoop/data/staff.csv block Id=XXXXXX</div><div class="line">在檔案下載畫面中會有檔案相關資訊</div><div class="line">block Id:  </div><div class="line">Avaailable</div><div class="line">dna1</div><div class="line">dna3</div><div class="line"></div><div class="line">##確認block Id,與存放的Datanode位置後,直接查找存放的實體位置</div><div class="line">ssh dna1 &quot;find /bgdt -name &quot;blk_&lt;ID&gt;&quot;&quot;</div><div class="line">/bgdt/data/data2/current/BP-1008347755-192.168.11.96-1474254342729/current/finalized/subdir0/subdir0/blk_XXXXXX</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="劇本2"><a href="#劇本2" class="headerlink" title="劇本2"></a>劇本2</h3><blockquote>
<p>將某個Datanode的某個目錄權限及owner設定成(chown root:root chmod 000),模擬硬碟損壞的狀況　<br>1.測試當某個正在運行的hadoop cluster節點的儲存目錄被設為無讀寫權限時,系統是否會Crash<br>2.當目錄修復完成後資料是否有辦法從其他的node,reconvert回來<br>3.當該某個正在運行的節點,所有目錄都無法讀取時,系統是否會正常運行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">##將測試檔案存放到HDFS,並設定副本數為4</div><div class="line">hadoop fs -Ddfs.replication=4 -put /opt/staff_1.csv /user/hadoop/data</div><div class="line"></div><div class="line">##查詢block Id 及block儲存位置</div><div class="line">ssh dna1 &quot;find /bgdt -name &quot;blk_&lt;ID&gt;&quot;&quot;</div><div class="line"></div><div class="line">##模擬故障</div><div class="line">sudo chown -R root:root /bgdt/hadoop-2.7.2/tmp</div><div class="line">sudo chmod -R 000 /bgdt/hadoop-2.7.2/tmp</div><div class="line">hadoop balancer</div><div class="line"></div><div class="line">##Web UI上Datanode Volume Failures會出現有問題的目錄</div><div class="line"></div><div class="line">##balencer執行完成後,會將原本在/tmp目錄下的資料搬移到 /bgdt/data/data2</div><div class="line"></div><div class="line">##此時若再把另外一個目錄也模擬成無權限狀態</div><div class="line">sudo chown -R root:root /bgdt/data</div><div class="line">sudo chmod -R 000 /bgdt/data</div><div class="line"></div><div class="line">##該node的Status會變成Dead,並且DataNode的process會停止</div><div class="line"></div><div class="line">##此時資料的Repl雖然一樣是4,但實際上的資料份數是3</div><div class="line"></div><div class="line">##接著將/bgdt/data目錄設回原本權限,並將資料刪除</div><div class="line">sudo chown -R hadoop:hadoop /bgdt/data</div><div class="line">sudo chmod -R 755 /bgdt/data</div><div class="line">rm -rf /bgdt/data</div><div class="line"></div><div class="line">##並將/bgdt/data目錄的資料刪除後,重啟datanode</div><div class="line">hadoop-daemon.sh start datanode</div><div class="line"></div><div class="line">##重啟成功後,進行balancer</div><div class="line">hadoop balancer</div><div class="line"></div><div class="line">##看到所有檔案的副本數與與資料又恢復正常</div></pre></td></tr></table></figure></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;環境說明&quot;&gt;&lt;a href=&quot;#環境說明&quot; class=&quot;headerlink&quot; title=&quot;環境說明&quot;&gt;&lt;/a&gt;環境說明&lt;/h3&gt;&lt;blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>Hadoop常用命令說明</title>
    <link href="http://yoursite.com/2017/01/10/%5Bhadoop%5DHadoop_CMD/"/>
    <id>http://yoursite.com/2017/01/10/[hadoop]Hadoop_CMD/</id>
    <published>2017-01-09T16:00:00.000Z</published>
    <updated>2017-01-10T10:14:07.994Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">hadoop fs -mkdir    /user/hadoop/data                      </div><div class="line">hadoop fs -mkdir -p /user/hadoop/data                      ##連Partants Directories建立</div><div class="line"></div><div class="line">hadoop fs -ls -h[-d] /user/hadoop</div><div class="line">hadoop fs -lsr       /user/hadoop</div><div class="line"></div><div class="line">hadoop fs -put      /opt/staff.csv /user/hadoop/data       ##上傳檔案至HDFS,不會overwrite</div><div class="line">hadoop fs -put -f   /opt/staff.csv /user/hadoop/data       ##上傳檔案至HDFS,overwrite當前檔案</div><div class="line"></div><div class="line">hadoop fs -df -h    /user/hadoop</div><div class="line">hadoop fs -du -h    /user/hadoop</div><div class="line">hadoop fs -dus      /user/hadoop</div><div class="line">hadoop fs -Ddfs.replication=4 -put /opt/staff.csv /user/hadoop/data</div><div class="line">hadoop fs -setrep 10 /user/hadoop/data/staff.csv</div><div class="line"></div><div class="line"></div><div class="line">hadoop fs -mkdir -p /user/hadoop/ccc</div><div class="line"></div><div class="line">hadoop fs -touchz /user/hadoop/ccc/test.xml	##建立一個空檔案</div><div class="line"></div><div class="line">hadoop fs -cat    /user/hadoop/ccc/test.xml</div><div class="line"></div><div class="line"></div><div class="line">hadoop fs -rm    /user/hadoop/ccc/test.xml	##刪除HDFS上的檔案</div><div class="line">hadoop fs -rmdir /user/hadoop/ccc		##刪除HDFS上的空目錄</div><div class="line">hadoop fs -rmr   /user/hadoop/ccc		##刪除指定目錄下所有的檔案及目錄</div><div class="line"></div><div class="line"></div><div class="line">hadoop fs -copyFromLocal /opt/staff.csv /user/hadoop/ccc			##檔案上傳到HDFS</div><div class="line">hadoop fs -copyToLocal   /user/hadoop/ccc/staff.csv /opt/staff_download.csv 	##檔案下載到/opt</div><div class="line">hadoop fs -moveFromLocal</div><div class="line">hadoop fs -moveToLocal</div><div class="line"></div><div class="line"></div><div class="line">hadoop fsck /user/hadoop/data/staff.csv -files -blocks -locations</div><div class="line">hadoop fsck -blockId blk_&lt;id&gt;</div><div class="line"></div><div class="line">hadoop dfsadmin -safemode enter	##進入安全模式</div><div class="line">hadoop dfsadmin -safemode leave ##離開安全模式</div><div class="line">hadoop dfsadmin -safemode get   ##取得目前狀態</div><div class="line">hadoop dfsadmin -safemode wait  </div><div class="line"></div><div class="line">hadoop dfsadmin -report</div><div class="line">hadoop dfsadmin -refreshNodes</div><div class="line">hadoop dfsadmin -printTopology</div><div class="line"></div><div class="line">hadoop namenode -format		##格式化namenode,在HDFS系統上的資料會全部刪除</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>Hadoop Cluster-動態新增一個節點</title>
    <link href="http://yoursite.com/2017/01/10/%5Bhadoop%5DCreatNewDataNode/"/>
    <id>http://yoursite.com/2017/01/10/[hadoop]CreatNewDataNode/</id>
    <published>2017-01-09T16:00:00.000Z</published>
    <updated>2017-01-10T10:08:35.570Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>hadoop cluster Run了一段時間後,想要增加運算速度,因此想動態新增一個DataNode<br>1.動態新增一個DataNode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">##新主機請安裝以下</div><div class="line">1.  安裝Linux OS</div><div class="line">2.  在/etc/hosts加入所有Hadoop cluster節點的hostname</div><div class="line">3.  進入NameNode下執行</div><div class="line">    ssh-copy-id hadoop@hadoop-slave5</div><div class="line">    scp hadoop-bin-2.7.2.tar.gz hadoop@hadoop-slave5:/bgdt/install_src</div><div class="line">4.  進入新增的DataNode</div><div class="line">5.  tar -zxvf jdk-8u101-linux-x64.tar.gz -C /bgdt/java</div><div class="line">6.  tar -zxvf hadoop-bin-2.7.2.tar.gz -C /bgdt</div><div class="line">7.  Modify ~/.bashrc</div><div class="line">8.  scp 相關設定檔</div><div class="line">    scp /bgdt/hadoop-2.7.2/etc/hadoop/hdfs-site.xml hadoop@hadoop-slave5:/bgdt/hadoop-2.7.2/etc/hadoop/hdfs-site.xml</div><div class="line">    scp /bgdt/hadoop-2.7.2/etc/hadoop/core-site.xml hadoop@hadoop-slave5:/bgdt/hadoop-2.7.2/etc/hadoop/core-site.xml</div><div class="line">    scp /bgdt/hadoop-2.7.2/etc/hadoop/mapred-site.xml hadoop@hadoop-slave5:/bgdt/hadoop-2.7.2/etc/hadoop/mapred-site.xml</div><div class="line">    scp /bgdt/hadoop-2.7.2/etc/hadoop/yarn-site.xml hadoop@hadoop-slave5:/bgdt/hadoop-2.7.2/etc/hadoop/yarn-site.xml</div><div class="line">    scp /bgdt/hadoop-2.7.2/etc/hadoop/slaves hadoop@hadoop-slave5:/bgdt/hadoop-2.7.2/etc/hadoop/slaves</div><div class="line">9.  hadoop-daemon.sh start datanode</div><div class="line">10. 觀察Web UI是否出現slave5 DataNode</div></pre></td></tr></table></figure>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;hadoop cluster Run了一段時間後,想要增加運算速度,因此想動態新增一個DataNode&lt;br&gt;1.動態新增一個DataNode&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
    
    </summary>
    
      <category term="hadoop" scheme="http://yoursite.com/categories/hadoop/"/>
    
    
  </entry>
  
</feed>
